\documentclass[12pt,a4paper,twoside]{article}
\addtolength{\textheight}{80pt} \addtolength{\topmargin}{-50pt}
\textwidth 164mm \oddsidemargin -2.25mm \evensidemargin -2.25mm
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm} % theoremes
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc} 
\usepackage[francais]{babel}
\usepackage{enumitem}
\usepackage{url}
\usepackage{graphicx}
\usepackage{comment}
\usepackage{xcolor}

%% pour les figures
\usepackage{tikz}
\usepackage{forloop}


%% pour les exercices
%\usepackage{exercise}

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\Ni}[1]{{\left\|#1\right\|}_\infty}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} %% pour la page de garde
\input{def.tex}
% \noindent
% {\rule{\textwidth}{.2mm}}\\
% \renewcommand{\labelenumi}{(\alph{enumi})}
% \input{entete}
% {\rule{\textwidth}{.2mm}}\\

% \begin{center}
% {\bf \Huge Introduction aux \'equations aux d\'eriv\'ees partielles}
% \end{center}

% \title{Introduction aux \'equations aux d\'eriv\'ees partielles}

%\vfill
%===================================================================================

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{titlepage}
  \begin{sffamily}
    \begin{center}
      \includegraphics[width = 8cm]{Figures/logo_SU.png}
      \\[1cm]
      \textsc{\LARGE Pr\'eparation \`a l'agr\'egation externe de math\'ematiques}
      \\[1cm]
      \textsc{\Large \'Epreuve de mod\'elisation -- option B : calcul scientifique}
      \\[2cm]
      \HRule \\[0.4cm]
      {\Large \bfseries Introduction aux \'equations aux d\'eriv\'ees partielles}
      \HRule \\[4cm]
      \textsc{\LARGE \bfseries Guillaume Delay}
      \\[2cm]
      \textsc{\Large Laboratoire Jacques-Louis Lions}
      \\[0.5cm]
      \textsc{\Large Sorbonne Universit\'e}
      \\[3cm]
      \today
    \end{center}
  \end{sffamily}
\end{titlepage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Avant-propos}

Le but de ce cours est de proposer une introduction \`a la th\'eorie
des \'equations aux d\'eriv\'ees partielles (EDP dans la suite).
Nous \'etudierons plusieurs \'equations ainsi que leur discr\'etisation
par la m\'ethode des diff\'erences finies.

Dans le cadre du programme officiel de l'agr\'egation
de math\'ematiques (\'epreuve de mod\'elisation, option B: calcul scientifique), 
nous aborderons notamment:
\begin{itemize}
\item des notions \'el\'ementaires portant sur les EDP classiques en dimension 1.
\item l'\'equation de transport lin\'eaire avec la m\'ethode des caract\'eristiques.
\item l'\'equation des ondes et l'\'equation de la chaleur.
  Une r\'esolution par s\'erie de Fourier
  et transform\'ee de Fourier sera propos\'ee ainsi qu'une m\'ethode de s\'eparation
  des variables.
  Les aspects qualitatifs seront abord\'es.
\item les \'equations elliptiques avec l'utilisation du th\'eor\`eme de Lax--Milgram.
\item des exemples de discr\'etisation des EDP en dimension 1 avec la m\'ethode des
  diff\'erences finies. L'\'etude des propri\'et\'es de ces discr\'etisations
  sera propos\'ee : notions de consistance, stabilit\'e, convergence et d'ordre.
\end{itemize}


Vous \^etes par ailleurs invit\'es \`a lire le rapport du jury (disponible sur internet).
Vous vous rendrez compte que le jury insiste notamment sur le fait que :
\begin{itemize}
\item l'\'epreuve de mod\'elisation, comme les autres, requiert une d\'emarche rigoureuse
  de la part des candidats.
\item il faut \'equilibrer sa pr\'esentation entre une pr\'esentation du mod\`ele \'etudi\'e,
  des preuves math\'ematiques rigoureuses et des illustrations informatiques.
\item il attend une prise de recul de la part des candidats.
  Il faudra donc notamment \^etre capable de critiquer les limites du mod\`ele pr\'esent\'e
  dans le texte, d'expliquer le comportement qualitatif de celui-ci 
  (par exemple expliquer ce qu'il se passe quand la valeur d'un param\`etre change)
  et \^etre capable de conclure sur la probl\'ematique de d\'epart.
\end{itemize}


Ce cours sera compos\'e de :
\begin{itemize}
\item quatre s\'eances de cours de trois heures chacune.
\item une s\'eance de programmation de trois heures.
\end{itemize}
Dans une premi\`ere partie, nous pr\'esenterons les \'equations \'etudi\'ees
dans ce cours ainsi que les probl\`emes physiques associ\'es.
Chacune des parties suivantes sera consacr\'ee \`a l'\'etude plus approfondie
d'une EDP. Nous pr\'esenterons notamment les principales caract\'eristiques de cette EDP,
les outils d'analyse utilis\'es ainsi qu'une discr\'etisation par diff\'erences finies.
Les EDP \'etudi\'ees dans la suite seront les \'equations elliptiques,
l'\'equation de transport, l'\'equation de la chaleur et enfin
l'\'equation des ondes.
Une derni\`ere section sera consacr\'ee \`a des \'el\'ements de cours
hors-programme destin\'es aux candidats souhaitant approfondir
leurs connaissances sur ce sujet.

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Pr\'esentation des EDP du cours}

Nous pr\'esentons dans cette section les EDP \'etudi\'ees dans la suite du cours.
Nous essayons de donner une signification physique aux diff\'erents termes.
Nous nous int\'eressons \`a des EDP de la forme
\begin{align}
  \label{eq:EDP_type}
  a \dfrac{\partial^2 u}{\partial x^2} + b \dfrac{\partial^2 u}{\partial x \partial y}
  + c \dfrac{\partial^2 u}{\partial y^2} + d \dfrac{\partial u}{\partial x}
  + e \dfrac{\partial u}{\partial y} + f u = F ,
\end{align}
o\`u $a$, $b$, $c$, $d$, $e$ et $f$ sont des r\'eels et o\`u $F$ et $u$
sont des fonctions de $x$ et $y$.

Une partie du comportement qualitatif de l'EDP peut \^etre d\'etermin\'ee
\`a partir de la valeur de ces coefficients.
Consid\'erons l'\'equation
\begin{align}
  \label{eq:EDP_geom}
  a x^2 + b xy + c y^2 + d x + e y + f = A ,
\end{align}
avec $A$ un r\'eel tel que l'ensemble des solutions soit non vide.
S'il s'agit de l'\'equation:
\begin{itemize}
\item d'une ellipse, on dira que l'\'equation est elliptique.
\item d'une parabole, on dira que l'\'equation est parabolique.
\item d'une hyperbole, on dira que l'\'equation est hyperbolique.
\end{itemize}
Cette d\'enomination n'est pas juste esth\'etique.
En effet, comme nous le verrons plus loin dans ce cours,
chacun de ces types d'\'equations dispose de propri\'et\'es sp\'ecifiques.

Dans l'\'equation \eqref{eq:EDP_type}
nous avons consid\'er\'e un probl\`eme qui d\'epend de deux
variables $x$ et $y$. 
Les notions d'EDP elliptiques, paraboliques et hyperboliques peuvent
aussi \^etre g\'en\'eralis\'ees \`a un plus grand nombre de variables.
Dans le cadre de ce cours, nous nous concentrerons 
sur l'\'etude d'\'equations
avec une seule dimension d'espace.
On consid\'erera donc une seule variable $x$ dans le cas d'un probl\`eme stationnaire
et deux variables $t$ (le temps) et $x$ (l'espace) dans le cas d'un probl\`eme
instationnaire.

% Dans la suite de ce cours, on notera $\Omega$ un ouvert born\'e de $\R^d$
% avec $d=1,2,3$.



\begin{remark}
  Les d\'emonstrations de cette section ne sont pas exigibles.
  On demande simplement aux candidats de se repr\'esenter \`a quoi
  correspondent les \'equations et les param\`etres introduits.
  Aucune connaissance en physique n'est requise pour cette section
  qui peut \^etre lue ind\'ependamment des autres.
  Les candidats doivent cependant avoir \`a l'esprit que tous les textes
  comportent une part de mod\'elisation et que les mod\`eles pr\'esent\'es dans cette
  section sont classiques (donc susceptibles d'\^etre rencontr\'es dans un texte).
\end{remark}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\'Equations elliptiques}
\label{subsec:elliptique}

Nous nous int\'eressons dans cette section \`a des \'equations de la forme
\begin{align}
  \label{eq:ell_1D}
  - \dfrac{\mathrm{d}}{\mathrm{d} x} \left(k \dfrac{\mathrm{d} u}{\mathrm{d} x} \right) = f ,
\end{align}
pour une dimension d'espace $x$.
Si l'on consid\`ere plusieurs dimensions d'espace, cette \'equation devient
\begin{align}
  \label{eq:ell_2D}
  - \DIV \left(k \GRAD u \right) = f ,
\end{align}
o\`u $\DIV$ et $\GRAD$ sont respectivement les op\'erateurs divergence et gradient.
Dans ces deux \'equations, $k$ est un coefficient qui peut \'eventuellement d\'ependre 
des variables d'espace et $f$ est une fonction de l'espace.


Nous pr\'esentons deux probl\`emes physiques qui font intervenir
cette \'equation.
Le premier est le cas o\`u des particules circulent dans un domaine.
Le second est un probl\`eme d'\'equilibre m\'ecanique.


Nous repr\'esentons dans la partie gauche de la figure \ref{fig:flux} 
le premier probl\`eme.
Nous nous int\'eressons \`a des particules qui circulent 
dans un milieu unidimensionnel. La position est
rep\'er\'ee par la coordonn\'ee d'espace $x$. On note $u(x)$ la densit\'e
de particules en $x$. Certaines particules entrent ou sortent du domaine
en $x$, on note $f(x)$ le terme source repr\'esentant cette variation
($f(x)$ sera positif si des particules apparaissent en $x$ 
et n\'egatif si elles disparaissent).
De plus, les particules se d\'eplacent \`a travers le domaine,
on note $q(x)$ le flux de particules en $x$
(le nombre de particules qui traversent l'axe vertical d'abscisse $x$
par unit\'e de temps). Ce flux est positif si les particules 
vont vers la droite et n\'egatif si elles vont vers la gauche.

\begin{figure}
\begin{tikzpicture}[scale = 3]
  \input{flux.tex}
\end{tikzpicture}
\begin{tikzpicture}[scale = 2.5]
  \input{flux_dx.tex}
\end{tikzpicture}
\caption{R\'epartition de particules dans un domaine. Gauche: repr\'esentation du probl\`eme.
  Droite: \'equilibre des flux sur une portion infinit\'esimale du domaine.}
\label{fig:flux}
\end{figure}


On s'int\'eresse au cas o\`u les flux sont \`a l'\'equilibre, il n'y
a donc pas d'accumulation de particules en aucun point de l'espace.
Le probl\`eme ne d\'epend donc pas du temps.


Pour \'etablir les \'equations de ce probl\`eme,
consid\'erons une portion infinit\'esimale du domaine (de taille $\delta x$) comme
repr\'esent\'e sur la droite de la figure \ref{fig:flux}.
Le nombre de particules \`a l'int\'erieur de cette section doit
rester constant.
On obtient donc la relation de conservation
$q(x) - q(x+\delta x) + f(x) \delta x = 0$,
ce qui donne la relation
\begin{align}
  \label{eq:eq_flux}
  \dfrac{\mathrm{d} q}{\mathrm{d} x} = f .
\end{align}

De plus, on consid\`ere que les particules fuient les zones de forte densit\'e:
le flux $q(x)$ suit la direction oppos\'ee au gradient de $u$.
On note donc 
\begin{align}
  \label{eq:def_flux}
  q(x) = - k(x) \dfrac{\mathrm{d} u}{\mathrm{d} x}(x) . 
\end{align}
Ici $k$ est un coefficient positif qui peut d\'ependre de l'espace.
Il traduit le rapport de proportionnalit\'e entre le gradient de la densit\'e
et le flux qui en r\'esulte. Ainsi, pour une densit\'e fix\'ee,
si $k$ est grand alors les particules circuleront facilement et le flux sera important;
\`a l'inverse, un $k$ petit traduit le fait que les particules ont du mal \`a circuler dans
le milieu.
L'\'equation finale sur $u$ est donc \eqref{eq:ell_1D}.



En pratique les particules que nous avons consid\'er\'ees peuvent 
repr\'esenter par exemple des mol\'ecules.
Dans ce cas $u$ sera une concentration chimique, $q$ un flux de mol\'ecules, 
$f$ un terme repr\'esentant leur apparition ou leur disparition
(par des r\'eactions chimiques) et
$k$ sera un coefficient d\'eterminant la facilit\'e avec laquelle
les mol\'ecules se d\'eplacent.

On peut aussi dire que les particules repr\'esentent de l'\'energie thermique
qui se propage \`a travers un mat\'eriau.
Dans ce cas, $u$ sera la temp\'erature , $q$ un flux thermique, $f$ une source
ou un puit de chaleur et $k$ sera la conductivit\'e thermique du mat\'eriau consid\'er\'e.

Nous citons une derni\`ere possibilit\'e selon laquelle les particules sont des
individus (humains ou animaux).
Dans ce cas, $u$ correspond \`a une densit\'e de population,
$q$ \`a un flux de population, $f$ repr\'esente les naissances et morts
et $k$ est un coefficient repr\'esentant la
facilit\'e avec laquelle la population peut se d\'eplacer. 


Nous pr\'esentons maintenant
un autre probl\`eme physique faisant intervenir des \'equations elliptiques.
Consid\'erons un mat\'eriau 
soumis \`a des contraintes m\'ecaniques.
Par exemple, on repr\'esente sur la figure~\ref{fig:barre} une barre \'elastique
en \'equilibre.


\begin{figure}
\begin{tikzpicture}[scale = 1.5]
  \input{barre.tex}
\end{tikzpicture}
\begin{tikzpicture}[scale = 2]
  \input{barre_dx.tex}
\end{tikzpicture}
\caption{Une barre \'elastique en \'equilibre. Gauche: repr\'esentation du probl\`eme.
  Droite: d\'eformation d'un \'el\'ement infinit\'esimal de mati\`ere.
  Le trait continu repr\'esente la configuration soumise \`a une charge $f$.
  Le trait discontinu repr\'esente la configuration au repos (sans $f$).}
\label{fig:barre}
\end{figure}


La barre dans son \'etat initial est repr\'esent\'ee en pointill\'es.
Sous l'effet d'une force lin\'eique $f$, cette barre s'allonge
et atteint l'\'etat d'\'equilibre repr\'esent\'e en trait continu.
On note $u(x)$ le d\'eplacement de la mati\`ere qui a eu lieu en $x$ entre
la configuration au repos et la configuration soumise \`a la charge $f$.


On consid\`ere que la barre est \`a l'\'equilibre m\'ecanique.
On note $q(x)$ la force qu'exerce la section de gauche sur la section de droite
en $x$. En faisant un bilan de force comme repr\'esent\'e 
sur la partie droite de la figure \ref{fig:flux},
les forces s'exer\c{c}ant sur une portion infinit\'esimale de barre sont
la force $q(x)$ \`a gauche, la force $-q(x+\delta x)$ \`a droite
et la force lin\'eique $f(x) \delta x$. La barre \'etant \`a l'\'equilibre la somme de ces forces
est nulle. On retrouve donc \eqref{eq:eq_flux}.


De plus, la force s'exer\c{c}ant en $x$ \`a travers la section de la barre est 
proportionnelle \`a l'\'elongation de la barre et s'oppose au mouvement impos\'e.
Ceci est intuitif, pensez \`a un \'elastique: si vous l'allongez, alors il s'exerce une force
qui tend \`a le faire revenir vers sa position initiale. De plus, plus l'\'elongation
est importante, plus l'intensit\'e de la force est grande.
On obtient donc la loi d'\'elasticit\'e \eqref{eq:def_flux}
o\`u $k$ est un coefficient de raideur:
plus $k$ est grand, plus la barre est raide (plus il faut forcer pour la d\'eformer).
En pratique, le coefficient de raideur d\'epend du mat\'eriau choisi et
de la g\'eom\'etrie de la section de la barre.

Notons que dans \eqref{eq:def_flux}, la d\'eriv\'ee en espace correspond bien \`a 
l'\'elongation de la barre en $x$. Pour s'en convaincre, on regardera la 
partie droite de la figure \ref{fig:barre}. Un \'el\'ement de mati\`ere de longueur
$\delta x$ dans sa position de r\'ef\'erence a pour longueur 
$x + \delta x + u(x+\delta x) - u(x) - x$ sous charge $f$.
La nouvelle longueur est donc de $\delta x + u(x+\delta x) - u(x) 
\simeq \left(1 + \dfrac{\partial u}{\partial x} \right) \delta x$
et la d\'eriv\'ee partielle de $u$ en $x$ est donc bien une \'elongation par unit\'e de longueur.


D'autres probl\`emes physiques peuvent \^etre mod\'elis\'es par des \'equations elliptiques.
Nous citerons simplement l'\'electromagn\'etisme sans donner plus de d\'etails.
Nous verrons par la suite que, dans le cas instationnaire,
les deux probl\`emes expos\'es ici correspondent \`a 
des \'equations de nature diff\'erente.
Le premier est repr\'esent\'e par une \'equation parabolique en instationnaire,
tandis que la deuxi\`eme est repr\'esent\'e par une \'equation hyperbolique.


\'Evoquons maintenant les conditions aux limites les plus classiques
que l'on peut associer \`a ce probl\`eme.
Tout d'abord, nous pouvons consid\'erer la condition de Dirichlet
$u = g$ o\`u $g$ est une donn\'ee du probl\`eme. Ceci revient \`a imposer
la valeur de la solution $u$ sur le bord du domaine.
Par exemple, dans le cas de l'\'equation de la chaleur stationnaire,
la condition de Dirichlet revient \`a consid\'erer que le bord du domaine
correspond \`a un \'el\'ement \`a forte capacit\'e thermique
dont la temp\'erature restera constante quoi qu'il arrive.


Une autre condition aux limites classique est la condition de Neumann
$q = g$ o\`u $g$ est une donn\'ee. Ceci revient \`a imposer la valeur
du flux $q$ sur le bord du domaine.
Dans la majorit\'e des cas, la donn\'ee de Neumann $g$ est nulle.
Par exemple, dans le cas du probl\`eme de la chaleur, ceci revient
\`a consid\'erer que le bord du domaine est adiabatique:
quoi qu'il arrive aucun flux de chaleur ne traversera le bord du domaine
(pensez par exemple \`a une bouteille isotherme).


Ces deux conditions aux limites peuvent \'eventuellement \^etre utilis\'ees 
simultan\'ement en des points diff\'erents du bord
(Dirichlet sur une partie de la fronti\`ere et Neumann sur le reste).
On parle alors de conditions aux limites mixtes.

\begin{table}[h]
  \centering
  \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
    &Chaleur stationnaire&Barre \'elastique& Mol\'ecules
    \\
    \hline
    $u$ & temp\'erature & d\'eplacement & concentration
    \\
    \hline
    $q=-k\GRAD u$ & flux de chaleur & force interne & flux de mol.
    \\
    \hline
    $k$ & conductivit\'e thermique & coeff. de raideur & coeff. de diffusion
    \\
    \hline
    $f$& source/puit de chaleur & force externe & r\'eactions chimiques
    \\
    \hline
    $u=g$ & temp. constante & d\'eplacement impos\'e & concentration impos\'ee
    \\
    \hline
    $q=0$ & paroi adiabatique & fronti\`ere libre & fronti\`ere imperm\'eable
    \\
    \hline
  \end{tabular}
  \caption{Sens physique de la repr\'esentation math\'ematique en fonction
    du probl\`eme trait\'e.}
  \label{tab:pb_ell}
\end{table}


\begin{exercise}
  On se place dans le cas d'un domaine bidimensionnel $\Omega \subset \R^2$.
  On note $x$ et $y$ les deux variables d'espace.
  On suppose que $k$ est constant : pour tout $(x,y) \in \Omega$,
  $k(x,y) = k_0 > 0$.
  Montrer que l'\'equation \eqref{eq:ell_2D} est elliptique.
\end{exercise}

\begin{remark}
  Dans la plupart des applications, $k$ est une constante.
  Prenons par exemple $k=1$.
  L'\'equation \eqref{eq:ell_2D} devient $-\Delta u = f$.
  On appelle cette \'equation \'equation de Laplace ou 
  \'equation de Poisson.
  Pour simplifier la pr\'esentation, c'est cette \'equation que nous \'etudierons
  par la suite.
\end{remark}


Pour finir cette section, nous illustrons le comportement
de la solution de \eqref{eq:ell_1D} en fonction de $k$
(voir figure \ref{fig:ell_k}).
Comme nous l'avons \'evoqu\'e pr\'ec\'edemment, une solution avec 
un $k$ plus grand est plus "plate" 
(par exemple dans le cas des mol\'ecules, une plus grande diffusion entra\^ine 
une plus grande homog\'en\'eit\'e de la concentration).


\begin{figure}[h]
  \centering
  \includegraphics[width = 12cm]{Figures/Poisson_k.eps}
  \caption{Solution de l'\'equation elliptique 1D \eqref{eq:ell_1D}
  pour diff\'erents $k$ (pour $f(x)=1$) avec les conditions de Dirichlet homog\`enes
  $u(0) = u(1) = 0$.}
  \label{fig:ell_k}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\'Equation de transport}

La deuxi\`eme \'equation que nous \'etudions est l'\'equation de transport
(unidimensionelle).
Elle correspond \`a une quantit\'e qui est transport\'ee \`a vitesse
constante dans une direction.
Cela peut \^etre par exemple un polluant transport\'e par une rivi\`ere.
Dans cette section, nous nous int\'eressons au cas de tas de sable
sur un tapis roulant se d\'epla\c{c}ant \`a vitesse constante $a$.


\begin{figure}
\centering
\begin{tikzpicture}[scale = 0.5]
  \input{transport.tex}
\end{tikzpicture}
\caption{Des tas de sable transport\'es sur un tapis roulant.
  La ligne discontinue repr\'esente les tas en $t=0s$ et la ligne
  continue en $t=1s$.}
\label{fig:transport}
\end{figure}

Sur la figure \ref{fig:transport}, nous repr\'esentons des tas de sables
qui se d\'eplacent \`a vitesse constante $a$ vers la droite.
On note $u(t,x)$ la hauteur du sable en $x$ \`a l'instant $t$.

Si l'on consid\`ere un temps infinit\'esimal $\delta t$,
le sable aura avanc\'e d'une distance $\delta x = a \delta t$.
La hauteur en $(t+\delta t , x + \delta x)$ sera la m\^eme qu'elle
\'etait en $(t,x)$, on traduit cela par $u(t+\delta t, x + a \delta t) = u(t,x)$.
On obtient ainsi l'\'equation de transport
\begin{align}
  \dfrac{\partial u}{\partial t} + a \dfrac{\partial u}{\partial x} = 0 .
\end{align}
Ici, $a$ correspond \`a la vitesse du transport.
Si $a$ est positif, le sable bouge vers la droite; si $a$ est n\'egatif,
le sable bouge vers la gauche; plus $a$ est grand en valeur absolue, 
plus le mouvement est rapide.


\begin{remark}
  En se r\'ef\'erant \`a la d\'efinition, cette \'equation n'est ni elliptique, 
  ni parabolique, ni hyperbolique. Cependant, le comportement des solutions de 
  cette \'equation est proche d'un comportement hyperbolique.
  Notons par ailleurs que l'\'equation \eqref{eq:EDP_geom} associ\'ee
  \`a l'\'equation de transport est une droite et les hyperboles ont des droites
  comme asymptotes (d'o\`u le comportement hyperbolique de l'\'equation de transport).
\end{remark}

Pour finir la pr\'esentation de l'\'equation de transport,
nous donnons des r\'esultats num\'eriques pour diff\'erentes
valeurs de la vitesse de transport $a$ (voir figure \ref{fig:transport_a}).
Ces r\'esultats illustrent bien le fait $a$ est la vitesse \`a laquelle
la solution se d\'eplace.


\begin{figure}[h]
  \centering
  \includegraphics[width = 12cm]{Figures/transport_Dir_a.eps}
  \caption{Solution de l'\'equation de transport \`a $t=0.5$
  pour diff\'erents $a$. La donn\'ee initiale ($t=0$) correspond \`a 
  la solution pour $a = 0$. On a impos\'e la condition de Dirichlet \`a gauche $u(t,0) = 1$.}
  \label{fig:transport_a}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\'Equation de la chaleur}

On se place dans le cadre du premier probl\`eme que nous avons \'evoqu\'e dans
la section \ref{subsec:elliptique} (voir figure \ref{fig:flux}). 
Pour plus de simplicit\'e, nous consid\'erons que nous sommes dans le cas
de la conduction thermique (bien que comme nous l'avons vu pr\'ec\'edemment
d'autres probl\`emes comme le mouvement d'une population ou de mol\'ecules
peuvent \^etre consid\'er\'es).
La diff\'erence avec ce qui a \'et\'e fait dans la section \ref{subsec:elliptique}
est qu'ici les flux de chaleur ne sont pas n\'ecessairement \`a l'\'equilibre.
On permet donc \`a la temp\'erature de changer au cours du temps.

Nous allons maintenant refaire le raisonnement de la section \ref{subsec:elliptique}
avec cette fois-ci une temp\'erature $u(t,x)$ qui d\'epend du temps.
Si l'on consid\`ere la partie droite de la figure \ref{fig:flux}, l'accumulation
d'\'energie en $(t,x)$ est due au fait que les flux ne sont pas \'equilibr\'es
("ce qui entre n'est pas \'egal \`a ce qui sort").
Ainsi, s'il y a plus d'\'energie qui entre dans le domaine infinit\'esimal
qu'il n'y en a qui en sort,
alors la temp\'erature augmente.
Nous traduisons cela par l'\'equation
$c (x) \delta x \dfrac{\partial u}{\partial t}(t,x) = f(t,x) \delta x 
  + q(t,x) - q(t,x + \delta x)$, ce qui donne
\begin{align}
  \label{eq:flux_t}
  c (x) \dfrac{\partial u}{\partial t}(t,x) = f(t,x) - \dfrac{\partial q}{\partial x} (t,x) .
\end{align}
o\`u $c(x)$ est la capacit\'e thermique lin\'eique du mat\'eriau,
$q(t,x)$ et $f(t,x)$ sont respectivement le flux de chaleur 
et la source de chaleur en $(t,x)$.
Comme pr\'ec\'edemment, le flux de chaleur est proportionnel au gradient 
de temp\'erature (voir \eqref{eq:def_flux}).
Pour simplifier la pr\'esentation, nous consid\'erons que la capacit\'e
thermique $c$ et la conductivit\'e thermique $k$ sont des constantes 
(qui ne d\'ependent ni du temps, ni de l'espace).
En combinant les \'equations \eqref{eq:def_flux} et \eqref{eq:flux_t},
on obtient l'\'equation de la chaleur
\begin{align}
  \label{eq:chaleur}
  \dfrac{\partial u}{\partial t} - \nu \dfrac{\partial^2 u}{\partial x^2} = \widetilde{f} ,
\end{align}
o\`u $\nu = k/c > 0$ est la diffusivit\'e thermique 
(qui d\'epend du mat\'eriau consid\'er\'e et de sa g\'eom\'etrie).


Les conditions aux limites classiques sont les m\^emes que celles \'evoqu\'ees pour le probl\`eme
stationnaire (voir tableau \ref{tab:pb_ell}).


\begin{figure}[h]
  \centering
  \includegraphics[width = 5.2cm]{Figures/chaleur_nu0_5.eps}
  \includegraphics[width = 5.2cm]{Figures/chaleur_nu1.eps}
  \includegraphics[width = 5.2cm]{Figures/chaleur_nu2.eps}
  \caption{Solution de l'\'equation de la chaleur
  pour $f(x) = -1$. Gauche: $\nu = 0.5$.
  Milieu: $\nu = 1$. Droite: $\nu = 2$.
  Les courbes repr\'esentent la solution \`a $t=0$ (bleu), $t=0.05$ (rouge) et $t=0.1$ (noir).
  On a impos\'e les conditions de Dirichlet $u(t,0) = u(t,1) = 0$.
  La condition initiale est la solution stationnaire de ce probl\`eme avec $f=1$.}
  \label{fig:chaleur_nu}
\end{figure}


Nous illustrons sur la figure \ref{fig:chaleur_nu} l'influence du param\`etre $\nu$.
Plus $\nu$ est grand, plus la chaleur va se diffuser rapidement et plus 
la courbe va s'applatir rapidement.

\begin{exercise}
  Prouver que l'\'equation \eqref{eq:chaleur} est une \'equation parabolique.
\end{exercise}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\'Equation des ondes}

L'\'equation des ondes peut \^etre obtenue en consid\'erant un mod\`ele m\'ecanique
comme celui de la figure \ref{fig:barre} o\`u cette fois-ci les forces ne
sont pas n\'ecessairement \`a l'\'equilibre et o\`u les d\'eplacements
$u(t,x)$ peuvent varier au cours du temps.

Le principe fondamental de la dynamique appliqu\'e \`a une tranche de mati\`ere
de longueur $\delta x$ nous dit que l'acc\'el\'eration de cette tranche (la d\'eriv\'ee seconde de sa position
$x+u(t,x)$) multipli\'ee par sa masse est \'egale \`a la somme des forces qui
agissent sur elle.
Ainsi, $\rho(x) \delta x \dfrac{\partial^2 u}{\partial t^2} = 
f(t,x) \delta x + q(t,x) - q(t, x + \delta x)$, ce qui nous donne l'\'equation
\begin{align}
  \label{eq:barre_t}
  \rho(x) \dfrac{\partial^2 u}{\partial t^2}(t,x) + \dfrac{\partial q}{\partial x}(t,x) = f(t,x) ,
\end{align}
o\`u $\rho(x)$ correspond \`a la masse de la barre par unit\'e de longueur.
Plus $\rho$ est grand, plus la barre a d'inertie et plus elle acc\'el\`ere lentement.
Notons \`a ce stade qu'il y a, dans cette \'equation, une d\'eriv\'ee seconde en temps
\`a la place de la d\'eriv\'ee premi\`ere qu'il y avait dans \eqref{eq:flux_t}.

La force de compression \`a travers la barre est donn\'ee par la loi d'\'elasticit\'e
\eqref{eq:def_flux}.
Pour simplifier la pr\'esentation, on consid\`ere que la raideur $k$ et la masse
lin\'eique $\rho$ sont constantes (ne d\'ependent ni de $t$ ni de $x$).
En combinant \eqref{eq:def_flux} et \eqref{eq:barre_t} on obtient l'\'equation des ondes
\begin{align}
  \label{eq:ondes}
  \dfrac{\partial^2 u}{\partial t^2} - c^2 \dfrac{\partial^2 u}{\partial x^2} = \widetilde{f} ,
\end{align}
o\`u $c>0$ d\'efini par $c^2 = k/\rho$ correspond \`a la vitesse de propagation
des ondes dans ce milieu.



\begin{figure}[h]
  \centering
  \includegraphics[width = 5.2cm]{Figures/ondes_c0_2.eps}
  \includegraphics[width = 5.2cm]{Figures/ondes_c0_5.eps}
  \includegraphics[width = 5.2cm]{Figures/ondes_c1.eps}
  \caption{Solution de l'\'equation des ondes pour $f=0$ et $v_0 = 0$.
  Gauche: $c = 0.2$. Milieu: $c=0.5$. Droite: $c=1$.
  Les courbes repr\'esentent la solution \`a $t=0$ (bleu),
  $t=0.2$ (rouge) et $t=0.4$ (noir). On impose les conditions de Dirichlet $u(t,0) = u(t,1) = 0$.
  La condition initiale est repr\'esent\'ee en bleu.}
  \label{fig:ondes_c}
\end{figure}


On illustre l'influence de $c$ sur la figure~\ref{fig:ondes_c}.
Nous voyons que nous avons une propagation de l'information 
dans les deux directions (les $x$ positifs et les $x$ n\'egatifs).
Plus $c$ est grand, plus l'information se propage rapidement.
Notons \'egalement que la solution pour $c=0.5$ et $t=0.4$
correspond \`a la solution pour $c=1.0$ et $t=0.2$.
On voit donc bien que $c$ correspond \`a une vitesse de propagation
de l'onde.


Nous avons \'evoqu\'e le fait que l'\'equation des ondes
pouvait repr\'esenter le d\'eplacement d'une barre en compression.
On peut aussi mod\'eliser des probl\`emes 
comme la propagation du d\'eplacement d'une corde ou
la propagation d'une onde \'electromagn\'etique.
Une bonne fa\c{c}on d'interpr\'eter la figure~\ref{fig:ondes_c}
est d'imaginer une corde tendue sur un intervalle $(0,1)$.
La solution $u(t,x)$ correspond alors \`a la position verticale de la corde
en $x$ \`a l'instant $t$.


Rappelons enfin que les conditions aux limites classiques sont 
les m\^emes que celles du cas stationnaire
(voir tableau \ref{tab:pb_ell}).

\begin{exercise}
  Prouver que l'\'equation \eqref{eq:ondes} est hyperbolique.
\end{exercise}

\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\'Equation de Poisson}

On consid\`ere $\Omega$ un ouvert born\'e de $\R^d$ avec $d \in \{1,2,3\}$.
Nous simplifions le cadre \'evoqu\'e pr\'ec\'edemment
en consid\'erant $k=1$.
On s'int\'eresse donc au probl\`eme
\begin{equation}
  \label{eq:ell_Dir}
  \text{Trouver $u \in C^2(\Omega)$ telle que  }
  \left\{
    \begin{array}{l l}
      - \Delta u = f &\dans \Omega ,
      \\
      u = 0 &\sur \partial \Omega ,
    \end{array}
  \right.
\end{equation}
o\`u on note $\partial \Omega$ le bord du domaine $\Omega$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Propri\'et\'es g\'en\'erales de l'\'equation}
\label{subsec:Lap_prop}

\begin{theorem}[Existence et unicit\'e de la solution]
  \label{thm:ell_existence}
  Si $f \in C^0(\Omega)$, alors il existe une unique solution
  $u \in C^2(\Omega)$ au probl\`eme \eqref{eq:ell_Dir}.
  De plus, pour $\ell \in \N$, si $f \in C^{\ell}(\Omega)$, alors
  $u \in C^{\ell+2}(\Omega)$.
\end{theorem}

Dans ce th\'eor\`eme nous voyons l'effet r\'egularisant de l'\'equation de Poisson:
si le terme source est de classe $C^{\ell}$ alors la solution du probl\`eme
est de classe $C^{\ell + 2}$.
Les outils utilis\'es pour \'etablir cette preuve sont pr\'esent\'es
dans la section \ref{subsec:LM}.

\begin{proposition}[Principe du maximum]
  On se place dans le cadre du th\'eor\`eme \ref{thm:ell_existence}.
  Si $f \leq 0$, alors $u \leq 0$. En particulier,
  $\max_{x\in \Omega} u(x) = \max_{x\in \partial \Omega} u(x) = 0$.
  Si, de plus, il existe $m\in \Omega$ tel que $u(m) = 0$,
  alors $\forall x \in \Omega$, $u(x) = 0$ 
  (principe du maximum fort).
\end{proposition}

%% reference vers un livre ??


\begin{definition}[Fonctions harmoniques]
  Si $u \in C^2(\Omega)$ et $- \Delta u = 0$ dans $\Omega$,
  on dit que $u$ est une fonction harmonique.
\end{definition}

Il existe des liens entre fonctions harmoniques et fonctions holomorphes.
En effet, si $\varphi$ est une fonction holomorphe,
alors $\Re(\varphi)$ et $\Im(\varphi)$ (parties r\'eelle et imaginaire)
sont des fonctions harmoniques.


D'autres conditions aux limites peuvent \^etre consid\'er\'ees.
Nous pouvons par exemple consid\'erer des conditions de Dirichlet 
non homog\`enes.
\begin{equation*}
  \text{Trouver $u \in C^2(\Omega)$ telle que  }
  \left\{
    \begin{array}{l l}
      - \Delta u = f &\dans \Omega ,
      \\
      u = g &\sur \partial \Omega ,
    \end{array}
  \right.
\end{equation*}
o\`u $g \in C^2(\partial \Omega)$ est une donn\'ee du probl\`eme.
Pour r\'esoudre ce probl\`eme, on consid\`ere un rel\`evement de $g$,
c'est-\`a-dire une fonction $\tilde{g} \in C^2(\Omega)$ telle que
$\tilde{g} = g$ sur $\partial \Omega$,
et on cherche la solution $u$ sous la forme
$u = \tilde{u} + \tilde{g}$.
La fonction $\tilde{u}$ est alors solution du probl\`eme
avec conditions de Dirichlet homog\`enes
\begin{equation*}
  \text{Trouver $\tilde{u} \in C^2(\Omega)$ telle que  }
  \left\{
    \begin{array}{l l}
      - \Delta \tilde{u} = f + \Delta \tilde{g} &\dans \Omega ,
      \\
      \tilde{u} = 0 &\sur \partial \Omega .
    \end{array}
  \right.
\end{equation*}
Moyennant l'existence du rel\`evement $\tilde{g}$,
r\'esoudre le probl\`eme non homog\`ene revient \`a 
r\'esoudre un probl\`eme homog\`ene \'equivalent.


Nous pouvons \'egalement consid\'erer des conditions
de Neumann. Le probl\`eme de Poisson devient alors
\begin{align}
  \label{eq:ell_Neu}
  \text{Trouver $u \in C^2(\Omega)$ telle que  }
  \left\{
    \begin{array}{l l}
      - \Delta u = f &\dans \Omega ,
      \\
      \GRAD u \SCAL n = 0 &\sur \partial \Omega ,
      \\
      \int_{\Omega} u \deriv x = 0 ,
    \end{array}
  \right.
\end{align}
o\`u $n$ d\'esigne la normale sortante au domaine.


Dans le probl\`eme \eqref{eq:ell_Neu}, 
la condition $\int_{\Omega} u \deriv x = 0$ a \'et\'e ajout\'ee
pour garantir l'unicit\'e de la solution. 
En effet, si on enlevait cette condition, pour $u$ solution
de \eqref{eq:ell_Neu}, $u+c$ serait aussi solution pour tout $c\in \R$.
Des alternatives existent \`a la condition 
$\int_{\Omega} u \deriv x = 0$,
l'essentiel est d'\'eliminer l'infinit\'e de solutions g\'en\'er\'ees en
ajoutant $c\in\R$.

Terminons cette section en relevant le fait que l'existence d'une solution
au probl\`eme \eqref{eq:ell_Neu} requiert la condition
$\int_{\Omega} f \deriv x = 0$.

\begin{exercise}
  Prouver que s'il existe une solution $u$ au probl\`eme \eqref{eq:ell_Neu},
  alors $f$ v\'erifie $\int_{\Omega} f \deriv x = 0$.
\end{exercise}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Formulation variationnelle, th\'eor\`eme de Lax--Milgram}
\label{subsec:LM}

Le but de cette section est de pr\'esenter les outils utilis\'es pour prouver 
le th\'eor\`eme \ref{thm:ell_existence}.
Nous utilisons notamment le th\'eor\`eme de Lax--Milgram.

\begin{theorem}[Lax--Milgram]
  \label{thm:Lax-Milgram}
  On fait les hypoth\`eses suivantes.
  \begin{itemize}
  \item Soit $V$ un espace de Hilbert.
  \item Soit $\ell$ une forme lin\'eaire continue sur $V$
    (il existe $C_{\ell} > 0$ tel que $\forall v \in V, |\ell(v)| \leq C_{\ell} \| v \|_{V}$).
  \item Soit $a$ une forme bilin\'eaire continue sur $V$
    (il existe $C_{a} > 0$ tel que $\forall v,w \in V, |a(v,w)| \leq C_{a} \| v \|_{V} \| w \|_{V}$).
  \item On suppose de plus que $a$ est coercive:
    il existe $\alpha > 0$ tel que $\forall v \in V, a(v,v) \geq \alpha \| v \|_{V}^2$.
  \end{itemize}
  Sous ces hypoth\`eses le probl\`eme suivant est bien pos\'e:
  \begin{equation}
    \label{eq:Lax-Milgram}
    \text{Trouver $u \in V$, tel que $\forall v \in V$, } a(u,v) = \ell(v) .
  \end{equation}
  Ceci signifie que le probl\`eme \eqref{eq:Lax-Milgram} admet une unique solution $u \in V$
  et que celle-ci est bornée, ici par $\| u \|_{V} \leq \dfrac{C_{\ell}}{\alpha}$.
\end{theorem}

%% ref vers un livre 

Pour utiliser ce th\'eor\`eme, \'ecrivons le probl\`eme \eqref{eq:ell_Dir} sous
sa forme variationnelle.
On introduit l'espace de Sobolev
\begin{align}
  H_0^1(\Omega) := \{ v \in L^2(\Omega) \st \GRAD v \in [L^2(\Omega)]^d
  \text{ et } v_{| \partial \Omega} = 0 \sur \partial \Omega \} ,
\end{align}
o\`u $\GRAD v$, le gradient de $v$, est d\'efini au sens des distributions et $v_{|\partial \Omega}$
est la trace de $v$ sur le bord du domaine.


Si $u$ est une solution de \eqref{eq:ell_Dir}, alors pour tout $v \in H^1_0(\Omega)$
on peut \'ecrire
\begin{align*}
  \int_{\Omega} - \Delta u v \deriv x = \int_{\Omega} f v \deriv x .
\end{align*}
En int\'egrant par parties on obtient 
\begin{align*}
  \int_{\Omega} \GRAD u \SCAL \GRAD v \deriv x 
  - \int_{\partial \Omega} (\GRAD u \SCAL n) v \deriv s = \int_{\Omega} f v \deriv x .
\end{align*}
Puisque $v_{|\partial \Omega} = 0$, le deuxi\`eme terme de cette expression est nul.
Nous avons donc \'etabli la proposition suivante.
\begin{proposition}
  Toute solution du probl\`eme~\eqref{eq:ell_Dir} est solution du probl\`eme 
  \begin{equation}
    \label{eq:LM2}
    \text{Trouver $u \in H_0^1(\Omega)$, tel que $\forall v \in H_0^1(\Omega)$, } 
    \int_{\Omega} \GRAD u \SCAL \GRAD v \deriv x = \int_{\Omega} f v \deriv x .
  \end{equation}
\end{proposition}

\begin{proposition}
  Le probl\`eme~\eqref{eq:LM2} est bien pos\'e.
\end{proposition}
\begin{proof}
  Le probl\`eme~\eqref{eq:LM2} correspond au probl\`eme~\eqref{eq:Lax-Milgram}
  avec $V = H_0^1(\Omega)$, 
  $\forall v, w \in H_0^1(\Omega), a(v,w) = \int_{\Omega} \GRAD v \SCAL \GRAD v \deriv x$
  et $\ell(v) = \int_{\Omega} f v \deriv x$.
  Nous allons montrer que toutes les hypoth\`eses du th\'eor\`eme de Lax--Milgram
  sont v\'erifi\'ees.
  On admet le fait que $H_0^1(\Omega)$ \'equip\'e de la norme 
  $\| v \|_{H^1(\Omega)} := (\int_{\Omega} v^2 + \GRAD v \SCAL \GRAD v \deriv x)^{1/2}$ 
  est un espace de Hilbert (se reporter \`a un cours sur les distributions).
  D'apr\`es l'in\'egalit\'e de Cauchy--Schwarz, on a 
  $|\ell(v)| \leq (\int_{\Omega} f^2 \deriv x)^{1/2} (\int_{\Omega} v^2 \deriv x)^{1/2}
  \leq (\int_{\Omega} f^2 \deriv x)^{1/2} \| v \|_{H^1(\Omega)}$.
  La forme lin\'eaire $\ell$ est donc continue. 
  
  
  De la m\^eme fa\c{c}on, l'in\'egalit\'e de Cauchy--Schwarz permet de prouver
  que la forme bilin\'eaire $a$ est continue.
  Pour finir, nous utilisons l'in\'egalit\'e de Poincar\'e: il existe $c>0$
  tel que $\forall v \in H_0^1(\Omega), 
  \int_{\Omega} v^2 \deriv x \leq c \int_{\Omega} \GRAD v \SCAL \GRAD v \deriv x$.
  Avec cette in\'egalit\'e, on peut prouver que $a$ est coercive.
  Toutes les hypoth\`eses du th\'eor\`eme de Lax--Milgram sont r\'eunies,
  le probl\`eme \eqref{eq:LM2} est donc bien pos\'e.
\end{proof}

\begin{remark}
  Les r\'esultats de cette section prouvent l'unicit\'e de la solution
  de~\eqref{eq:ell_Dir} dans $H_0^1(\Omega)$. On a \'egalement prouv\'e l'existence d'une
  solution \`a \eqref{eq:LM2}. Pour prouver le th\'eor\`eme
  \ref{thm:ell_existence}, il faut montrer que si $f \in C^{\ell}(\Omega)$
  alors la solution de \eqref{eq:LM2} est dans $C^{\ell+2}(\Omega)$
  et est solution de \eqref{eq:ell_Dir}. Cependant cette preuve est 
  tr\`es d\'elicate et nous ne la d\'evelopperons pas ici.
\end{remark}


\begin{remark}
  On dit qu'une solution de \eqref{eq:ell_Dir}
  est une solution forte du probl\`eme de Poisson au sens
  o\`u les d\'eriv\'ees sont des d\'eriv\'ees usuelles.
  On dit qu'une solution de \eqref{eq:LM2} est une solution
  faible du probl\`eme de Poisson au sens o\`u les d\'eriv\'ees
  sont des d\'eriv\'ees faibles (au sens des distributions).
  Nous avons montr\'e qu'une solution forte est une solution faible.
  La r\'eciproque est plus d\'elicate et n\'ecessite des hypoth\`eses
  sur la r\'egularit\'e de $f$.
\end{remark}


\begin{exercise}
  On note $H^1(\Omega) = \{ v \in L^2(\Omega) \st \GRAD v \in [L^2(\Omega)]^d \}$
  et $H_{\bullet}^1(\Omega) = \{ v \in H^1(\Omega) \st \int_{\Omega} v \deriv x = 0 \}$.
  Prouver que toute solution du probl\`eme \eqref{eq:ell_Neu}
  est solution de la formulation variationnelle
  \begin{align}
    \label{eq:LM2_Neu}
    \text{Trouver $u \in H_{\bullet}^1(\Omega)$, tel que $\forall v \in H_{\bullet}^1(\Omega)$, } 
    \int_{\Omega} \GRAD v \SCAL \GRAD v \deriv x = \int_{\Omega} f v \deriv x .
  \end{align}
  Prouver de plus que le probl\`eme \eqref{eq:LM2_Neu} est bien pos\'e.

  Pour cela, on supposera que $H_{\bullet}^1$ \'equip\'e de la norme $\| \cdot \|_{H^1(\Omega)}$
  introduite pr\'ec\'edemment est un espace de Hilbert.
  On pourra \'egalement utiliser l'in\'egalit\'e de Poincar\'e--Wirtinger:
  il existe une constante $C>0$ telle que
  \begin{equation*}
    \forall v \in H^1(\Omega) , \qquad
    \int_{\Omega} \left( v - \dfrac{1}{|\Omega|} \int_{\Omega} v(x') \deriv x' \right)^2
    \deriv x \leq C \int_{\Omega} \GRAD v \SCAL \GRAD v \deriv x .
  \end{equation*}
\end{exercise}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Discr\'etisation par la m\'ethode des diff\'erences finies}
\label{subsec:ell_DF}

Le but de la m\'ethode des diff\'erences finies est d'approcher la solution 
d'une EDO (\'equation diff\'erentielle ordinaire) ou EDP
(\'equation aux d\'eriv\'ees partielles) par des valeurs cens\'ees repr\'esenter
cette fonction en certains points. Dans toutes les discr\'etisations abord\'ees dans ce cours,
nous ne consid\'ererons que le cas de probl\`emes \`a une dimension en espace
(les probl\`emes instationnaires auront une deuxi\`eme dimension correspondant au temps).

Par exemple, int\'eressons nous au probl\`eme \eqref{eq:ell_Dir} avec $\Omega = (0,1)$.
Notre probl\`eme est donc
\begin{equation}
  \label{eq:ell_1d}
  \left\{
    \begin{array}{l}
      - \dfrac{\!\deriv^2 u}{\!\deriv x^2} = f \dans (0,1) ,
      \\
      u(0) = u(1) = 0 .
    \end{array}
  \right.
\end{equation}

Nous discr\'etisons l'intervalle $(0,1)$ en $M>0$ sous-intervalles.
On d\'efinit donc les points $x_j = j h$ ($0 \leq j \leq M$) o\`u $h = 1/M$.
On a bien $x_0 = 0$ et $x_M = 1$ (voir figure \ref{fig:disc_x}).

\begin{figure}
\centering
\begin{tikzpicture}[scale=1]
\newcounter{it}
% intervalle
\draw (0,0) -- (10,0);
\forloop{it}{0}{\value{it} < 11}{
\draw (\arabic{it},-0.3) -- (\arabic{it},0.3);
}

% temps
\draw (0,-0.6) node {$0$};
\draw (10,-0.6) node {$1$};
\draw (0,0.6) node {$x_0$};
\draw (1,0.6) node {$x_1$};
\draw (10,0.6) node {$x_M$};
\draw (5,0.6) node {$.......$};
\end{tikzpicture} 
\caption{Repr\'esentation de la discr\'etisation de l'intervalle $(0,1)$ en $M$ sous-intervalles.}
\label{fig:disc_x}
\end{figure}


\'Etant donn\'e que nous ne disposons que de valeurs en certains points, on ne peut
pas d\'efinir de d\'eriv\'ees au sens usuel. On utilise donc des taux d'accroissement.
Rappelons qu'une d\'eriv\'ee est la limite d'un taux d'accroissement.
Par exemple, on peut montrer que 
$\dfrac{\!\deriv^2 u}{\!\deriv x^2}(x) 
= \lim\limits_{h \to 0} \dfrac{u(x+h) - 2 u(x) + u(x-h)}{h^2}$.
Avec les notations introduites pr\'ec\'edemment, cela signifie que,
pour $h$ suffisamment petit, 
\begin{align}
  \label{eq:dx2}
  \dfrac{\!\deriv^2 u}{\!\deriv x^2}(x_j) \simeq \dfrac{u(x_{j+1}) - 2 u(x_j) + u(x_{j-1})}{h^2} .
\end{align}
La m\'ethode des diff\'erences finies consiste donc \`a d\'efinir une suite $(u_j)_{0\leq j \leq M}$
qui reprenne les \'el\'ements du probl\`eme \eqref{eq:ell_1d}. En particulier, il faut remplacer
les d\'eriv\'ees continues par des taux d'accroissment.
Il existe plusieurs fa\c{c}ons de d\'efinir la suite $(u_j)_{0\leq j \leq M}$ et toutes
n'ont pas les m\^emes propri\'et\'es. La propri\'et\'e la plus importante est la convergence:
on veut que $\lim\limits_{M \to +\infty} \max_{0 \leq j \leq M} | u(x_j) - u_j | = 0$.
Nous aborderons plus en d\'etails ces aspects dans la section \ref{subsec:transport_DF}.


Nous proposons maintenant de discr\'etiser le prob\`eme \eqref{eq:ell_1d}
en utilisant \eqref{eq:dx2}.
Nous construisons donc une suite $(u_j)_{0\leq j \leq M}$ v\'erifiant
\begin{equation}
  \label{eq:ell_DF}
  \left\{
    \begin{array}{l}
      \forall 1 \leq j \leq M-1 , - \dfrac{u_{j+1} - 2 u_j + u_{j-1}}{h^2} = f(x_j) ,
      \\
      u_0 = u_M = 0 .
    \end{array}
  \right.
\end{equation}

\begin{proposition}
  La relation \eqref{eq:ell_DF} d\'efinit une unique suite $(u_j)_{0\leq j \leq M}$ dont les valeurs
  peuvent \^etre d\'etermin\'ees en r\'esolvant le syst\`eme lin\'eaire
  $A_{\Delta} U = F$, avec 
  \begin{equation}
    \label{eq:mat_DF_Laplacien}
    A_{\Delta} = \dfrac{1}{h^2} 
    \begin{pmatrix} 
      2 & -1 & 0 & \cdots
      \\
      -1 & 2 & -1 & 0 & \cdots
      \\
      0 & -1 & 2 & \ddots &
      \\
      \vdots & & \ddots & \ddots & \ddots
      \\
      & & &  \ddots & 2 & -1
      \\
      & &  & & -1 & 2
    \end{pmatrix} , \qquad U = 
    \begin{pmatrix}
      u_1 \\ u_2 \\ \vdots \\ u_{M-1}
    \end{pmatrix} , \qquad F = 
    \begin{pmatrix}
      f(x_1) \\ f(x_2) \\ \vdots \\ f(x_{M-1})
    \end{pmatrix} .
  \end{equation}
  Notons que la valeur de $u_0$ et $u_M$ est d\'ej\`a connue (elle est nulle).
\end{proposition}

\begin{proof}
  La relation \eqref{eq:ell_DF} est \'equivalente au syst\`eme lin\'eaire $A_{\Delta} U = F$.
  Pour prouver cela, on \'ecrit les \'equations discr\`etes
  \begin{align*}
    &\dfrac{-u_0 + 2 u_1 - u_2}{h^2} = f(x_1) ,
    \\
    &\dfrac{-u_1 + 2 u_2 - u_3}{h^2} = f(x_2) ,
    \\
    &\dfrac{-u_2 + 2 u_3 - u_4}{h^2} = f(x_3) ,
    \\
    & \qquad \qquad \vdots
    \\
    &\dfrac{-u_{M-2} + 2 u_{M-1} - u_M}{h^2} = f(x_{M-1}) .
  \end{align*}
  En prenant en compte $u_0 = u_M = 0$, on obtient bien $A_{\Delta} U = F$.
  La r\'eciproque se prouve de mani\`ere similaire.

  Maintenant, le fait que ce syst\`eme admet une unique solution vient de l'inversibilit\'e
  de la matrice $A_{\Delta}$ qui est une cons\'equence de la proposition \ref{prop:matSDP}.
\end{proof}


\begin{remark}
  La matrice $A_{\Delta}$ doit absolument \^etre connue par c\oe{}ur.
  En effet, ceci est exigible et le jury du concours se plaint dans ses rapports
  que beaucoup trop de candidats ne connaissent pas cette matrice.
\end{remark}

\begin{proposition}
  \label{prop:matSDP}
  La matrice $A_{\Delta}$ est sym\'etrique d\'efinie positive.
\end{proposition}


\begin{exercise}
  Prouver la proposition \ref{prop:matSDP}.
\end{exercise}

\begin{proposition}[Convergence]
  \label{prop:ell_conv}
  %% voir Proposition 2.10 du livre de B. Lucquin
  Supposons que la solution $u$ du probl\`eme \eqref{eq:ell_1d} soit 
  dans $C^4(0,1)$.
  Alors il existe $C>0$ tel que pour tout $M \geq 2$, on a
  \begin{align*}
    \max_{0 \leq j \leq M} | u(x_j) - u_j | \leq C h^2 ,
  \end{align*}
  avec $h = 1/M$.
\end{proposition}

\begin{proof}
  \'Etant donn\'e que $u \in C^{4}(0,1)$, on peut utiliser la formule de Taylor--Young
  \begin{align*}
    u(x_{j+1}) = u(x_j) + h u'(x_j) + \dfrac{h^2}{2} u^{(2)}(x_j) + \dfrac{h^3}{6} u^{(3)}(x_j)
    + \dfrac{h^4}{24} u^{(4)}(x_j) + o(h^4) ,
    \\
    u(x_{j-1}) = u(x_j) - h u'(x_j) + \dfrac{h^2}{2} u^{(2)}(x_j) - \dfrac{h^3}{6} u^{(3)}(x_j)
    + \dfrac{h^4}{24} u^{(4)}(x_j) + o(h^4) .
  \end{align*}
  On obtient ainsi
  \begin{align*}
    \dfrac{-u(x_{j+1}) + 2 u(x_j) - u(x_{j-1})}{h^2} = - u^{(2)}(x_j) - \dfrac{h^2}{12} u^{(4)}(x_j)
    + o (h^2) .
  \end{align*}
  On a de plus 
  \begin{align*}
    \dfrac{- u_{j+1} + 2 u_j - u_{j-1}}{h^2} = f(x_j) = - u^{(2)}(x_j) ,
  \end{align*}
  et donc
  \begin{align*}
    \dfrac{-\delta_{j+1} + 2 \delta_j - \delta_{j-1}}{h^2} = \dfrac{h^2}{12} u^{(4)}(x_j) + o(h^2) ,
  \end{align*}
  o\`u $\delta_j = u_j - u(x_j)$.
  En notant $\underline{\delta}$ le vecteur des $\delta_j$,
  on a $\underline{\delta} = A_{\Delta}^{-1} \underline{\epsilon}$
  avec $(\underline{\epsilon})_j = O(h^2)$.
  En supposant que $\sup_{X \in \R^{M-1}\backslash \{0\}} \dfrac{\max_{j} |(A_{\Delta}^{-1}X)_j|}{\max_j |X_j|}$
  est born\'e quand $h$ tend vers $0$ (on ne le montre pas ici), on obtient le r\'esultat attendu.
\end{proof}

Le r\'esultat pr\'ec\'edent signifie que pour $h$ suffisamment petit
on s'attend \`a ce que l'erreur commise par le sch\'ema num\'erique d\'ecroisse
comme le carr\'e de $h$.
On dit que le sch\'ema est d'ordre $2$, nous \'etudierons plus pr\'ecis\'ement cette notion
plus loin dans le cours.


Cette notion d'ordre de convergence peut \^etre illustr\'ee en repr\'esentant 
l'erreur commise par le sch\'ema 
$\varepsilon = \max_{0\leq j \leq M} |u(x_j) - u_j|$ en fonction de $h$ 
en utilisant une \'echelle logarithmique
pour les axes des abscisses et des ordonn\'ees.
Par exemple, consid\'erons $f(x) = x^2$, la solution exacte associ\'ee
est $u(x) = \frac{x}{12}(1-x^3)$.
L'erreur du sch\'ema commise sur ce cas test est repr\'esent\'ee
sur la figure \ref{fig:ell_convergence}.
On voit que l'on obtient une droite de pente $2$.
Ceci est en accord avec la proposition \ref{prop:ell_conv} :
si l'erreur est $\varepsilon = C h^2$ alors
$\log(\varepsilon) = 2 \log(h) + \log(C)$.

\begin{figure}[h]
  \centering
  \includegraphics[width = 12cm]{Figures/Poisson_conv.eps}
  \caption{Erreur en fonction de $h$ (\'echelle logarithmique)
    pour $f(x) = x^2$.}
  \label{fig:ell_convergence}
\end{figure}


\begin{exercise}
  Coder le sch\'ema d\'ecrit pr\'ec\'edemment et retrouver les 
  r\'esultats de la figure \ref{fig:ell_convergence}
  (les diff\'erents points ont \'et\'e obtenus pour $M=10$, $20$,
  $50$, $100$ et $200$).
\end{exercise}

\begin{exercise}[Coefficient de raideur]
  On peut d\'ecider d'ajouter un coefficient de raideur $k>0$ constant.
  La nouvelle matrice devient alors $k A_{\Delta}$ o\`u $A_{\Delta}$ est la matrice 
  pr\'ec\'edente.
  La figure \ref{fig:ell_k} a \'et\'e obtenue pour $f(x) = 1$
  et $M=10$ ($h=1/10$).
  Coder le sch\'ema propos\'e et retrouver les r\'esultats
  de la figure \ref{fig:ell_k}.
  Calculer la solution exacte.
  En d\'eduire l'erreur que commet le sch\'ema.
  Que remarquez-vous?
\end{exercise}


\begin{exercise}[Conditions aux limites de Dirichlet non homog\`enes]
  Adapter le sch\'ema num\'erique pr\'ec\'edent pour approcher
  le probl\`eme
  \begin{align*}
    \left\{
    \begin{array}{l}
      - \dfrac{\!\deriv^2 u}{\!\deriv x^2} = f \dans (0,1) ,
      \\
      u(0) = \alpha ,
      \\
      u(1) = \beta ,
    \end{array}
    \right.
  \end{align*}
  o\`u $\alpha, \beta \in \R$.
  Donner le syst\`eme lin\'eaire \`a r\'esoudre.
\end{exercise}

\begin{exercise}[Condition aux limites de Neumann]
  On consid\`ere le probl\`eme de Poisson avec des conditions aux limites
  de Neumann 
  \begin{align*}
    \left\{
    \begin{array}{l}
      - \dfrac{\!\deriv^2 u}{\!\deriv x^2} = f \dans (0,1) ,
      \\
      u'(0) = u'(1) = 0 ,
      \\
      \int_0^1 u(x) \deriv x = 0 .
    \end{array}
  \right.
  \end{align*}
  \begin{enumerate}
  \item On d\'ecide d'adapter la d\'emarche pr\'ec\'edente en consid\'erant le sch\'ema
    \begin{align*}
      \left\{
      \begin{array}{l}
        \forall 1 \leq j \leq M-1 , - \dfrac{u_{j+1} - 2 u_j + u_{j-1}}{h^2} = f(x_j) ,
        \\
        \dfrac{u_1 - u_0}{h} = \dfrac{u_M - u_{M-1}}{h} = 0.
      \end{array}
      \right.
    \end{align*}
    Calculer la matrice associ\'ee. Montrer qu'elle est positive 
    mais qu'elle n'est pas inversible. Commenter.
  \item On ajoute une condition de moyenne nulle, le sch\'ema devient
    \begin{align*}
      \left\{
      \begin{array}{l}
        \forall 1 \leq j \leq M-1 , - \dfrac{u_{j+1} - 2 u_j + u_{j-1}}{h^2} = f(x_j) ,
        \\
        \dfrac{u_1 - u_0}{h} = \dfrac{u_M - u_{M-1}}{h} = 0 ,
        \\
        \sum\limits_{j=1}^{M-1} u_j = 0 .
      \end{array}
      \right.
    \end{align*}
    On impose la condition de moyenne nulle par un multiplicateur de Lagrange $\alpha \in \R$.
    Le probl\`eme devient $\widetilde{A} \widetilde{U} = \widetilde{F}$ avec
    \begin{align*}
      \widetilde{A} = \dfrac{1}{h^2}
      \begin{pmatrix}
        1 & -1 & & & & h^2
        \\
        -1 & 2 & -1& & & \vdots
        \\
        & \ddots & \ddots & \ddots & & \vdots
        \\
        & & -1 & 2 & -1 & \vdots
        \\
        & &    & -1 & 1 & h^2
        \\
        h^2 & \cdots & \cdots & \cdots &  h^2 & 0
      \end{pmatrix} ,
      \qquad \widetilde{U} = 
      \begin{pmatrix}
        u_1 \\ \vdots \\ u_{M-1} \\ \alpha
      \end{pmatrix} ,
      \qquad \widetilde{F} = 
      \begin{pmatrix}
        f(x_1) \\ \vdots \\ f(x_{M-1}) \\ 0
      \end{pmatrix} .
    \end{align*}
    Montrer que la matrice $\widetilde{A}$ est inversible.
  \item Coder ce sch\'ema et le tester avec $f(x)=1$.
    Que se passe-t-il? Est-ce un comportement normal?
    D'apr\`es vous, que repr\'esente $\alpha$?
  \item Essayons maintenant 
    \begin{align*}
      f(x) = \left\{
      \begin{array}{l}
        1 \quad \text{si} \quad x \in (0,0.5),
        \\
        0 \quad \text{si} \quad x=0.5,
        \\
        -1 \quad \text{si} \quad x \in (0.5,1).
      \end{array}
      \right.
    \end{align*}
    Calculer la solution exacte \`a ce probl\`eme. 
    D\'eterminer num\'eriquement l'ordre de convergence du sch\'ema. 
    Est-ce en contradition avec la proposition \ref{prop:ell_conv}?

  \item On pourra \'egalement reprendre la question pr\'ec\'edente avec
    $f(x) = x-\frac{1}{2}$.
  \end{enumerate}
\end{exercise}

\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\'Equation de transport}

Nous \'etudions ici l'\'equation de transport dans un espace \`a une dimension.
Le probl\`eme d\'epend donc d'une variable d'espace $x \in [0,1]$ et d'une variable de temps
$t \in [0,T]$ avec $T>0$.
Nous consid\'erons le probl\`eme
\begin{equation}
  \label{eq:transport}
  \text{Trouver $u \in C^1([0,T] \times [0,1] )$ telle que} \;
  \left\{
    \begin{array}{l}
     \dfrac{\partial u}{\partial t} + a \dfrac{\partial u}{\partial x} = 0 
      \dans (0,T) \times (0,1),
      \\
      \forall t \in (0,T), u(t,0) = \alpha(t) ,
      \\
      \forall x \in (0,1), u(0,x) = u_0(x) ,
    \end{array}
  \right.
\end{equation}
o\`u $a > 0$ correspond \`a la vitesse de transport de l'\'equation,
$\alpha(t)$ est la donn\'ee de Dirichlet \`a gauche
et $u_0$ est la donn\'ee initiale.
Dans l'\'enonc\'e de notre probl\`eme, nous avons not\'e
$C^1([0,T] \times [0,1])$ l'ensemble des fonctions $C^1$
de $[0,T] \times [0,1]$ \`a valeur dans $\R$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Propri\'et\'es g\'en\'erales}

Le probl\`eme \eqref{eq:transport} admet une unique solution $u$.
Cette solution est obtenue en "d\'epla\c{c}ant" la donn\'ee initiale
vers la droite et en "faisant entrer" la donn\'ee de Dirichlet dans le domaine.
De mani\`ere plus rigoureuse, nous avons le th\'eor\`eme suivant.

\begin{theorem}
  \label{thm:transport_existence}
  Supposons que $a > 0$, $u_0 \in C^1([0,1])$ et $\alpha \in C^1([0,T])$.
  Supposons, de plus, les conditions de compatibilit\'e $u_0(0) = \alpha(0)$
  et $\alpha'(0) +a u_0'(0)=0$.
  Le probl\`eme \eqref{eq:transport} admet alors une unique solution donn\'ee par
  \begin{align}
    \label{eq:transport_sol}
    u(t,x) = 
    \begin{cases} 
      u_0(x-at) \quad &\text{si} \; x \geq at ,
      \\ 
      \alpha(t-x/a) \quad  &\text{sinon} .
    \end{cases}
  \end{align}
\end{theorem}

\begin{remark}
  On n'a besoin d'une donn\'ee de Dirichlet que d'un seul c\^ot\'e du domaine.
  Puisque l'on a choisi $a > 0$, il faut fixer la donn\'ee de Dirichlet \`a gauche.
  On aurait aussi pu prendre $a < 0$ et utiliser la condition de Dirichlet \`a droite
  $u(t,1) = \alpha(t)$.
\end{remark}


Nous allons maintenant \'evoquer une autre propri\'et\'e int\'eressante de l'\'equation
de transport: la r\'eversibilit\'e de l'\'equation.
Cela signifie qu'en utilisant la solution au temps final et \'eventuellement d'autres donn\'ees
(ici la solution qui sort du domaine \`a droite), on peut reconstituer la solution
en tout temps $t \in [0,T]$.
Il s'agit en fait d'\'etudier un probl\`eme o\`u le temps s'\'ecoule 
"en sens inverse".

\begin{proposition}[R\'eversibilit\'e de l'\'equation de transport]
  \label{prop:transport_rev}
  Soit $u$ une solution du probl\`eme \eqref{eq:transport}.
  Le probl\`eme
  \begin{equation}
    \label{eq:transport_rev}
    \text{Trouver $\tu \in C^1([0,T] \times [0,1] )$ telle que} \;
    \left\{
      \begin{array}{l}
        \dfrac{\partial \tu}{\partial t} - a \dfrac{\partial \tu}{\partial x} = 0 
        \quad \dans (0,T) \times (0,1),
        \\
        \forall t \in (0,T), \qquad \tu(t,1) = u(T-t,1) ,
        \\
        \forall x \in (0,1), \qquad \tu(0,x) = u(T,x) ,
      \end{array}
    \right.
  \end{equation}
  admet une unique solution d\'efinie par
  $\forall t \in [0,T], \forall x \in [0,1]$, 
  $\tu(t,x) = u(T-t,x)$. 
\end{proposition}

Cette propri\'et\'e signifie que l'information est conserv\'ee au cours du temps:
le comportement de l'\'equation ne d\'egrade pas cette information.
On peut donc, avec la connaissance de $u$ \`a l'instant final dans tout le domaine 
et en tout temps sur la droite du domaine, retrouver la valeur de $u$ en tout temps dans tout le domaine.
Pour cela, on inverse le temps ($\tilde{t} = T - t$) et le sens du transport
(il y a un $-a$ au lieu de $+a$ dans~\eqref{eq:transport_rev}).

Notons que toutes les \'equations instationnaires ne sont pas r\'eversibles, 
nous verrons notamment la non-r\'eversibilit\'e de l'\'equation de la chaleur
en section~\ref{subsec:chaleur_prop}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{M\'ethode des caract\'eristiques}

La m\'ethode des caract\'eristiques consiste \`a montrer que la solution
se conserve sur certaines courbes que l'on appelle trajectoires caract\'eristiques.
Dans le cas monodimensionnel avec $a$ constant, ces courbes sont des droites.
On parlera donc de droites caract\'eristiques.
Cependant, dans le cas o\`u plusieurs dimensions d'espace sont consid\'er\'ees,
ces courbes peuvent \^etre plus complexes (voir la section~\ref{subsec:transport_multiD}).

\begin{figure}
\centering
\begin{tikzpicture}[scale = 9]
  \input{D_carac.tex}
\end{tikzpicture}
\caption{Les droites caract\'eristiques de l'\'equation de transport
  ($a=1$ et $T=0.9$). Ces droites sont repr\'esent\'ees dans le domaine $(0,T) \times (0,1)$
  (ici le temps est en ordonn\'ee et l'espace en abscisse). La partie de la fronti\`ere
  o\`u on utilise les donn\'ees de $u$ est repr\'esent\'ee en gras. Les cercles indiquent
  qu'en ces points, on attribue la valeur de $u$ \`a la droite caract\'eristique
  (et cette valeur est ensuite conserv\'ee sur toute la droite).
  Comparer cette figure avec le th\'eor\`eme~\ref{thm:transport_existence}.}
\label{fig:D_carac}
\end{figure}

Nous pouvons montrer que dans le cas consid\'er\'e dans cette section,
la solution se conserve sur les droites d'\'equation $x=at+b$ avec 
$a$ la vitesse de transport dans~\eqref{eq:transport} et $b \in \R$.
Ces droites sont donc les droites caract\'eristiques de notre probl\`eme,
nous les repr\'esentons sur la figure~\ref{fig:D_carac}.
Le r\'esultat de conservation est \'enonc\'e dans la proposition suivante.

\begin{proposition}
  \label{prop:droites_carac}
  Soit $u \in C^1([0,T] \times [0,1])$ v\'erifiant l'\'equation de transport
  \begin{align*}
    \dfrac{\partial u}{\partial t} + a \dfrac{\partial u}{\partial x} = 0 
    \dans (0,T) \times (0,1) ,
  \end{align*}
  avec $a \in \R$.
  Pour tous $t,s \in [0,T]$ et $x \in [0,1]$ tels que
  $t-s \in [0,T]$ et $x-as \in [0,1]$, on a
  \[
    u(t,x) = u(t-s , x-as) .
  \]
\end{proposition}

\begin{exercise}
  Prouver la proposition~\ref{prop:droites_carac}.
\end{exercise}


Notons que la proposition \ref{prop:droites_carac} est valable pour tout $a \in \R$
et pour n'importe quelles conditions aux limites. 
Elle montre que si l'on se d\'eplace sur une droite caract\'eristique
tout en restant dans le domaine $(0,T) \times (0,1)$, alors la valeur
de $u$ se conserve.


Pour calculer la valeur de $u(t,x)$, il suffit de d\'eterminer la droite caract\'eristique passant
en $(t,x)$ et chercher son intersection avec le bord du domaine sur lequel on conna\^it
la valeur de $u$ (il s'agit de $\big((0,T) \times \{0\}\big) \cup \big( \{0\} \times (0,1)\big)$,
en gras sur la figure~\ref{fig:D_carac}).
Nous allons utiliser cette m\'ethode pour prouver
le th\'eor\`eme~\ref{thm:transport_existence}.

\begin{proof}[Preuve du th\'eor\`eme \ref{thm:transport_existence}]
  Commen\c{c}ons par montrer que la fonction $u$ donn\'ee dans \eqref{eq:transport_sol}
  est solution du probl\`eme \eqref{eq:transport}.
  On note $u^+(t,x) = u_0(x-at)$ et $u^-(t,x) = \alpha(t-x/a)$.

  Par construction, les fonctions $u^+$ et $u^-$ sont $C^1$ sur leur domaine de 
  d\'efinition. Nous cherchons \`a les raccorder le long de la droite $x=at$.
  Soit $(t_0,x_0) \in [0,T] \times [0,1]$ qui v\'erifient $x_0 = at_0$.
  On a $\lim_{(t,x) \to (t_0,x_0)} u^+(t,x) = \lim_{s \to 0^+} u_0(s) = u_0(0)
  = \alpha(0) = \lim_{s \to 0^+} \alpha(s) = \lim_{(t,x) \to (t_0,x_0)} u^-(t,x)$.
  La fonction $u$ est donc continue.
  De plus, par un raisonnement similaire, la condition $\alpha'(0) = -au_0'(0)$
  implique que $u$ est dans $C^1([0,T]\times [0,1])$.
  De plus, $u$ v\'erifie la condition initiale $u(0,x) = u_0(x)$ ainsi que la condition
  de Dirichlet $u(t,0) = \alpha(t)$ et elle v\'erifie l'\'equation de transport.
  Il s'agit donc bien d'une solution de \eqref{eq:transport}.

  Supposons maintenant que $v \in C^1([0,T] \times [0,1])$ est solution de
  \eqref{eq:transport}.
  Si $x \leq a t$, on applique la proposition \ref{prop:droites_carac}
  avec $s=x/a$, avec la condition de Dirichlet
  on obtient $v(t,x) = \alpha(t-x/a)$.
  Si $x \geq a t$, on applique la proposition \ref{prop:droites_carac}
  avec $s=t$, avec la condition initiale on obtient $v(t,x) = u_0(x-at)$.
  Nous avons donc prouv\'e l'unicit\'e de la solution.
\end{proof}


Nous voyons donc que la valeur de la solution en $(t,x)$ est \`a aller chercher
sur le bord du domaine espace-temps. C'est-\`a-dire, en fonction de la valeur de 
$t$ et $x$, soit sur la condition initiale, soit sur la donn\'ee de Dirichlet
(l'endroit o\`u r\'ecup\'erer l'information est repr\'esent\'e sur la figure
\ref{fig:D_carac} par un cercle).


\begin{remark}
  Avec un raisonnement similaire, on peut montrer que si $a=0$, il n'y a pas besoin 
  de condition de Dirichlet et que si $a<0$, il faut mettre la condition de Dirichlet
  sur la droite du domaine (en $x=1$). 
  Le m\^eme r\'esultat d'existence et d'unicit\'e s'applique alors.
\end{remark}

On peut utiliser la m\'ethode des caract\'eristiques pour prouver d'autres r\'esultats
comme par exemple ceux \'enonc\'es dans les exercices suivants.
\begin{exercise}
  Prouver la proposition \ref{prop:transport_rev}.
\end{exercise}

\begin{exercise}[Conditions aux limites p\'eriodiques]
  \label{exo:carac_per}
  Soit $u_0 \in C^1([0,1])$ qui v\'erifie $u_0(0) = u_0(1)$ et $u_0'(0) = u_0'(1)$.
  Prouver que l'\'equation de transport avec des conditions aux limites p\'eriodiques
  \begin{equation}
    \label{eq:transport_per}
    \left\{
      \begin{array}{l}
        \dfrac{\partial u}{\partial t} + a \dfrac{\partial u}{\partial x} = 0 
        \dans (0,T) \times (0,1),
        \\
        \forall t \in (0,T), \quad u(t,0) = u(t,1) ,
        \\
        \forall x \in (0,1), \quad u(0,x) = u_0(x) ,
      \end{array}
    \right.
  \end{equation}
  avec $a\in \R$
  admet pour unique solution $u(t,x) = u_0(f(x-at))$,
  o\`u $f(x)$ est la partie fractionnaire de $x$,
  c'est-\`a-dire $x = E(x) + f(x)$ avec $E(x) \in \Z$
  et $0 \leq f(x) < 1$.
\end{exercise}

\begin{exercise}[Prise en compte d'un terme source]
  Montrer que l'unique solution du probl\`eme
  \begin{equation*}
    \left\{
      \begin{array}{l}
        \dfrac{\partial u}{\partial t} + a \dfrac{\partial u}{\partial x} = f(t,x)
        \dans (0,T) \times \R,
        \\
        \forall x \in \R, \quad u(0,x) = u_0(x) ,
      \end{array}
    \right.
  \end{equation*}
  avec $a \in \R$, $f \in C^0([0,T] \times \R)$ et $u_0 \in C^1(\R)$,
  est donn\'ee par 
  $u(t,x) = u_0(x-at) + \int_0^t f(s,x+a(s-t)) \deriv s$.
  \\
  NB: Notez que l'on a pos\'e ce probl\`eme sur $\R$ entier pour ne pas avoir
  \`a se soucier des conditions aux limites.
\end{exercise}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Discr\'etisation par les diff\'erences finies et analyse num\'erique}
\label{subsec:transport_DF}

Nous cherchons maintenant \`a discr\'etiser le probl\`eme \eqref{eq:transport}
par la m\'ethode des diff\'erences finies.
Dans la section \ref{subsec:ell_DF}, pour approcher l'\'equation de Poisson,
nous avons discr\'etis\'e l'espace $(0,1)$ et nous avons approch\'e la solution
$u(x)$ par une suite de terme g\'en\'eral $u_j$.

Dans le cas pr\'esent, la solution d\'epend de deux variables $t$ et $x$,
il faut donc discr\'etiser ces deux dimensions.
On d\'ecoupe l'intervalle de temps $[0,T]$ en $N$ sous-intervalles $[t_n , t_{n+1}]$
avec pour tout $0\leq n \leq N$,  $t_n = n h_t$ et $h_t = T/N$.
De m\^eme, on d\'ecoupe l'intervalle d'espace $[0,1]$ en $M$ sous-intervalles
$[x_j , x_{j+1}]$ avec pour tout $0 \leq j \leq M$, $x_j = j h_x$ et $h_x = 1/M$. 
De plus, nous allons approcher la fonction $u(t,x)$ par une suite
$(u_j^n)_{\substack{0 \leq n \leq N \\ 0 \leq j \leq M}}$.
Ici, l'indice $j$ donne la position en espace et l'exposant $n$
donne le temps consid\'er\'e. Ainsi, on cherche \`a calculer $u_j^n$ 
de mani\`ere \`a ce que ce soit une approximation
de $u(t_n, x_j)$.

%%%%%%%%%%%%%%%%%%
\subsubsection{Motivation de l'analyse num\'erique}

Comme nous l'avons vu pr\'ec\'edemment, lorsque l'on consid\`ere
l'\'equation de transport avec une condition de Dirichlet,
l'information de la donn\'ee initiale sort progressivement du domaine
en \'etant remplac\'ee par la donn\'ee de Dirichlet.
On pourrait vouloir s'int\'eresser \`a l'\'evolution sur le temps long de 
l'information issue de la donn\'ee initiale.
Pour cela, on peut essayer de suivre cette donn\'ee
initiale en consid\'erant des conditions p\'eriodiques.
C'est ce que nous faisons dans cette section.
On s'int\'eresse donc au probl\`eme~\eqref{eq:transport_per}.

Avec ces conditions fronti\`eres, l'information qui sort en 
$x=1$ r\'eentre imm\'ediatement en $x=0$.
On peut donc la suivre au cours de sa propagation dans le domaine
et observer la qualit\'e de l'approximation que nous avons faite.
Nous allons donc comparer nos approximations num\'eriques avec la solution
exacte donn\'ee par $u(t,x) = u_0(f(x-at))$ (voir exercice~\ref{exo:carac_per}).


Nous proposons maintenant deux discr\'etisations du probl\`eme~\eqref{eq:transport_per}.
La m\'ethode consiste \`a approcher les d\'eriv\'ees partielles
(en temps et en espace) par des taux d'accroissement.
Nous comparons le comportement de deux discr\'etisations diff\'erentes.


Nous proposons tout d'abord d'approcher la d\'eriv\'ee en temps par une
approximation d\'ecentr\'ee aval et la d\'eriv\'ee en espace par une 
approximation centr\'ee comme suit
\begin{align*}
  \dfrac{\partial u}{\partial t}(t_n,x_j) \simeq \dfrac{u(t_{n+1},x_j) - u(t_n,x_j)}{h_t} ,
  \qquad \qquad 
  \dfrac{\partial u}{\partial x}(t_n,x_j) \simeq \dfrac{u(t_n,x_{j+1}) - u(t_n,x_{j-1})}{2 h_x} .
\end{align*}
On obtient le sch\'ema num\'erique
\begin{align}
  \label{eq:transport_DF_centre}
  \left\{
  \begin{array}{l}
    \forall 0 \leq j \leq M , 
    u_j^0 = u_0(x_j) ,
    \\
    \forall 1 \leq n \leq N, u_0^n = u_M^n ,
    \\
    \forall 1 \leq n \leq N, \forall 0 \leq j \leq M,
    u_j^n = u_j^{n-1} - \dfrac{a h_t}{2 h_x} (u_{j+1}^{n-1} - u_{j-1}^{n-1}) ,
  \end{array}
  \right.
\end{align}
o\`u, pour simplifier l'\'ecriture, 
nous avons introduit $u_{M+1}^n = u_1^n$ et $u_{-1}^n = u_{M-1}^n$
(rappelons que $u_M^n = u_0^n$).


Nous nous proposons \'egalement d'approcher les d\'eriv\'ees en temps et les d\'eriv\'ees
en espace respectivement par des approximations d\'ecentr\'ees aval et amont comme suit
\begin{align}
  \label{eq:der_decentre_AM}
  \dfrac{\partial u}{\partial t}(t_n,x_j) \simeq \dfrac{u(t_{n+1},x_j) - u(t_n,x_j)}{h_t} ,
  \qquad \qquad 
  \dfrac{\partial u}{\partial x}(t_n,x_j) \simeq \dfrac{u(t_n,x_{j}) - u(t_n,x_{j-1})}{h_x} .
\end{align}
On obtient le sch\'ema num\'erique
\begin{align}
  \label{eq:transport_DF_decentre_AM}
  \left\{
  \begin{array}{l}
    \forall 0 \leq j \leq M , 
    u_j^0 = u_0(x_j) ,
    \\
    \forall 1 \leq n \leq N, u_0^n = u_M^n ,
    \\
    \forall 1 \leq n \leq N, \forall 0 \leq j \leq M,
    u_j^n = u_j^{n-1} - \dfrac{a h_t}{h_x} (u_{j}^{n-1} - u_{j-1}^{n-1}) ,
  \end{array}
  \right.
\end{align}
o\`u, pour simplifier l'\'ecriture, nous avons introduit $u_{-1}^n = u_{M-1}^n$.


Nous reportons sur la figure~\ref{fig:trans_per} 
les r\'esultats num\'eriques obtenus \`a partir de ces deux sch\'emas.
Lorsque l'on raffine le maillage (quand on augmente $N$ et $M$),
la solution obtenue par le sch\'ema d\'ecentr\'e~\eqref{eq:transport_DF_decentre_AM}
tend vers la solution exacte
tandis que la solution obtenue par le sch\'ema centr\'e~\eqref{eq:transport_DF_centre}
se d\'egrade de plus en plus. La solution obtenue par le sch\'ema centr\'e semble
diverger quand $N, M \to +\infty$.

\begin{figure}[h]
  \centering
  \includegraphics[width = 8cm]{Figures/transport_per_N15.eps}
  \includegraphics[width = 8cm]{Figures/transport_per_N30.eps}
  \includegraphics[width = 8cm]{Figures/transport_per_N60.eps}
  \includegraphics[width = 8cm]{Figures/transport_per_N120.eps}
  \caption{\'Equation de transport avec conditions p\'eriodiques: solution exacte (\`a 
    l'instant final) et
    solutions (\`a l'instant final) 
    obtenues par les sch\'emas d\'ecentr\'e et centr\'e pour $T=0.5$, $a=1$ et
    $(N,M) = (15,20)$, $(30,40)$, $(60,80)$ et $(120,160)$.
    La condition initiale est $u_0(x) = x^2(1-x)^2$.}
  \label{fig:trans_per}
\end{figure}


Il va de soi que le sch\'ema d\'ecentr\'e a un comportement tout \`a fait acceptable
tandis que le sch\'ema centr\'e est totalement inutilisable.
Il ne suffit donc pas de remplacer les d\'eriv\'ees
partielles de l'EDP par des taux d'accroissement pour obtenir un bon sch\'ema num\'erique.
Pour \^etre s\^ur que le sch\'ema que l'on con\c{c}oit a un bon comportement,
il faut v\'erifier certaines propri\'et\'es que nous allons aborder dans la section suivante.


\begin{exercise}
  La figure \ref{fig:trans_per} a \'et\'e obtenue pour $a=1$, $T=0.5$, $u_0(x) = x^2(1-x^2)$
  et $(N,M) = (15,20)$, $(30,40)$, $(60,80)$ et $(120,160)$.
  Dans ces conditions la solution exacte est $u(t,x) = u_0(f(x-at))$
  (voir exercice \ref{exo:carac_per}).
  Coder les sch\'emas \eqref{eq:transport_DF_centre} et \eqref{eq:transport_DF_decentre_AM}
  et retrouver la figure \ref{fig:trans_per}.
  On pourra aussi explorer d'autres valeurs de $(N,M)$.
\end{exercise}

%%%%%%%%%%%%%%%%%%
\subsubsection{Analyse num\'erique : d\'efinitions et th\'eor\`emes}
\label{subsubsec:analyse_def}

Nous d\'efinissons maintenant des notions que nous
utilisons plus loin pour analyser les deux sch\'emas introduits pr\'ec\'edemment.
Pour cela, \`a $n$ donn\'e, nous introduisons $U^n = (u_j^n)_{1 \leq j \leq M}$:
$u_j^n$ est \'egal \`a la $j$-\`eme coordonn\'ee du vecteur $U^n$.
On peut montrer que $U^n$ v\'erifie la relation de r\'ecurrence
\begin{align}
  \label{eq:schema_1pas}
  U^0 = U_0 \qquad \text{et} \qquad \forall n \geq 0, \quad U^{n+1} = A U^n + h_t F^n ,
\end{align}
o\`u $U_0$ est donn\'e par $(U_0)_j = u(0,x_j)$, $A$ est une matrice
et $F^n$ est un vecteur.
Afin de simplifier notre propos, nous consid\'erons que le syst\`eme \`a inverser 
a $M$ inconnues que l'on num\'erote de $1$ \`a $M$.
Ainsi, pour tout $0 \leq n \leq N$,
$U^n \in \R^M$ avec $\forall 1 \leq j \leq M$, $(U^n)_j = u_j^n$ et de m\^eme
$A \in \R^{M \times M}$ et $F^n \in \R^M$.
La valeur de $u_0^n$ n'est pas consid\'er\'ee comme inconnue du probl\`eme
car elle est donn\'ee par une condition limite (Dirichlet ou p\'eriodique).
Si le syst\`eme dispose d'un nombre diff\'erent d'inconnues, on pourra
ais\'ement adapter notre propos.

\begin{remark}
  Dans le cas pr\'esent, nous consid\'erons une suite dont la formule de r\'ecurrence
  ne n\'ecessite que le pas de temps pr\'ec\'edent (sch\'ema \`a un pas de temps).
  En pratique, certains sch\'emas n\'ecessitent plusieurs pas de temps pr\'ec\'edents.
  Le sch\'ema \eqref{eq:schema_1pas} ainsi que les notions que nous abordons dans cette
  section peuvent \^etre adapt\'es \`a ce cas de figure.
  Nous verrons ceci plus loin dans le cours.
\end{remark}

D\'efinissons maintenant un certain nombre de notions utiles pour
\'etudier le comportement du sch\'ema \eqref{eq:schema_1pas}.
On introduit notamment $\| \cdot \|$ une norme sur $\R^M$.
\begin{definition}[Stabilit\'e]
  \label{def:stabilite}
  Soit $\Stab \subset \R_+^* \times \R_+^*$ tel que $(0,0) \in \overline{\Stab}$.
  On dit que le sch\'ema num\'erique \eqref{eq:schema_1pas} est stable pour la norme $\| \cdot \|$
  sous la condition $\Stab$ s'il existe $C_1 , C_2 > 0$ qui ne d\'ependent que de $T$
  tels que $\forall (h_x , h_t) \in \Stab$, $\forall U_0 \in \R^{M}$, 
  $\forall (F^n)_{0 \leq n \leq N} \in \R^{(N+1) \times M}$, on a
  \begin{align}
    \max_{0\leq n \leq N} \| U^n \| 
    \leq C_1 \| U_0 \| 
    + C_2 \max_{0\leq n \leq N} \| F^n \| ,
  \end{align}
  o\`u $(U^n)$ est l'unique suite v\'erifiant~\eqref{eq:schema_1pas}.

  On dit \'egalement que le sch\'ema~\eqref{eq:schema_1pas} 
  est inconditionnellement stable pour la norme $\| \cdot \|$
  si la d\'efinition pr\'ec\'edente
  s'applique avec $\Stab = \R_+^* \times \R_+^*$.
\end{definition}

\begin{definition}[Erreur de troncature]
  \label{def:troncature}
  L'erreur de troncature (ou erreur de consistance) du sch\'ema~\eqref{eq:schema_1pas}
  au temps $t_n$ est un vecteur $\varepsilon^n \in \R^{M}$
  ($1 \leq n \leq N$)
  d\'efini par
  \begin{align}
    \label{eq:troncature}
    \varepsilon^{n+1} := \tu^{n+1} - A \tu^n - h_t F^n ,
  \end{align}
  o\`u $\tu^n \in \R^{M}$ est d\'efini par
  $(\tu^n)_j = u(t_n,x_j)$ avec $u$ la solution exacte du probl\`eme associ\'e \`a~\eqref{eq:schema_1pas}.
\end{definition}

\begin{definition}[Consistance]
  \label{def:consistance}
  On dit que le sch\'ema num\'erique~\eqref{eq:schema_1pas} est consistant pour la norme $\| \cdot \|$
  si pour toute solution exacte r\'eguli\`ere $u$ du probl\`eme associ\'e \`a~\eqref{eq:schema_1pas}, on a
  \begin{align}
    \lim_{\substack{N \to +\infty\\ M \to +\infty}} \max_{0\leq n \leq N} 
    \dfrac{\| \varepsilon^n \|}{h_t} = 0 ,
  \end{align}
  o\`u $\varepsilon^n$ est l'erreur de troncature (et $h_t = T/N$).

  On dit, de plus, que le sch\'ema \eqref{eq:schema_1pas} est consistant d'ordre $p \in \N^*$
  en temps et $q \in \N^*$ en espace pour la norme $\| \cdot \|$
  si pour toute solution r\'eguli\`ere $u$ (du probl\`eme avant discr\'etisation)
  il existe une constante $C>0$ ind\'ependante de $h_t$ et $h_x$ telle que
  \begin{align}
    \forall N, M \geq 2 , \quad \max_{0\leq n \leq N}
    \dfrac{\| \varepsilon^n \|}{h_t} \leq C (h_t^p + h_x^q) .
  \end{align}
\end{definition}

\begin{remark}
  Notons que la constante $C$ dans la d\'efinition \ref{def:consistance}
  d\'epend de la solution $u$ du probl\`eme associ\'e \`a~\eqref{eq:schema_1pas}.
  La condition importante sur cette constante est qu'elle ne doit pas d\'ependre de la discr\'etisation
  ($h_t$, $h_x$, $N$, $M$).
\end{remark}

\begin{definition}[Convergence]
  \label{def:convergence}
  On dit que le sch\'ema num\'erique \eqref{eq:schema_1pas} converge (ou est convergent)
  pour la norme $\| \cdot \|$
  sous la condition $\Stab \subset \R_+^* \times \R_+^*$
  si 
  \begin{align}
    \lim_{\substack{(h_t,h_x) \in \Stab \\ (h_t,h_x) \to (0,0)}} \max_{0\leq n \leq N} 
    \| \tilde{u}^n - U^n \| = 0 ,
  \end{align}
  avec $(\tilde{u}^n)_j = u(t_n,x_j)$,
  $Nh_t = T$ et $Mh_x = 1$ o\`u $u$ est la solution du probl\`eme associ\'e \`a~\eqref{eq:schema_1pas}.
  
  De mani\`ere similaire, on dit que le sch\'ema num\'erique 
  \eqref{eq:schema_1pas} converge (ou est convergent) 
  \`a l'ordre $p\in\N^*$ en temps et $q\in\N^*$ en espace pour la norme $\| \cdot \|$
  sous la condition $\Stab \subset \R_+^* \times \R_+^*$
  s'il existe une constante $C>0$ ind\'ependante de $h_t$ et $h_x$
  telle que
  \begin{align}
    \forall (h_t , h_x) \in \Stab , \quad \max_{0\leq n \leq N}
    \| \tilde{u}^n - U^n \| \leq C (h_t^p + h_x^q) .
  \end{align}

  On dit enfin que le sch\'ema est convergent (resp. convergent \`a l'ordre $p$
  en temps et $q$ en espace) pour la norme $\| \cdot \|$ si la d\'efinition ci-dessus est v\'erifi\'ee
  avec $\Stab = \R_+^* \times \R_+^*$.
\end{definition}

Ces d\'efinitions sont reli\'ees par le th\'eor\`eme de Lax.
\begin{theorem}[Th\'eor\`eme de Lax]
  \label{thm:convergence}
  Si le sch\'ema \eqref{eq:schema_1pas} est stable pour la norme $\| \cdot \|$
  sous la condition $\Stab \subset \R_+^* \times \R_+^*$ et consistant 
  (respectivement consistant d'ordre $p$ en temps et $q$ en espace)
  pour la norme $\| \cdot \|$,
  alors le sch\'ema \eqref{eq:schema_1pas} est convergent
  (respectivement convergent d'ordre $p$ en temps et $q$ en espace)
  pour la norme $\| \cdot \|$ sous la condition $\Stab$.


  De plus, si le probl\`eme exact (le probl\`eme v\'erifi\'e par $u$) 
  est bien pos\'e, alors la consistance et la stabilit\'e du sch\'ema 
  sont n\'ecessaires \`a sa convergence (en norme $\| \cdot \|$ pour les trois notions).
\end{theorem}
Le th\'eor\`eme \ref{thm:convergence} s'applique aussi avec $\Stab = \R_+^* \times \R_+^*$.
Avant d'exposer une preuve de ce th\'eor\`eme 
faisons quelques remarques sur les d\'efinitions pr\'ec\'edentes.


Concernant la stabilit\'e (cf d\'efinition \ref{def:stabilite}),
% les quantit\'es $\max_{\substack{0\leq n \leq N\\ 1 \leq j \leq M}} | u_j^n |$, 
% $\max_{1\leq j \leq M} | (U_0)_j |$ et $\max_{\substack{0\leq n \leq N\\ 1 \leq j \leq M}} | F_j^n |$ 
% sont des normes portant sur $(u_j^n)$, $U_0$ et $(F^n)$.
% O
on peut dire que la stabilit\'e du sch\'ema correspond \`a
la continuit\'e de l'application lin\'eaire qui \`a 
$U_0$ et $(F^n)$ associe $(u_j^n)$ 
avec une constante de continuit\'e que ne d\'epend pas
de $h_t$ et $h_x$.
Cette continuit\'e permet d'obtenir le fait qu'une "petite"
modification de la donn\'ee initiale ou des termes $F^n$
ne cr\'ee qu'une "petite" modification
du r\'esultat obtenu et que cette propri\'et\'e se conserve lorsque
$(h_t,h_x) \to (0,0)$.
Remarquons sur la figure \ref{fig:trans_per} que l'erreur commise
par le sch\'ema centr\'e augmente fortement lorsque
$(h_t,h_x) \to (0,0)$, nous verrons plus loin que ce comportement
est d\^u \`a un d\'efaut de stabilit\'e.


La condition $\Stab$ permet de traiter des cas o\`u le sch\'ema
n'est stable que si on restreint les $h_t$ et $h_x$ utilis\'es.
Nous verrons dans la suite de cette section que le sch\'ema 
d\'ecentr\'e amont \eqref{eq:transport_DF_decentre_AM} 
n'est stable que sous une certaine condition
que nous expliciterons.


Concernant la norme $\| \cdot \|$, nous verrons dans cette section que la norme
$\| \cdot \|_{\infty}$ d\'efinie par $\| U \|_{\infty} := \max_{1 \leq j \leq M} |U_j|$
est adapt\'ee \`a l'\'equation de transport.
On pourrait consid\'erer d'autres normes pour exprimer cette stabilit\'e.
Par exemple, on pourrait consid\'erer la norme
$\| U \|_{L^2} := \sqrt{h_x} (\sum_{0\leq j \leq M} (U_j)^2)^{1/2}$.
La d\'efinition propos\'ee ne serait alors pas n\'ecessairement
\'equivalente \`a celle de la d\'efinition \ref{def:stabilite}.
En effet, si toutes les normes sont \'equivalentes en dimension
finie, rien ne prouve que les constantes de la relation
d'\'equivalence ne d\'ependent pas de $h_t$ et $h_x$.
La norme $\| \cdot \|_{L^2}$ sera consid\'er\'ee pour mener l'analyse
num\'erique de l'\'equation de la chaleur.




L'erreur de troncature repr\'esente l'erreur que fait le sch\'ema
au cours d'un pas de temps en partant de la solution exacte.
En effet, on compare (cf d\'efinition \ref{def:troncature})
la solution exacte $\tu^{n+1}$ \`a la solution 
obtenue en faisant un pas de temps du sch\'ema
\`a partir de la solution exacte au pas de temps
pr\'ec\'edent $\tu^{n}$.


La consistance d'un sch\'ema (cf d\'efinition \ref{def:consistance})
signifie que l'erreur de troncature commise par unit\'e de temps
(on divise par $h_t$) tend vers $0$ lorsque $(h_t,h_x) \to (0,0)$.
De plus, on peut quantifier la notion de consistance
gr\^ace \`a l'ordre de consistance 
(plus les ordres de consistance en temps et en espace sont \'elev\'es,
plus l'erreur de troncature d\'ecro\^it vite vers $0$ quand $(h_t,h_x) \to (0,0)$).
En quelque sorte, la consistance signifie que le sch\'ema est
coh\'erent avec le probl\`eme exact 
(les termes pr\'esents dans le sch\'ema num\'erique correspondent
\`a des termes du probl\`eme exact et vice-versa).


La convergence d'un sch\'ema signifie que la solution approch\'ee obtenue
correspond bien \`a une approximation de la solution exacte
au sens o\`u si l'on fait tendre les pas de temps et d'espace vers
$0$, l'erreur commise par le sch\'ema tend aussi vers $0$.
L\`a encore on peut quantifier cette d\'ecroissance de l'erreur commise 
avec la notion d'ordre de convergence.
\'Etant donn\'e que les ordres de consistance et de convergence 
se correspondent (voir th\'eor\`eme \ref{thm:convergence}), 
on parle parfois simplement d'ordre d'un sch\'ema
(sans pr\'eciser 'convergence' ou 'consistance').


En pratique, la convergence est la propri\'et\'e que l'on veut avoir
car elle garantit que le sch\'ema consid\'er\'e fournit une approximation
raisonnable du probl\`eme exact (sous r\'eserve que les pas de temps
et d'espace sont suffisamment petits).
Cependant, cette propri\'et\'e n'est pas ais\'ee \`a d\'emontrer directement.
C'est pourquoi nous utilisons le th\'eor\`eme \ref{thm:convergence}
qui assure la convergence \`a partir de la stabilit\'e et 
de la consistance.
Notons \'egalement que, si le probl\`eme exact est bien pos\'e,
alors avoir la convergence est \'equivalent \`a avoir
la stabilit\'e et la consistance.
Ceci signifie qu'en pratique, on ne peut pas esp\'erer avoir un sch\'ema convergent
s'il manque la consistance ou la stabilit\'e.


\begin{remark}
  Les notions de consistance et de convergence sont diff\'erentes.
  Les jurys se plaignent des candidats qui confondent ces deux
  notions.
  Ne fa\^ites pas cette erreur.
\end{remark}

\begin{remark}
  Toutes ces d\'efinitions caract\'erisent le comportement du sch\'ema 
  lorsque $(h_t,h_x) \to (0,0)$.
  La plupart des r\'esultats d'analyse num\'erique se concentrent sur cette limite.
\end{remark}

Nous allons maintenant prouver la premi\`ere partie du th\'eor\`eme \ref{thm:convergence}
qui est celle que l'on utilise en pratique.
\begin{proof}[Preuve partielle du th\'eor\`eme \ref{thm:convergence}]
  Dans cette preuve, nous utilisons toutes les d\'efinitions pr\'ec\'edentes.
  Tout d'abord, par d\'efinition de l'erreur de troncature,
  $\tu^{n+1} = A \tu^n + h_t F^n + \varepsilon^{n+1}$.
  On montre ainsi que
  $w^n = \tu^{n} - U^{n}$ v\'erifie $w^0 = 0$ 
  (puisque $(U^0)_j = u(t_0,x_j)$) et
  $w^{n+1} = A w^n + \varepsilon^{n+1}$.

  Par stabilit\'e du sch\'ema, on obtient
  $\max_{0\leq n \leq N} \| w^n \|
  \leq C_2 \max_{0\leq n \leq N} \dfrac{\| \varepsilon^n \|}{h_t}$.
  On conclut en utilisant la d\'efinition de la consistance.
\end{proof}



Comme nous l'avons dit, en pratique, pour prouver la convergence du sch\'ema
on prouve sa consistance et sa stabilit\'e.
Il se trouve que les preuves de consistances sont g\'en\'eralement plut\^ot
ais\'ees, la difficult\'e se trouve donc plut\^ot dans la preuve de la stabilit\'e.
Afin de faciliter ces preuves,
nous en donnons maintenant des conditions n\'ecessaires et des conditions
suffisantes.
Pour $A \in \R^{M \times M}$, on note 
$\tn A \tn = \sup_{V \in \R^{M} \backslash\{0\}} \dfrac{\| A V \|}{\| V \|}$,
o\`u $\| \cdot \|$ est la norme consid\'er\'ee sur les vecteurs.
Rappelons que $\tn \cdot \tn$ est une norme sur $\R^{M \times M}$.
Commen\c{c}ons d'abord par le r\'esultat suivant.
\begin{proposition}
  \label{prop:carac_stab}
  Le sch\'ema \eqref{eq:schema_1pas} est stable pour la norme $\| \cdot \|$ si et seulement si
  il existe $C>0$ d\'ependant uniquement de $T$ tel que
  \begin{align}
    \label{eq:carac_stab}
    \forall n \in \N , \quad \tn A^n \tn \leq C .
  \end{align}
\end{proposition}

\begin{corrolary}
  \label{corro:stability}
  Si $\tn A \tn \leq 1$, alors le sch\'ema est stable pour la norme $\| \cdot \|$.
\end{corrolary}

\begin{proof}[Preuve de la proposition \ref{prop:carac_stab}]
  Supposons tout d'abord que le sch\'ema est stable.
  Dans ce cas, appliquons le sch\'ema \`a $U_0 = V \in \R^{M}$
  quelconque et $F^n = 0$. 
  La solution obtenue est $U^n = A^n V$.
  On a donc prouv\'e qu'il existe $C>0$ d\'ependant uniquement
  de $T$ tel que
  $\forall V \in \R^{M} , \quad \| A^n V \| \leq C \| V \|$
  et donc \eqref{eq:carac_stab}.

  Maintenant supposons que \eqref{eq:carac_stab} est \'etablie.
  Appliquons le sch\'ema \`a $U_0 \in \R^{M}$
  et $(F^n) \in \R^{(N+1) \times M}$.
  Nous pouvons prouver (voir exercice \ref{exo:sol_schema_1pas}) 
  que la solution obtenue est donn\'ee par
  \begin{align*}
    \forall 0 \leq n \leq N , \quad U^n = A^n U_0 + h_t \sum_{\ell = 0}^{n-1} A^{n-\ell-1} F^{\ell} .
  \end{align*}
  Ainsi, $\| U^n \| \leq \tn A^n \tn \| U_0 \| 
  + h_t \sum_{\ell = 0}^{n-1} \tn A^{n-\ell-1} \tn \| F^n \|$.
  En utilisant \eqref{eq:carac_stab}, on obtient
  $\| U^n \| \leq C \| U_0 \| + C h_t n \max_{0\leq \ell \leq N} \| F^{\ell} \|$,
  avec $C$ la constante de \eqref{eq:carac_stab} qui d\'epend
  uniquement de $T$.
  De plus, $n h_t = t_n \leq T$.
  On a donc \'etabli la stabilit\'e du sch\'ema.
\end{proof}


\begin{exercise}
  \label{exo:sol_schema_1pas}
  Soient $U_0 \in \R^{M}$ et $(F^n) \in \R^{(N+1) \times M}$.
  Montrer que l'unique solution de \eqref{eq:schema_1pas}
  est donn\'ee par
  \begin{align}
    \label{eq:sol_Un}
    \forall 0 \leq n \leq N , \quad  U^n = A^n U_0 + h_t \sum_{\ell = 0}^{n-1} A^{n-\ell-1} F^{\ell} .
  \end{align}
\end{exercise}


\begin{remark}
  Une cons\'equence de la proposition~\ref{prop:carac_stab} est que
  la stabilit\'e du sch\'ema ne d\'epend que de $A$ et non de $F$.
\end{remark}


Nous introduisons une derni\`ere d\'efinition: la stabilit\'e
au sens de Von Neumann.
Lorsque l'on veut prouver qu'un sch\'ema de la forme \eqref{eq:schema_1pas}
est instable pour les normes $\| \cdot \|_{\infty}$ et $\| \cdot \|_{L^2}$, la fa\c{c}on standard
de proc\'eder est de montrer qu'il n'est pas stable au sens de Von Neumann.
On consid\`ere alors $F^n = 0$ et une condition initiale sous la forme
d'une onde spatiale: $u_j^0 = e^{2 i \pi k x_j}$ avec $i$ la racine carr\'e de l'unit\'e
et $k \in \Z$.
On \'etudie ensuite l'effet qu'a l'application du sch\'ema sur cette condition initiale complexe.

L'int\'er\^et de choisir un vecteur de la forme $u_j^0 = e^{2 i \pi k x_j}$
est que l'on a $u_j^1 = \sum_{\ell=1}^{M} a_{j \ell} u_{\ell}^{0}$.
En prenant $\calA_j(k) = \sum_{\ell=1}^{M} a_{j\ell} e^{2i\pi k (x_{\ell} - x_j)}$, on montre
que $\forall 1\leq j \leq M, \;  u_j^{1} = \calA_j(k) u_j^0$ avec $\calA_j(k) \in \C$.
\begin{definition}[Stabilit\'e au sens de Von Neumann]
  On dit qu'un sch\'ema \eqref{eq:schema_1pas} est stable au
  sens de Von Neumann si pour tout $1 \leq j \leq M$ 
  et pour tout $k \in \Z$, $| \calA_j(k) | \leq 1$.
\end{definition}
\begin{proposition}
  \label{prop:Von_Neumann_nec}
  La stabilit\'e au sens de Von Neumann est n\'ecessaire \`a la stabilit\'e du sch\'ema
  pour la norme $\| \cdot \|_{\infty}$.
  Dit autrement, la stabilit\'e du sch\'ema pour la norme $\| \cdot \|_{\infty}$ implique la stabilit\'e au sens de 
  Von Neumann.
\end{proposition}
\begin{proof}
  On peut montrer que si on consid\`ere $u_j^0 = \Re (e^{2 i \pi k x_j})$
  et $F^n = 0$
  alors $\forall 0 \leq n \leq N, u_j^n = \Re ((\calA_j(k))^n e^{2 i \pi k x_j})$.
  Idem, si $u_j^0 = \Im (e^{2 i \pi k x_j})$, 
  alors $\forall 0 \leq n \leq N, u_j^n = \Im ((\calA_j(k))^n e^{2 i \pi k x_j})$.
  
  Ainsi, si le sch\'ema \eqref{eq:schema_1pas} est stable pour la norme $\| \cdot \|_{\infty}$, alors
  $\max_{\substack{0 \leq n \leq N \\ 1 \leq j \leq M}} 
  | \Re ((\calA_j(k))^n e^{2 i \pi k x_j})| \leq C$ o\`u $C>0$ ne d\'epend que de $T$.
  En faisant le m\^eme raisonnement sur la partie imaginaire,
  on obtient
  $\max_{\substack{0 \leq n \leq N \\ 1 \leq j \leq M}} 
  | (\calA_j(k))^n e^{2 i \pi k x_j}| \leq \sqrt{2}C$.
  
  Or ceci n'est possible que si $| \calA_j(k) | \leq 1$ sinon on d\'epasse
  la constante $\sqrt{2}C$ en faisant tendre $N$ vers $+\infty$.
  Ceci prouve le r\'esultat.
\end{proof}


Par la suite nous utilisons la stabilit\'e de Von Neumann lorsque nous voulons 
prouver qu'un sch\'ema n'est pas stable pour la norme $\| \cdot \|_{\infty}$ .


%%%%%  Reprendre cette remarque (en clarifiant)
% \begin{remark}
%   On peut prouver que la
%   stabilit\'e de Von Neumann correspond \`a la stabilit\'e du sch\'ema 
%   dans le sens $\| (u_j^n) \|_{*} \leq C_1 \| U_0 \|_{\#} + C_2 \| (F^n) \|_{*}$,
%   avec $C_1$ et $C_2$ ne d\'ependant que de $T$
%   et des normes $\| \cdot \|_{*}$ et $\| \cdot \|_{\#}$ diff\'erentes de celles
%   de la d\'efinition \ref{def:stabilite}.
% \end{remark}

%%%%%%%%%%%%%%%%%%
\subsubsection{Analyse des deux sch\'emas donn\'es en introduction}
\label{subsubsec:deux_schemas}


Nous allons montrer dans cette section que le sch\'ema num\'erique 
propos\'e en \eqref{eq:transport_DF_centre} n'est pas stable pour la norme $\| \cdot \|_{\infty}$
contrairement au sch\'ema \eqref{eq:transport_DF_decentre_AM}.
C'est ce d\'efaut de stabilit\'e qui explique son mauvais comportement.

On consid\`ere comme degr\'es de libert\'e
$U^n = 
\begin{pmatrix}
  u_1^n \\ \vdots \\ u_{M}^n
\end{pmatrix}
\in \R^M
$.
Les deux sch\'emas pr\'ec\'edents peuvent \^etre \'ecrits sous la forme matricielle 
\eqref{eq:schema_1pas} avec $F^n = 0$ et
\begin{align}
  A_{C} = \dfrac{1}{2}
  \begin{pmatrix}
    2 & -\co & 0 & \dots & 0 & \co
    \\
    \co & 2 & -\co & & & 0
    \\
    0 & \ddots & \ddots & \ddots & &
    \\
    \vdots & & \ddots & \ddots & \ddots
    \\
    0 & & & \ddots & \ddots & -\co
    \\
    -\co & 0 & & & \co & 2
  \end{pmatrix},
\end{align}
pour le sch\'ema centr\'e \eqref{eq:transport_DF_centre}
et
\begin{align}
  \label{eq:trans_mat_per_AM}
  A_{AM} = 
  \begin{pmatrix}
    1-\co & 0 & \dots & 0 & \co
    \\
    \co & \ddots & & & 0
    \\
    & \ddots & \ddots &   &
    \\
    & & \ddots & \ddots &
    \\
    &&   &  \co & 1-\co
  \end{pmatrix},
\end{align}
pour le sch\'ema d\'ecentr\'e amont \eqref{eq:transport_DF_decentre_AM}.
Les deux matrices pr\'ec\'edentes sont dans
$\R^{M \times M}$ et ont \'et\'e \'ecrites avec 
$\co = \frac{a h_t}{h_x}$.

\begin{proposition}
  \label{prop:consistance_2_schemas}
  Les sch\'emas \eqref{eq:transport_DF_centre} et \eqref{eq:transport_DF_decentre_AM}
  sont tous les deux consistants pour la norme $\| \cdot \|_{\infty}$.
  De plus, le sch\'ema \eqref{eq:transport_DF_centre} est consistant d'ordre 1
  en temps et 2 en espace;
  le sch\'ema \eqref{eq:transport_DF_decentre_AM} est consistant d'ordre 1
  en temps et 1 en espace (pour la norme $\| \cdot \|_{\infty}$).
\end{proposition}


\begin{proof}
  Prouvons que le sch\'ema \eqref{eq:transport_DF_centre} est consistant
  d'ordre 1 en temps et 2 en espace.
  La preuve pour le sch\'ema d\'ecentr\'e amont est laiss\'ee en exercice
  (cf exercice \ref{exo:consistance_trans_AM}).

  On calcule l'erreur de troncature. Ceci revient \`a 
  calculer une solution approch\'ee au temps $t_{n+1}$ par le sch\'ema \`a partir
  de la solution exacte au temps $t_n$ et de comparer le r\'esultat
  obtenu \`a la solution exacte au temps $t_{n+1}$.
  On a ainsi
  \[
    \varepsilon_j^{n+1} = u(t_{n+1},x_j) - u(t_n,x_j)
    + \dfrac{a h_t}{2 h_x} (u(t_n, x_{j+1}) - u(t_n, x_{j-1})) ,
  \]
  o\`u $u$ est la solution de \eqref{eq:transport_per}.

  On consid\`ere ensuite les d\'eveloppements de Taylor suivants:
  \begin{align*}
    u(t_{n+1} , x_j) = u(t_n , x_j) + h_t \dfrac{\partial u}{\partial t} (t_n , x_j)
    + O(h_t^2) ,
    \\
    u(t_n , x_{j+1} ) = u(t_n , x_{j} ) + h_x \dfrac{\partial u}{\partial x}(t_n, x_j)
    + \dfrac{h_x^2}{2} \dfrac{\partial^2 u}{\partial x^2}(t_n, x_j)
    + O(h_x^3) ,
    \\
    u(t_{n} , x_{j-1} ) = u(t_n , x_{j} ) - h_x \dfrac{\partial u}{\partial x}(t_n, x_j)
    + \dfrac{h_x^2}{2} \dfrac{\partial^2 u}{\partial x^2}(t_n, x_j)
    + O(h_x^3) .
  \end{align*}
  Nous obtenons donc
  \begin{align*}
    \dfrac{\varepsilon_j^{n+1}}{h_t} = \dfrac{\partial u}{\partial t}(t_n, x_j)
    + O (h_t) + a \dfrac{\partial u}{\partial x}(t_n, x_j) + O (h_x^2) .
  \end{align*}
  En utilisant le fait que $u$ est solution de \eqref{eq:transport_per},
  on a 
  $\dfrac{\partial u}{\partial t}(t_n, x_j) + a \dfrac{\partial u}{\partial x}(t_n, x_j) = 0$.
  Nous avons prouv\'e le fait que le sch\'ema \eqref{eq:transport_DF_centre}
  est consistant d'ordre 2 en espace et d'ordre 1 en temps.
\end{proof}

\begin{exercise}
  \label{exo:consistance_trans_AM}
  Terminer la preuve de la proposition \ref{prop:consistance_2_schemas}:
  prouver que le sch\'ema \eqref{eq:transport_DF_decentre_AM} est consistant
  d'ordre 1 en temps et en espace (pour la norme $\| \cdot \|_{\infty}$). 
\end{exercise}


\begin{proposition}
  \label{prop:stabilite_transport_AM}
  Le sch\'ema \eqref{eq:transport_DF_decentre_AM} est stable pour la norme $\| \cdot \|_{\infty}$
  sous la condition $c = \dfrac{a h_t}{h_x} \leq 1$.
  De plus, ce sch\'ema est instable si $c > 1$ (pour la norme $\| \cdot \|_{\infty}$).
\end{proposition}
\begin{proof}
  Supposons $c \leq 1$ et montrons que le sch\'ema est stable.
  Soit $U_0 \in \R^M$, on calcule $U^1 = A U_0$.
  Pour $1 \leq j \leq M$, 
  $u_j^1 = (1-c) u_j^0 + c u_{j-1}^0$.
  Ainsi, $|u_j^1| \leq |1-c| | u_j^0 | + | c | | u_{j-1}^0 |$.
  On obtient $\| U^1 \| \leq (|1-c| + |c|) \| U_0 \|$.
  Ceci \'etant valide pour tout $U_0 \in \R^M$, on a $\tn A \tn \leq |1-c| + |c|$.
  La condition $0 \leq c \leq 1$ donne $\tn A \tn \leq 1$ et le sch\'ema est stable 
  d'apr\`es le corrolaire \ref{corro:stability}.

  Supposons maintenant que $c > 1$ et montrons que le sch\'ema est instable.
  Pour cela, nous allons montrer qu'il est instable au sens de Von Neumann.
  Si $u_j^0 = e^{2i\pi k x_j}$, alors
  \[
    u_j^{1} = (1-c) u_j^0 + c u_{j-1}^0 = (1 - c + c e^{-2i\pi k h_x}) u_j^0 
    = \calA(k) u_j^0.
  \]
  Ici, nous avons $\calA(k) = 1 - c + c e^{-2i\pi k h_x}$.
  Pour $c > 1$ et $k=1$, on a pour $h_x<1$,
  $| \calA | > 1$ (on montre que $\cos(2\pi k h_x) < 1$). 
  Le sch\'ema n'est pas stable au sens 
  de Von Neumann donc, d'apr\`es la proposition \ref{prop:Von_Neumann_nec},
  il n'est pas stable au sens de la d\'efinition~\ref{def:stabilite}.
\end{proof}

La mauvais comportement du sch\'ema centr\'e provient d'un d\'efaut
de stabilit\'e. La preuve de ce r\'esultat est laiss\'ee en exercice.
\begin{exercise}[Instabilit\'e du sch\'ema explicite centr\'e]
  Montrer que le sch\'ema~\eqref{eq:transport_DF_centre} est instable
  pour la norme $\| \cdot \|_{\infty}$
  (c'est-\`a-dire n'est stable sous aucune condition $\Stab$).
\end{exercise}



Nous pouvons tirer plusieurs conclusions de l'\'etude de ces deux sch\'emas.
Tout d'abord, le fait de d\'ecentrer la d\'eriv\'ee partielle en espace
a permis de rendre le sch\'ema stable.
Notons que le sens dans le lequel on d\'ecentre cette d\'eriv\'ee est essentiel,
on peut montrer que le sch\'ema d\'ecentr\'e aval 
issu de l'approximation 
$\frac{\partial u}{\partial x} (t_n , x_j) \simeq \frac{u(t_n,x_{j+1}) - u(t_n,x_{j})}{h_x}$ 
est instable pour 
$a>0$ (toujours pour la norme $\| \cdot \|_{\infty}$) et qu'il faut changer le sens du d\'ecentrage si $a<0$.
Les num\'ericiens commentent ce ph\'enom\`ene en disant
qu'il faut d\'ecentrer la d\'eriv\'ee en espace en utilisant les donn\'ees qui correspondent
\`a de l'information qui arrive et non \`a de l'information qui part.
Cela signifie que si $a>0$, l'information vient de la gauche, il faut donc d\'ecentrer la d\'eriv\'ee vers la gauche.


De plus, nous avons vu dans la proposition~\ref{prop:stabilite_transport_AM} que
le sch\'ema~\eqref{eq:transport_DF_decentre_AM} est stable
uniquement sous la condition $a h_t \leq h_x$
qui lie les pas de temps et d'espace.
On appelle une telle condition "condition de CFL" pour 
les noms des trois scientifiques
Courant, Friedrichs et Lewy.
De la m\^eme fa\c{c}on on appelle $c = \frac{a h_t}{h_x}$
le nombre de CFL (parfois aussi appel\'e nombre de Courant).
De telles conditions doivent \^etre associ\'ees aux sch\'emas
explicites pour esp\'erer les rendre stables.
Seuls les sch\'emas implicites peuvent se passer de ce
type de condition (voir exercice \ref{exo:transport_implicite}).


Notons que remplacer les d\'eriv\'ees de l'EDP par des taux d'accroissements permet
d'assurer la consistance d'un sch\'ema mais pas sa stabilit\'e comme nous venons de le voir.
Il faut donc \^etre tr\`es prudent quand on discr\'etise une EDP.


%%%%%%%%%%%%%%%%%%
\subsubsection{Discr\'etisation des conditions de Dirichlet}

On s'int\'eresse dans cette section \`a la prise en compte des conditions de Dirichlet.
On cherche donc \`a discr\'etiser le probl\`eme \eqref{eq:transport}.
Pour avoir les m\^emes propri\'et\'es de stabilit\'e que dans le cas des conditions aux limites
p\'eriodiques on discr\'etise la d\'eriv\'ee en espace par une approximation d\'ecentr\'ee
amont, on utilise donc \eqref{eq:der_decentre_AM}.
On obtient le sch\'ema num\'erique
\begin{align}
  \label{eq:transport_DF_decentre_AM_dir}
  \left\{
  \begin{array}{l}
    \forall 0 \leq j \leq M , 
    u_j^0 = u_0(x_j) ,
    \\
    \forall 1 \leq n \leq N, u_0^n = \alpha(t_n) ,
    \\
    \forall 1 \leq n \leq N, \forall 1 \leq j \leq M,
    u_j^n = u_j^{n-1} - \dfrac{a h_t}{h_x} (u_{j}^{n-1} - u_{j-1}^{n-1}) .
  \end{array}
  \right.
\end{align}

On a donc 
\begin{align}
  A =
  \begin{pmatrix}
    1 - \co & 0 & & &
    \\
    \co & 1 - \co & \ddots & &
    \\
    0 & \ddots & \ddots & \ddots &
    \\
    \vdots & & \ddots & \ddots & 0
    \\
    0 & & & \co & 1-\co
  \end{pmatrix}
  \qquad \text{et} \qquad
  \forall n \geq 0,
  \quad h_t F^n = \co
  \begin{pmatrix}
    \alpha(t_n)
    \\
    0
    \\
    \vdots
    \\
    0
  \end{pmatrix}
  ,
\end{align}
avec $\co = \frac{a h_t}{h_x}$.
Remarquons que la condition de Dirichlet a \'et\'e prise en compte
dans le terme "second membre" $F^n$.
Si l'on compare la matrice $A$ avec la matrice $A_{AM}$ dans le cas de conditions
p\'eriodiques (voir \eqref{eq:trans_mat_per_AM}), on voit que le terme $c$
de la premi\`ere ligne de
la matrice $A_{AM}$ a \'et\'e retir\'e et remplac\'e par la pr\'esence d'un second
membre.
Ce terme $c$ correspondait au fait que la valeur qui entrait en $0$ dans le cas des conditions
p\'eriodiques \'etait celle de la valeur de la solution en $1$.
Notons que ce terme a \'et\'e remplac\'e par un $c \alpha(t_n)$ dans le second membre
(notons le coefficient $c$ qui est le m\^eme que pour les conditions p\'eriodiques).


On peut, de la m\^eme fa\c{c}on que pour le cas des conditions p\'eriodiques, 
montrer que ce sch\'ema est stable si et seulement la condition de CFL ``$c \leq 1$''
est v\'erifi\'ee (vous pouvez chercher cette d\'emonstration pour vous convaincre
que vous avez compris la section pr\'ec\'edente).


\begin{proposition}
  Pour un nombre de CFL $c \leq 1$,
  le sch\'ema d\'ecentr\'e amont conserve les bornes:
  s'il existe $A$ et $B$ r\'eels tels que
  pour tout $j \in < 0 , M>$, $A \leq u_0(x_j) \leq B$
  et pour tout $n \in < 1 , N >$, $A \leq \alpha(t_n) \leq B$,
  alors pour tout $n \in < 0 , N >$ et tout $j \in <0,M>$,
  on a $A \leq u_j^n \leq B$.
\end{proposition}

\begin{proof}
  On a $u_j^{n+1} = u_j^n - \frac{a h_t}{h_x} (u_j^n - u_{j-1}^n) = (1-c) u_j^n + c u_{j-1}^n$
  avec $c = \frac{a h_t}{h_x}$.
  Maintenant, si $A \leq u_j^{n} \leq B$ et $A \leq u_{j-1}^n \leq B$ alors
  en utilisant $c \geq 0$ et $1-c \geq 0$, on a
  $A \leq u_j^{n+1} \leq B$.

  On compl\`ete la preuve avec un argument de r\'ecurence.
\end{proof}

%%%%%%%%%%%%%%%%%%
\subsubsection{Diffusion num\'erique}



On peut repr\'esenter le nombre de CFL comme le rapport entre les vitesses
de propagation de l'information dans le cas continu et le cas discr\'etis\'e.
En effet, si on consid\`ere une condition initiale constante et une perturbation
arrivant en entr\'ee du domaine, dans le probl\`eme continu la perturbation
va progressivement chasser la condition initiale \`a vitesse $a$.
Dans le probl\`eme discr\'etis\'e avec un sch\'ema explicite 
comme \eqref{eq:transport_DF_decentre_AM}, au premier pas de temps, 
le premier point en espace est modifi\'e puis
\`a chaque pas de temps un pas en espace est modifi\'e.
Le front de la pertubation de la condition initiale se propage donc \`a la vitesse
$h_x / h_t$.
Ainsi, quand $c \leq 1$, le front de la perturbation se propage plus vite dans le probl\`eme
num\'erique que dans le probl\`eme continu et inversement quand $c \geq 1$.


Dans le cas o\`u $c \leq 1$, le front de perturbation se propage plus vite 
dans le cas num\'erique et les valeurs ont tendance \`a s'applatir.
On appelle ce ph\'enom\`ene la diffusion num\'erique:
tout se passe comme s'il y avait un terme de diffusion suppl\'ementaire dans l'\'equation.
Quand $c \geq 1$, le sch\'ema est instable et des ph\'enom\`enes similaires \`a ceux 
du sch\'ema centr\'e apparaissent (voir figure~\ref{fig:trans_per}).



Nous avons \'etudi\'e le probl\`eme de transport--Dirichlet
avec $\alpha(t) = 2$, $u_0(x) = 1$ et $a = 1$.
La solution exacte est 
\begin{align*}
  u(t,x) = 
  \begin{cases}
    2 & \text{si $x \leq at$,}
    \\
    1 & \text{sinon.}
  \end{cases}
\end{align*}
On calcule la solution num\'erique avec le sch\'ema \eqref{eq:transport_DF_decentre_AM_dir}
pour diff\'erents nombres de CFL.
L'influence de la CFL est ainsi illustr\'ee sur la figure \ref{fig:trans_CFL}.
On observe cet effet de diffusion num\'erique: un petit nombre de CFL tend \`a dissiper le saut
comme le ferait un terme de diffusion (voir le chapitre sur l'\'equation de la chaleur).
Bien entendu, l'effet de la diffusion num\'erique s'estompe quand $h \to 0$
(en supposant que l'on v\'erifie la condition de CFL).

\begin{figure}[h]
  \centering
  \includegraphics[width = 12cm]{Figures/transport_Dir_CFL.pdf}
  \caption{Solution du probl\`eme de transport--Dirichlet pour diff\'erents nombres de CFL $c$
    ($t=0.5$, $M=160$).}
  \label{fig:trans_CFL}
\end{figure}

Un dernier ph\'enom\`ene int\'eressant est le fait que le sch\'ema num\'erique permet
d'obtenir la solution exacte lorsque $c=1$ (la d\'emonstration est laiss\'ee en exercice).
Cette valeur de CFL n'est en pratique pas utilis\'ee car le sch\'ema est alors proche d'\^etre
instable et de toutes fa\c{c}ons on ne trouve la solution exacte que dans des cas simples
tels que celui de l'\'equation de transport unidimensionnelle \`a vitesse constante.
Dans le cas de probl\`emes plus complexes ne pouvant \^etre r\'esolus que par de la simulation
num\'erique, il ne faut pas s'attendre \`a ce que le sch\'ema fournisse la solution exacte.

\begin{exercise}
  Montrer que lorsque $c=1$, l'erreur commise par le sch\'ema 
  \eqref{eq:transport_DF_decentre_AM_dir} est nulle.
  La m\^eme d\'emonstration peut \^etre faite pour le cas des conditions p\'eriodiques
  \eqref{eq:transport_DF_decentre_AM}.

  Application : 
  la figure \ref{fig:transport_a} repr\'esente les solutions exactes de l'\'equation de transport
  \`a $t=0.5$ pour $M=20$ et diff\'erentes vitesses $a$.
  Elle a \'et\'e obtenue en appliquant le sch\'ema 
  \eqref{eq:transport_DF_decentre_AM_dir}. Donner pour chaque valeur de $a$ la valeur de $N$
  qui a \'et\'e utilis\'ee.
  % a=0 -> peut importe, a=0.5 -> N=5, a=1 -> N=10, a=1.5 -> N=15

  NB: pour rappel, l'intervalle de temps est $(0,0.5)$, l'intervalle d'espace est $(0,1)$.
  Vous pouvez essayer de retrouver la figure \ref{fig:transport_a}
  pour v\'erifier vos r\'esultats.
\end{exercise}


%%%%%%%%%%%%%%%%%%
\subsubsection{Sch\'ema implicite}



\begin{exercise}[Sch\'ema implicite]
  \label{exo:transport_implicite}
  Dans cet exercice, on s'int\'eresse \`a une discr\'etisation implicite du probl\`eme
  \eqref{eq:transport}.
  On approche les d\'eriv\'ees partielles en temps et espace
  par des approximations d\'ecentr\'ees amont:
  \begin{align}
    \label{eq:der_decentre_AM2}
    \dfrac{\partial u}{\partial t}(t_n,x_j) \simeq \dfrac{u(t_{n},x_j) - u(t_{n-1},x_j)}{h_t} ,
    \qquad \qquad 
    \dfrac{\partial u}{\partial x}(t_n,x_j) \simeq \dfrac{u(t_n,x_{j}) - u(t_n,x_{j-1})}{h_x} .
  \end{align}
  
  \begin{enumerate}
  \item En consid\'erant la condition de Dirichlet $u(t_n,0) = \alpha(t_n)$ (donc pour $a>0$), 
    \'ecrire le sch\'ema num\'erique issu de \eqref{eq:der_decentre_AM2}.
    Montrer qu'il peut se mettre sous la forme $\widetilde{A} U^{n} = U^{n-1} + h_t \widetilde{F}^n$.
    Donner $\widetilde{A}$ et $\widetilde{F}^n$.
  \item Montrer que $\widetilde{A}$ est inversible. En d\'eduire que ce sch\'ema v\'erifie
    \eqref{eq:schema_1pas} en donnant $A$ et $F^n$.
    On pourra donc utiliser les d\'efinitions de la section \ref{subsubsec:analyse_def}.
  \item Soit $V \in \R^M$, on note $U = A V$. 
    Calculer les coordonn\'ees de $U$ en fonction de celles de $V$.
    En d\'eduire que $\tn A \tn \leq 1$ (pour $\| \cdot \|_{\infty}$) et que
    ce sch\'ema est inconditionnellement stable pour la norme $\| \cdot \|_{\infty}$.
    
  \item Montrer que ce sch\'ema est consistant d'ordre 1 en temps et en espace
    pour la norme $\| \cdot \|_{\infty}$.
    Que peut-on dire de la convergence de ce sch\'ema?

  \item Coder le sch\'ema propos\'e.
    Tester plusieurs nombres de CFL.
    V\'erifier que le sch\'ema converge m\^eme quand $c > 1$.


  \item On consid\`ere $a=1$, $u_0 = 0$ et $\alpha(t) = t^2$.
    Quelle est la solution exacte du probl\`eme?
    Approcher la solution gr\^ace au sch\'ema implicite.
    Que remarquez-vous en $(t,x)=(0.1,0.5)$?
    Si vous l'avez cod\'e, comparez avec le sch\'ema explicite.
    Comment expliquez-vous ceci ?
    
  % \item D\'eterminer num\'eriquement le taux de convergence de ce sch\'ema.
  %   On prendra par exemple la solution du cas test pr\'ec\'edent \`a $T=1$ pour
  %   estimer la convergence du sch\'ema. Calculer l'erreur et la tracer sur une figure
  %   \`a l'\'echelle logarithmique comme sur la figure (...).
  %   Quels ordres de convergence trouvez-vous num\'eriquement ?
  \end{enumerate}
  
  % NB : si vous avez des difficult\'es pour l'une de ces questions, vous pouvez \'eventuellement
  % lire la section \ref{subsubsec:chaleur_DF_implicite}.

  % !! Ajouter une question sur la stabilit\'e de Von Neumann : comparer les preuves des deux stabilit\'es + remarque : Von Neumann plus simple, sera \'etudi\'e dans le chapire suivant (...)
\end{exercise}


\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\'Equation de la chaleur}

Nous consid\'erons le domaine $\Omega = (0,1)$.
Nous \'etudions dans ce chapitre les solutions au probl\`eme
\begin{equation}
  \label{eq:chaleur_Dir}
  \text{Trouver $u : (0,T) \times (0,1)$ v\'erifiant }
  \left\{
    \begin{array}{l l}
      \dfrac{\partial u}{\partial t} - \dfrac{\partial^2 u}{\partial x^2} = f 
      &\dans (0,T) \times (0,1) ,
      \\
      u(0,.) = u_0 
      & \dans (0,1) ,
      \\
      u(t,0) = 0 , \quad u(t,1) = 0 & \forall t \in (0,T) ,
    \end{array}
  \right.
\end{equation}
o\`u $f$ et $u_0$ sont des fonctions donn\'ees.
Notons que l'on a impos\'e des conditions de Dirichlet homog\`enes sur tout le bord du domaine
(ici $x=0$ et $x=1$).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\subsection{Recherche de solutions r\'eguli\`eres}

Le but de cette section est de mettre en \'evidence la forme que peuvent avoir
les solutions du probl\`eme~\eqref{eq:chaleur_Dir}.
Pour cela, nous supposerons que les donn\'ees $f$ et $u_0$ sont suffisamment r\'eguli\`eres.
On traitera d'abord le cas du domaine $\Omega = (0,1)$, puis nous \'etudierons les solutions
du probl\`eme sur la droite r\'eelle $\Omega = \R$.

%%%%%%%%%%%%%%%%
\subsubsection{Cas du domaine born\'e $\Omega = (0,1)$}
\label{subsubsec:chal_born}

Le but de cette section est de construire une solution explicite
au probl\`eme~\eqref{eq:chaleur_Dir}.
Nous commen\c{c}ons tout d'abord par appliquer la m\'ethode de s\'eparation des variables.
On cherche donc une solution de la forme
$u(t,x) = \Phi(t) \Psi(x)$ o\`u $\Phi$ et $\Psi$ sont des fonctions \`a d\'eterminer.
Pour simplifier nous supposons que $f$ est nul, on a alors $\Phi'(t) \Psi(x) = \Phi(t) \Psi''(x)$.
On pourrait se passer de cette hypoth\`ese (voir par exemple le texte B1 de la session 2006).


Tant que les fonctions $\Phi$ et $\Psi$ ne s'annulent pas, on peut \'ecrire
$\frac{\Phi'(t)}{\Phi(t)} = \frac{\Psi''(x)}{\Psi(x)}$.
\'Etant donn\'e que le premier terme d\'epend uniquement de $t$
et le second uniquement de $x$, on peut dire que ces deux termes sont constants.
On suppose que cette constante est non nulle (sinon on a une solution
identiquement nulle).
Pour satisfaire les conditions de Dirichlet, on impose aussi $\Psi(0) = \Psi(1) = 0$.


Les fonctions $\Phi$ et $\Psi$ v\'erifient donc
\begin{align*}
  \Phi'(t)
  &= K \Phi(t) , \quad 0 \leq t \leq T,
  \\
  \Psi''(x)
  &= K \Psi(x) , \quad 0 \leq x \leq 1, \quad
  \Psi(0)
  = 0 , \quad
  \Psi(1)
  = 0 .
\end{align*}
La fonction $\Phi$ vaut donc $\Phi(t) = e^{K t}$. Discutons maintenant de $\Psi$ et du signe de $K$.

Si $K>0$, alors $\Psi(x) = a e^{\sqrt{K} x} + b e^{- \sqrt{K} x}$.
Les conditions aux limites donnent
$a+b=0$ et $a(e^{\sqrt{K}} - e^{-\sqrt{K}}) = 0$.
La seule solution est donc la solution nulle.


On suppose maintenant $K < 0$.
Dans ce cas, $\Psi(x) = a e^{i\sqrt{|K|} x} + b e^{- i\sqrt{|K|} x}$.
Les conditions aux limites donnent alors $a + b = 0$
et $a \sin(\sqrt{|K|}) = 0$.
La seule fa\c{c}on d'avoir une solution non identiquement nulle
est d'imposer $\sin(\sqrt{|K|}) = 0$ et donc de prendre $K = - \pi^2 k^2$ avec $k \in \Z^*$
(rappelons qu'on a suppos\'e $K<0$).
On remarque ainsi
que les fonctions de la forme $u(t,x) = \sin(k \pi x) e^{-k^2 \pi^2 t}$
v\'erifient le probl\`eme~\eqref{eq:chaleur_Dir} (avec $f = 0$ et $u_0(x) = \sin(k \pi x)$).


Nous venons de trouver des solutions pour des donn\'ees initiales sous la forme particuli\`ere
$u_0(x) = \sin(k \pi x)$.
Pour g\'en\'eraliser ce raisonnement \`a d'autres donn\'ees initiales, nous allons maintenant
chercher des solutions sous la forme d'une s\'erie de Fourier dont chaque terme
sera de la forme de la solution particuli\`ere trouv\'ee pr\'ec\'edemment.

On suppose que la donn\'ee initiale $u_0$ est $C^2([0,1])$ avec $u_0(0) = u_0(1) = 0$.
On note $U_0$ la fonction d\'efinie sur $[-1,1]$ par
\begin{align*}
  U_0(x) =
  \begin{cases}
    u_0(x) \qquad \text{si } x \in [0,1] ,
    \\
    -u_0(-x) \qquad \text{sinon} .
  \end{cases}
\end{align*}
On prolonge \'egalement $U_0$ sur $\R$ par $2$-p\'eriodicit\'e.
La fonction obtenue est $C^1(\R)$.
D'apr\`es le th\'eor\`eme de Dirichlet, cette fonction est donc \'egale \`a 
sa s\'erie de Fourier (qui converge).
De plus, comme $U_0$ est impaire, cette s\'erie de Fourier ne comprend que 
des sinus.

Donc, en particulier, sur $[0,1]$ on a 
\begin{align*}
  u_0(x) = \sum_{k \in \N^*} b_k \sin(k \pi x) ,
\end{align*}
avec
\begin{align*}
  b_k
  = \int_{-1}^1 U_0(x) \sin(k \pi x) \deriv x 
  = 2 \int_{0}^1 u_0(x) \sin(k \pi x) \deriv x .
\end{align*}
On obtient une autre expression de $b_k$ par deux int\'egrations par parties
(et on utilise $u_0 \in C^2([0,1])$)
\begin{align*}
  b_k
  = \dfrac{2}{k \pi} \int_{0}^1 u_0'(x) \cos(k \pi x) \deriv x
  = \dfrac{-2}{k^2 \pi^2} \int_{0}^1 u_0''(x) \sin(k \pi x) \deriv x .
\end{align*}
Cette derni\`ere expression permet de donner la majoration suivante sur la valeur
des coefficients $b_k$
\begin{align*}
  | b_k | \leq \frac{C}{k^2} ,
\end{align*}
avec $C > 0$ une constante ind\'ependante de $k$.
Pour $t \geq 0$, on a $e^{-k^2 \pi^2 t} \leq 1$, la s\'erie 
$u(t,x) = \sum_{k\in\N^*} b_k \sin(k \pi x) e^{- k^2 \pi^2 t}$ est donc normalement
convergente sur $[0,T] \times [0,1]$.

De plus, pour $0 < t$, $e^{-k^2 \pi^2 t} < 1$, la s\'erie
$\sum_{k\in\N^*} - k^2 \pi^2 b_k \sin(k \pi x) e^{- k^2 \pi^2 t}$ est donc normalement
convergente sur $[a,T] \times [0,1]$ pour tout $a>0$.
La fonction $u$ est donc d\'erivable par rapport \`a la variable $t$
et sa d\'eriv\'ee est donn\'ee par
\begin{align*}
  \dfrac{\partial u}{\partial t} (t,x) 
  = - \sum_{k \in \N^*} k^2 \pi^2 b_k \sin(k \pi x) e^{-k^2 \pi^2 t} .
\end{align*}
On peut \'egalement montrer que $u$ est d\'erivable deux fois par rapport
\`a la variable $x$ et que cette d\'eriv\'ee seconde \`a la m\^eme
valeur que la d\'eriv\'ee premi\`ere en $t$.
Cette s\'erie de Fourier v\'erifie donc l'\'equation de la chaleur.


Enfin, en utilisant des arguments pr\'esent\'es dans la section~\ref{subsec:chaleur_prop},
on peut montrer que cette solution est unique.

Nous avons prouv\'e le th\'eor\`eme suivant.
\begin{theorem}
  Si $u_0 \in C^2([0,1])$ v\'erifie $u_0(0) = u_0(1) = 0$ et si $f=0$,
  alors le probl\`eme~\eqref{eq:chaleur_Dir} admet une unique solution.
  De plus, cette solution est donn\'ee explicitement par
  \begin{align*}
    u(t,x) = \sum_{k\in\N^*} b_k \sin(k \pi x) e^{- k^2 \pi^2 t} ,
  \end{align*}
  avec
  $b_k = 2 \int_{0}^1 u_0(x) \sin(k \pi x) \deriv x$.
\end{theorem}




%%%%%%%%%%%%%%%%
\subsubsection{Cas de la droite r\'eelle $\Omega = \R$}
\label{subsubsec:chaleur_R}


On s'int\'eresse ici au probl\`eme
\begin{equation}
  \label{eq:chaleur_R}
  \text{Trouver $u : (0,T) \times (0,1) $ v\'erifiant  }
  \left\{
    \begin{array}{l l}
      \dfrac{\partial u}{\partial t} - \dfrac{\partial^2 u}{\partial x^2} = f 
      &\dans (0,T) \times \R ,
      \\
      u(0,.) = u_0 
      & \dans \R ,
    \end{array}
  \right.
\end{equation}
o\`u $f$ et $u_0$ sont donn\'es.
Notons que comme le domaine spatial $\R$ n'a pas de bord, l'\'equation 
n'a pas de conditions aux limites.


On peut utiliser la transform\'ee de Fourier de $u$ par rapport \`a $x$ 
pour r\'esoudre ce probl\`eme. On la note
\begin{align*}
  \calF(u)(t,\omega) := \hu(t,\omega) := \int_{\R} e^{- i \omega x} u(t,x) \deriv x .
\end{align*}
On notera la transform\'ee de Fourier inverse
\begin{align*}
  \calF^{-1}(v)(t,x) := \dfrac{1}{2\pi} \int_{\R} e^{i \omega x} v(t,\omega) \deriv \omega .
\end{align*}

Ces transformations peuvent \^etre appliqu\'ees \`a des fonctions $L^1(\R)$ en espace.
On rappelle que si, de plus, $u$ est d\'erivable par rapport \`a $x$ et de d\'eriv\'ee
int\'egrable alors $\calF(\partial_x u)(t,\omega) = i \omega \calF(u)(t,\omega)$.

La d\'efinition de la transform\'ee de Fourier et de son inverse peut \^etre \'etendue
aux fonctions de $L^2(\R)$. De plus, si $u \in L^2(\R)$, alors $\hu \in L^2(\R)$.

Dans la suite, on suppose que $f \in L^2(\R)$
et que $u \in L^2(\R)$ est d\'erivable par rapport \`a $x$ et v\'erifie
$\partial_x u \in L^2(\R)$,
on montre que $\hu(t,\omega)$ est solution du probl\`eme
\begin{align*}
  \dfrac{\partial \hu}{\partial t}(t,\omega) + \omega^2 \hu(t , \omega) = \hf(t,\omega) 
  & \dans (0,T) \times \R ,
  \\
  \hu(0 , \omega) = \hu_0(\omega)
  & \dans \R .
\end{align*}
Il s'agit d'une famille d'EDO lin\'eaires index\'ee par $\omega$.
Si $f$ est continue alors, d'apr\`es le th\'eor\`eme de Cauchy--Lipschitz global,
chacune de ces EDO admet une unique solution donn\'ee par
\begin{align*}
  \hu(t,\omega) = \hu_0(\omega) e^{- \omega^2 t} 
  + \int_0^t \hf(s,\omega) e^{- \omega^2 (t - s)} \deriv s . 
\end{align*}

\'Etant donn\'e que $u(t,.) \in L^2(\R)$, on a $\hu(t,.) \in L^2(\R)$.
Apr\`es quoi, on applique la transform\'ee de Fourier inverse pour trouver
une solution \`a l'\'equation \eqref{eq:chaleur_R}.
En utilisant les propri\'et\'es de la transform\'ee de Fourier, on obtient donc
\begin{align*}
  u(t,x) 
  =& \calF^{-1}(\hu_0) * \calF^{-1} (e^{-\omega^2 t})
  + \calF^{-1} (\int_0^t \hf(s,\omega) e^{- \omega^2(t-s)} \deriv s)
  \\
  =& (u_0 * G(t,.))(t,x) + \int_{\R} \int_0^t G(t-s, x-y) f(s,y) \deriv s \deriv y ,
\end{align*}
avec $G(t,x) = \dfrac{1}{2 \pi} \sqrt{\dfrac{\pi}{t}} e^{- \frac{x^2}{4t}}$
le noyau de la chaleur et $*$ le produit de convolution.
Pour rappel
$(u_0 * G(t,.))(t,x) := \int_{\R} u_0(y) G(t,x-y) \deriv y$.


On a donc \'etabli le r\'esultat suivant.
\begin{theorem}
  Supposons que $u \in L^2(0,T;H^2(\R)) \cap H^1(0,T;L^2(\R))$ est solution
  du probl\`eme~\eqref{eq:chaleur_R}.
  Alors $u(t,x) = (u_0 * G(t,.))(t,x) + \int_{\R} \int_0^t G(t-s, x-y) f(s,y) \deriv s \deriv y$,
  avec $G(t,x) = \dfrac{1}{2 \pi} \sqrt{\dfrac{\pi}{t}} e^{- \frac{x^2}{4t}}$.
\end{theorem}


\begin{remark}
  A $t>0$ fix\'e, $G(t,.)$ est une Gaussienne.
  Quand $t \to 0^+$, le pic de la Gaussienne devient singulier et on retrouve une masse de Dirac.
\end{remark}

\begin{exercise}
  Pour $t > 0$, calculer $\calF^{-1}(e^{-\omega^2 t})$.

  Indice : utiliser des int\'egrations par parties et les propri\'et\'es de la transform\'ee
  de Fourier pour prouver que pour tout $t > 0$, $x \mapsto \calF^{-1}(e^{-\omega^2 t})$ est solution
  d'une EDO d'ordre 2.
  Prouver que le probl\`eme de Cauchy v\'erifi\'e par cette fonction admet une unique solution
  et v\'erifier que le noyau de la chaleur est cette unique solution.
\end{exercise}


\begin{proposition}
  Pour tout $t > 0$, pour tout $x \in \R$, on a
  $\dfrac{\partial G}{\partial t}(t,x) - \dfrac{\partial^2 G}{\partial x^2}(t,x) = 0$.
\end{proposition}

\begin{remark}
  En fait, on peut montrer que
  $\dfrac{\partial G}{\partial t} - \dfrac{\partial^2 G}{\partial x^2} = \delta_{(0,0)}$
  au sens des distributions.
  La fonction $G$ est donc aussi appel\'ee solution \'el\'ementaire de la chaleur.
\end{remark}

\begin{proposition}[Effet r\'egularisant de la chaleur]
  Si $f=0$ et $u_0 \in L^2(\R)$, alors $u \in C^{\infty}([a,T] \times \R)$ pour tout $a$ v\'erifiant
  $0 < a < T$.
\end{proposition}

\begin{proof}
  C'est une cons\'equence de $u(t,x) = (G(t,.) * u_0)(x)$,
  $\dfrac{\deriv^n}{\deriv x^n}(G(t,.) * u_0) = \dfrac{\partial^n G}{\partial x^n}(t,.) * u_0$
  et $G \in C^{\infty}([a,T] \times \R)$.
\end{proof}

\begin{remark}
  L'effet r\'egularisant s'observe aussi sur un domaine born\'e.
\end{remark}

\begin{proposition}[Propagation de la chaleur \`a vitesse infinie]
  Si $u_0 \geq 0$ a un support born\'e, alors pour tous $t > 0$ et $x \in \R$,
  on a $u(t,x) > 0$.
\end{proposition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Propri\'et\'es g\'en\'erales}
\label{subsec:chaleur_prop}

!! Voir si on dit qu'on interprete l'equation au sens des distributions ...

On consid\`ere \`a nouveau le domaine born\'e $\Omega := (0,1)$
et le probl\`eme~\eqref{eq:chaleur_Dir}.
On peut montrer qu'une solution d\'epend contin\^ument des donn\'ees $u_0$ et $f$.
\begin{proposition}
  \label{prop:chaleur_continuite_donnees}
  Soit $u \in C^0([0,T];L^2(0,1)) \cap L^2(0,T;H_0^1(0,1))$ une solution de~\eqref{eq:chaleur_Dir}.
  Si $u_0 \in L^2(0,1)$ et $f \in L^2(0,T; L^2(0,1))$,
  alors 
  \begin{align}
    \label{eq:chaleur_continuite_donnees}
    \sup_{t \in [0,T]} \| u(t,.) \|_{L^2(0,1)} + \frac12 \| \partial_x u \|_{L^2(0,T;L^2(0,1))}
    \leq \| u_0 \|_{L^2(0,1)} + \| f \|_{L^2(]0,T[ \times ]0,1[)} .
  \end{align}
\end{proposition}

\begin{proof}
  On suppose tout d'abord la fonction $u$ r\'eguli\`ere, le r\'esultat final
  sera obtenu par densit\'e.
  
  Multiplions la premi\`ere ligne de \eqref{eq:chaleur_Dir} par $u$
  et int\'egrons en espace sur le domaine $\Omega = (0,1)$,
  on obtient
  \begin{align*}
    \int_{\Omega} \dfrac{\partial u}{\partial t} u = \int_{\Omega} \dfrac{\partial^2 u}{\partial x^2} u 
    + \int_{\Omega} f u .
  \end{align*}
  On utilise ensuite l'int\'egration par parties 
  $\int_{\Omega} \dfrac{\partial^2 u}{\partial x^2} u  
  = - \int_{\Omega} \left(\dfrac{\partial u}{\partial x} \right)^2$
  (on rappelle que $u(t,0) = u(t,1) = 0$)
  ainsi que l'in\'egalit\'e de Cauchy--Schwarz 
  $\int_{\Omega} f u \leq \| f \|_{L^2(\Omega)} \| u \|_{L^2(\Omega)}$,
  que l'on combine avec l'in\'egalit\'e de Young 
  $\| f \|_{L^2(\Omega)} \| u \|_{L^2(\Omega)} \leq \dfrac{1}{2} (\| f \|_{L^2(\Omega)}^2 +  \| u \|_{L^2(\Omega)}^2)$.
  
  On obtient ainsi
  \begin{align*}
    \dfrac{1}{2} \dfrac{\deriv}{\deriv t} \| u(t,\cdot) \|_{L^2(\Omega)}^2
    \leq - \left\| \dfrac{\partial u}{\partial x} (t,\cdot) \right\|_{L^2(\Omega)}^2
    + \dfrac{1}{2}  (\| f (t,\cdot) \|_{L^2(\Omega)}^2 +  \| u (t,\cdot) \|_{L^2(\Omega)}^2) .
  \end{align*}
  De plus, d'apr\`es l'in\'egalit\'e de Poincar\'e, on a 
  $\| u (t,\cdot) \|_{L^2(\Omega)}^2 \leq \| \dfrac{\partial u}{\partial x} (t,\cdot) \|_{L^2(\Omega)}^2$.
  On a donc 
  \begin{align*}
    \dfrac{\deriv}{\deriv t} \| u(t,\cdot) \|_{L^2(\Omega)}^2
    + \frac12 \left\| \dfrac{\partial u}{\partial x} (t,\cdot) \right\|_{L^2(\Omega)}^2
    \leq \| f (t,\cdot) \|_{L^2(\Omega)}^2 .
  \end{align*}
  On int\`egre selon $t$, ce qui donne
  \begin{align*}
    \| u(t,\cdot) \|_{L^2(\Omega)}^2 + \frac12 \| \partial_x u \|_{L^2(0,t;L^2(0,1))}^2
    \leq \| u_0 \|_{L^2(\Omega)}^2 + \| f \|_{L^2((0,t) \times \Omega)}^2 .
  \end{align*}
  On obtient la borne sur $\sup_{t \in [0,T]} \| u(t,.) \|_{L^2(0,1)}$ en prenant le $\sup$ sur $t$
  et la borne sur $\frac12 \| \partial_x u \|_{L^2(0,T;L^2(0,1))}^2$ en prenant $t=T$.
\end{proof}


On peut utiliser ce r\'esultat pour montrer l'existence d'une unique solution faible
au probl\`eme de Chaleur-Dirichlet.


\begin{proposition}
  \label{prop:chal_sol_faibles}
  Le probl\`eme~\eqref{eq:chaleur_Dir} est bien pos\'e:
  si $f \in L^2(0,T;L^2(0,1))$ et $u_0 \in L^2(0,1)$,
  alors il existe une unique solution $u$
  dans $C^0([0,T];L^2(0,1)) \cap L^2(0,T;H_0^1(0,1))$
  et cette solution d\'epend contin\^ument des donn\'ees d'apr\`es
  l'estim\'ee~\eqref{eq:chaleur_continuite_donnees}.
\end{proposition}
L'unicit\'e et la continuit\'e par rapport aux donn\'ees sont une cons\'equence directe
de la Proposition~\ref{prop:chaleur_continuite_donnees}
(pour l'unicit\'e: consid\'erer deux solutions, leur diff\'erence v\'erifie~\eqref{eq:chaleur_Dir}
avec des donn\'ees nulles, d'apr\`es~\eqref{eq:chaleur_continuite_donnees}
cette diff\'erence est nulle).
L'existence est plus d\'elicate et on ne la pr\'esentera pas ici.
Le lecteur currieux peut regarder la Section~\ref{subsec:chal_sol_faibles}.

Notons que nous avons un gain de r\'egularit\'e de la solution
dans $C^0([0,T];L^2(0,1)) \cap L^2(0,T;H_0^1(0,1))$
par rapport au second membre qui est dans $L^2(0,T;L^2(0,1))$
(ce gain de r\'egularit\'e est plus important en espace qu'en temps).
Notons \'egalement que le fait que la solution soit dans $C^0([0,T];L^2(0,1))$
est en accord avec la donn\'ee initiale qui est dans $L^2(0,1)$.


On s'int\'eresse maintenant \`a la question de la r\'eversibilit\'e de l'\'equation
de la chaleur. On consid\`ere une solution $u$ de~\eqref{eq:chaleur_Dir}
et $\tu(t,x) := u(T-t,x)$.
La fonction $\tu$ v\'erifie l'\'equation de la chaleur r\'etrograde:
\begin{equation}
  \label{eq:chaleur_retro}
  \text{Trouver $\tu : (0,T) \times (0,1)$ v\'erifiant }
  \left\{
    \begin{array}{l l}
      -\dfrac{\partial \tu}{\partial t} - \dfrac{\partial^2 \tu}{\partial x^2} = \tf 
      &\dans (0,T) \times (0,1) ,
      \\
      \tu(0,.) = u_T 
      & \dans (0,1) ,
      \\
      \tu(t,0) = 0 , \quad \tu(t,1) = 0 & \forall t \in (0,T) ,
    \end{array}
  \right.
\end{equation}
o\`u $\tf(t,x) := f(T-t,x)$ et $u_T(x) := u(T,x)$.
Ce probl\`eme est mal pos\'e, on dit alors que l'\'equation de la chaleur n'est pas r\'eversible.


\begin{proposition}[Non r\'eversibilit\'e de l'\'equation de la chaleur]
  Le probl\`eme~\eqref{eq:chaleur_Dir} n'est pas r\'eversible:
  le probl\`eme~\eqref{eq:chaleur_retro} est mal pos\'e.
\end{proposition}

!! EST-CE SUR QU'ON PEUT PROUVER L'EXISTENCE D'UNE UNIQUE SOL ??
-- VERIFIER ET METTRE A JOUR LA PREUVE !!

\begin{proof}
  On peut montrer l'existence d'une unique solution au probl\`eme~\eqref{eq:chaleur_retro}.
  Son caract\`ere mal pos\'e vient de la d\'ependance non continue aux donn\'ees.
  Pour prouver cela, on va utiliser les r\'esutats de la Section~\ref{subsubsec:chal_born}.


  On consid\`ere $\tf = 0$ et on suppose par l'absurde qu'il existe une constante $C>0$ telle que
  pour toute solution $\tu$ de~\eqref{eq:chaleur_retro}, on a
  \begin{align*}
    \sup_{0 \leq t \leq T} \| \tu(t,.) \|_{L^2(0,1)} \leq C \| \tu(0,.) \|_{L^2(0,1)} .
  \end{align*}
  En adaptant le raisonnement de la Section~\ref{subsubsec:chal_born}, on peut montrer que
  les fonctions $\tu_k (t,x) := \sin(k\pi x) e^{k^2 \pi^2 t}$ sont solution pour tout $k \in \N^*$.
  On a $\sup_{0 \leq t \leq T} \| \tu_k(t,.) \|_{L^2(0,1)} = \frac1{\sqrt2} e^{k^2 \pi^2 T}$ et 
  $\| \tu(0,.) \|_{L^2(0,1)} = \frac1{\sqrt2}$. On obtient une contradiction en faisant tendre $k$
  vers $+ \infty$.
\end{proof}


\begin{remark}
  La non-r\'eversibilit\'e de l'\'equation peut \^etre interpr\'et\'ee comme l'impossibilit\'e
  pratique de retrouver la solution \`a partir de la donn\'ee finale.
  En effet, si cette donn\'ee est bruit\'ee, ne serait-ce qu'un peu, alors les bruits
  ind\'esirables peuvent exploser aussi vite qu'on veut et polluer la solution.
\end{remark}

\begin{exercise}
  L'\'equation des ondes est-elle r\'eversible ?
  La r\'eponse est donn\'ee dans le chapitre suivant.
\end{exercise}


\begin{proposition}[Principe du maximum]
  Si pour tous $t \in (0,T)$ et $x \in (0,1)$, on a $f(t,x) \leq 0$.
  Alors $\sup_{(t,x) \in [0,T] \times [0,1]} u(t,x) = \max(0, \sup_{x \in [0,1]} u_0(x))$
  avec $u$ la solution de~\eqref{eq:chaleur_Dir}.
\end{proposition}
Notons que nous avons utilis\'e le fait que les conditions de Dirichlet \'etaient homog\`enes.
Dans le cas de conditions non homog\`enes, il faut aussi prendre en compte
les donn\'ees de Dirichlet.

\begin{remark}[Conditions de Dirichlet non homog\`enes]
  Dans le probl\`eme~\eqref{eq:chaleur_Dir}, on a utilis\'e des conditions de Dirichlet homog\`enes.
  Pour r\'esoudre le probl\`eme
  \begin{equation*}
    \text{Trouver $u : (0,T) \times (0,1)$ v\'erifiant }
    \left\{
      \begin{array}{l l}
        \dfrac{\partial u}{\partial t} - \dfrac{\partial^2 u}{\partial x^2} = f 
        &\dans (0,T) \times (0,1) ,
        \\
        u(0,.) = u_0 
        & \dans (0,1) ,
        \\
        u(t,0) = \alpha(t) , \quad u(t,1) = \beta(t) & \forall t \in (0,T) ,
      \end{array}
    \right.
  \end{equation*}
  on peut utiliser un rel\`evement (comme dans la Section~\ref{subsec:Lap_prop}).
  Pour cela, il faut choisir une fonction $g$ v\'erifiant $g(t,0) = \alpha(t)$
  et $g(t,1) = \beta(t)$,
  puis r\'esoudre le probl\`eme avec conditions de Dirichlet homog\`enes
  \begin{equation*}
    \text{Trouver $\tu : (0,T) \times (0,1)$ v\'erifiant }
    \left\{
      \begin{array}{l l}
        \dfrac{\partial \tu}{\partial t} - \dfrac{\partial^2 \tu}{\partial x^2}
        = f - \dfrac{\partial g}{\partial t} + \dfrac{\partial^2 g}{\partial x^2}
        &\dans (0,T) \times (0,1) ,
        \\
        \tu(0,.) = u_0 - g(0,.)
        & \dans (0,1) ,
        \\
        \tu(t,0) = 0 , \quad \tu(t,1) = 0 & \forall t \in (0,T) .
      \end{array}
    \right.
  \end{equation*}
  La solution du premier probl\`eme sera alors donn\'ee par $u(t,x) = \tu(t,x) + g(t,x)$.
  Au passage, pour le domaine (1d) $\Omega = (0,1)$, on peut facilement
  choisir $g(t,x) = (1-x) \alpha(t) + x \beta(t)$.
\end{remark}

\begin{exercise}
  V\'erifier que $u(t,x) = \tu(t,x) + g(t,x)$ est bien solution du premier probl\`eme.
\end{exercise}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Approximation par diff\'erences finies}


Nous nous pla\c{c}ons ici dans le m\^eme cadre que celui utilis\'e pour 
l'\'equation de transport en Section~\ref{subsec:transport_DF}.
Nous d\'ecomposons les intervalles de temps et d'espace
respectivement en $N$ et $M$ sous-intervalles.
On note $t_n$ ($0 \leq n \leq N$) et $x_j$ ($0 \leq j \leq M$)
les bornes de ces sous-intervalles.
On rappelle $x_j = j h_x$, $h_x = 1/M$, $t_n = n h_t$ et $h_t = T / N$.
Nous cherchons \`a approcher la solution de~\eqref{eq:chaleur_Dir}
en $t_n$ et $x_j$, i.e. $u(t_n,x_j)$, par le terme $u_j^n$ d'une suite
$(u_j^n)$. 
Nous proposons plusieurs sch\'emas pour calculer cette suite.
Leurs propri\'et\'es seront \'etudi\'ees en utilisant les 
\'el\'ements de la Section~\ref{subsubsec:analyse_def}.

%%%%%%%%%%%%%%%%%%
\subsubsection{Sch\'ema explicite centr\'e}

Le sch\'ema le plus intuitif \`a utiliser est un sch\'ema 
explicite centr\'e.
Pour cela, approchons les d\'eriv\'ees de la fa\c{c}on suivante:
\begin{align*}
  \dfrac{\partial u}{\partial t}(t_n,x_j) \simeq \dfrac{u(t_{n+1},x_j) - u(t_n,x_j)}{h_t} ,
  \qquad 
  \dfrac{\partial^2 u}{\partial x^2}(t_n,x_j) 
  \simeq \dfrac{u(t_{n},x_{j+1}) - 2 u(t_n,x_j) + u(t_n,x_{j-1})}{h_x^2} .
\end{align*}


Nous obtenons ainsi le sch\'ema suivant
\begin{align}
  \label{eq:chaleur_DF_exp_centre}
  \left\{
  \begin{array}{l}
    u_j^0
    = u_0(x_j) ,
    \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \;\;\quad
    (1 \leq j \leq M-1) , 
    \\
    u_0^n = u_M^n = 0 ,
    \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \quad
    (0 \leq n \leq N), 
    \\
    u_j^{n+1}
    = u_j^{n} + \dfrac{h_t}{h_x^2} (u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n} ) 
    + h_t f(t_n,x_j) ,
    \quad (0 \leq n \leq N-1, 1 \leq j \leq M-1).
  \end{array}
  \right.
\end{align}

\begin{exercise}
  La figure \ref{fig:chaleur_nu} 
  a \'et\'e obtenue gr\^ace au sch\'ema \eqref{eq:chaleur_DF_exp_centre}.
  Coder ce sch\'ema et retrouver cette figure.
  
  !! donner les param\`etres !!
\end{exercise}


Nous allons maintenant \'etudier les propri\'et\'es de ce sch\'ema.
Nous pouvons prouver que ce sch\'ema est consistant d'ordre 1 en temps et 2 en espace
pour la norme $\| \cdot \|_{\infty}$.
De plus, il est stable sous la condition de CFL $2 h_t \leq h_x^2$ 
et instable si cette condition n'est
pas remplie (pour la norme $\| \cdot \|_{\infty}$).
Ces r\'esultats peuvent \^etre prouv\'es en adaptant ce qui a \'et\'e fait dans
la Section~\ref{subsec:transport_DF}.

\begin{exercise}
  \label{exo:chaleur_explicite}
  Dans cet exercice, nous \'etudions le sch\'ema~\eqref{eq:chaleur_DF_exp_centre}
  avec la norme $\| \cdot \|_{\infty}$.
  \begin{enumerate}
  \item Montrer que nous sommes bien dans le cadre de la Section~\ref{subsubsec:analyse_def},
    i.e. montrer que $U^n = (u_j^n)_{j=1}^{M-1}$ v\'erifie~\eqref{eq:schema_1pas}
    (avec $U_0$, $A$ et $F^n$ \`a d\'eterminer).
  \item Prouver que ce sch\'ema est consistant d'ordre 1 en temps et 2 en espace.
  \item Prouver que ce sch\'ema est stable sous la condition de CFL
    $2 h_t \leq h_x^2$.
  \item Prouver que ce sch\'ema est instable si la condition de CFL
    pr\'ec\'edente n'est pas v\'erifi\'ee.
  \end{enumerate}
  NB: On pourra adapter ce qui a \'et\'e fait dans la Section~\ref{subsubsec:deux_schemas}.
\end{exercise}

\begin{remark}[CFL parabolique]
  Ici, la condition de CFL associ\'ee \`a ce sch\'ema explicite est
  $2 h_t \leq h_x^2$ (\`a comparer avec la CFL de l'\'equation de transport
  $a h_t \leq h_x$). Le carr\'e au dessus du pas d'espace rend cette condition plus restrictive
  que celle de l'\'equation de transport. Par exemple, pour rester \`a CFL constante,
  si on divise le pas d'espace par deux, il faut diviser le pas de temps par deux pour l'\'equation
  de transport et par quatre pour l'\'equation de la chaleur.
  Cette CFL plus restrictive est une des raisons pour lesquelles on pr\'ef\`ere g\'en\'eralement
  utiliser un sch\'ema implicite pour r\'esoudre l'\'equation de la chaleur.
\end{remark}

Bien que, comme nous venons de le voir, on peut \'etudier le sch\'ema explicite centr\'e
avec la norme $\| \cdot \|_{\infty}$, nous allons introduire une nouvelle norme:
la norme $\| \cdot \|_{L^2}$. Cette norme sera utile pour la suite
(en particulier pour le sch\'ema implicite et pour l'\'equation des ondes).
\begin{definition}[Norme $\| \cdot \|_{L^2}$ pour les suites]
  Pour $V \in \R^{M-1}$, on d\'efinit
  \begin{align}
    \| V \|_{L^2} := \Big( h_x \sum_{j=1}^{M-1} |V_j|^2 \Big)^{\frac12}.
  \end{align}
\end{definition}

\begin{remark}
  Notons qu'il s'agit de la norme $\| \cdot \|_{\ell^2}$ classique multipli\'ee par un
  facteur $h_x^{\frac12}$. Ce facteur permet de donner \`a cette norme un comportement similaire
  \`a celui de la norme $\| \cdot \|_{L^2}$ des fonctions.
\end{remark}

Nous montrons maintenant que la norme $\| \cdot \|_{\infty}$ domine la norme $\| \cdot \|_{L^2}$.

\begin{proposition}
  La norme $\| \cdot \|_{\infty}$ domine la norme $\| \cdot \|_{L^2}$:
  il existe $C > 0$ telle que
  \begin{align*}
    \| V \|_{L^2} \leq C \| V \|_{\infty}
    \quad \forall V \in \R^{M-1} .
  \end{align*}
\end{proposition}

\begin{proof}
  Par un calcul direct
  \begin{align*}
    \| V \|_{L^2}^2 = h_x \sum_{j=1}^{M-1} |V_j|^2
    \leq h_x (M-1) \| V \|_{\infty}^2 \leq \| V \|_{\infty}^2 .
  \end{align*}
  Notons qu'ici on peut prendre $C = 1$ par ce que $\Omega = (0,1)$.
  Dans un cadre plus g\'en\'eral, il faudrait prendre $C = | \Omega |^{\frac12}$.
\end{proof}

\begin{remark}
  Ceci sera utilis\'e en particulier pour prouver la consistance d'un sch\'ema:
  on la prouvera pour la norme $\| \cdot \|_{\infty}$ et ce sera imm\'ediatement valable
  pour la norme $\| \cdot \|_{L^2}$.
\end{remark}

Nous voulons maintenant \'etudier la convergence du sch\'ema~\eqref{eq:chaleur_DF_exp_centre}
pour la norme $\| \cdot \|_{L^2}$.
Comme nous l'avons vu dans l'exercice~\ref{exo:chaleur_explicite},
le sch\'ema est consistant et stable pour la norme $\| \cdot \|_{\infty}$.
D'apr\`es le th\'eor\`eme de Lax, il est donc convergent (d'ordre 1 en temps et 2 en espace)
pour cette m\^eme norme (sous la condition de CFL $2 h_t \leq h_x^2$).
On peut donc tr\`es rapidement \'etablir que ce sch\'ema est convergent pour la norme
$\| \cdot \|_{L^2}$ sous la m\^eme condition de CFL.
Ceci vient du fait que la norme $\| \cdot \|_{\infty}$ domine la norme $\| \cdot \|_{L^2}$:
\[
  \max_{0 \leq n \leq N} \| \tu^n - U^n \|_{L^2}
  \leq C \max_{0 \leq n \leq N} \| \tu^n - U^n \|_{\infty}
  \leq C (h_t + h_x^2) .
\]
Cependant, pour de nombreux sch\'emas, la convergence en norme $\| \cdot \|_{\infty}$
est plus difficile \`a \'etablir qu'en norme $\| \cdot \|_{L^2}$.
Nous allons donc chercher \`a \'etablir la convergence en norme $\| \cdot \|_{L^2}$
sans utiliser la stabilit\'e en norme $\| \cdot \|_{\infty}$ (en pratique c'est tr\`es souvent
la stabilit\'e qui est plus difficile \`a \'etablir).


Comme nous l'avons vu dans l'exercice~\ref{exo:chaleur_explicite},
le sch\'ema~\eqref{eq:chaleur_DF_exp_centre} v\'erifie le cadre
de la Section~\ref{subsubsec:analyse_def} et il est consistant pour la norme $\| \cdot \|_{\infty}$
d'ordre 1 en temps et 2 en espace (donc aussi consistant au m\^eme ordre pour la norme
$\| \cdot \|_{L^2}$). Si nous prouvons la stabilit\'e en norme $\| \cdot \|_{L^2}$
alors nous pourrons utiliser le Th\'eor\`eme de Lax.
Comme nous allons le voir, l'\'etude de la stabilit\'e pour la norme $\| \cdot \|_{L^2}$
passe par l'\'etude des valeurs propres de la matrice du sch\'ema.

\begin{proposition}
  \label{prop:stabL2}
  On se place dans le cadre de la Section~\ref{subsubsec:analyse_def}.
  Si $A \in \R^{(M-1)^2}$ est sym\'etrique alors
  \begin{equation*}
    \tn A \tn_{L^2} = \rho(A) ,
  \end{equation*}
  o\`u $\rho(A) := \sup_{1 \leq j \leq M-1} |\lambda_j|$ est le rayon spectral de la matrice $A$
  avec $(\lambda_j)$ les valeurs propres de $A$.
\end{proposition}

\begin{proof}
  Si $A$ est sym\'etrique \`a valeurs r\'eelles, alors elle est diagonalisable dans $\R$.
  Il existe donc une base de vecteurs propres $(V_j)$.
  Pour tout vecteur $V$, on peut \'ecrire $V = \sum_{j=1}^{M-1} \alpha_j V_j$ et on a
  \begin{align*}
    \tn A \tn_{L^2} = \sup_{V \in \R^{M-1}\setminus\{0\}} \dfrac{\| A V \|_{L^2}}{\| V \|_{L^2}}
    = \sup_{\alpha \in \R^{M-1}\setminus\{0\}}
    \dfrac{(\sum_j (\alpha_j \lambda_j)^2 \| V_j \|^2)^{\frac12}}{(\sum_j \alpha_j^2 \| V_j \|^2)^{\frac12}}
    \leq \rho(A) .
  \end{align*}
  % On a $\tn A \tn_{L^2} \leq \rho(A)$.
  De plus, pour $j$ tel que $\rho(A) = | \lambda_j |$,
  on a $\| A V_j \|_{L^2} | \lambda_j | \| V_j \|_{L^2}$.
  On a donc montr\'e $\tn A \tn_{L^2} = \rho(A)$.
\end{proof}


L'id\'ee est donc de calculer les valeurs propres de $A$ et d'utiliser
le Corrolaire~\ref{corro:stability} pour prouver la stabilit\'e su sch\'ema.
Pour le calcul des valeurs propres, nous pouvons utiliser le r\'esultat suivant
\begin{proposition}
  \label{prop:VP}
  Soit $A \in \R^{(M-1)^2}$ une matrice tridiagonale d\'efinie par
  \begin{equation*}
    A =
    \begin{pmatrix}
      a & b &
      \\
      b & \ddots & \ddots
      \\
      & \ddots & \ddots & b
      \\
      & & b & a
    \end{pmatrix} ,
  \end{equation*}
  avec $a, b \in \R$. Les valeurs propres de $A$ sont les 
  $\lambda_k = a + 2b \cos \left( \dfrac{k \pi}{M} \right)$ avec $1 \leq k \leq M-1$.
  Le vecteur propre associ\'e $V_k$ a pour composantes 
  $(V_k)_j = \sin \left( j \dfrac{k \pi}{M} \right)$.

  NB: les vecteurs propres ne d\'ependent pas de $a$ et $b$.
\end{proposition}


\begin{proof}
  Pour une d\'emonstration de cette proposition, le lecteur pourra se r\'ef\'erer au 
  Lemme 2.2 du livre 
  de Brigitte Lucquin, "\'Equations aux d\'eriv\'ees partielles et leurs approximations", 2004.
\end{proof}


On peut montrer que nous sommes dans le cadre de la Section~\ref{subsubsec:analyse_def}
avec $A = I - h_t A_{\Delta}$ o\`u $A_{\Delta}$ est la matrice discr\'etisant le Laplacien
donn\'ee en~\eqref{eq:mat_DF_Laplacien}.
On applique donc la Proposition~\ref{prop:VP} avec $a = 1 - \frac{2h_t}{h_x^2}$
et $b = \frac{h_t}{h_x^2}$.
Les valeurs propres de cette matrice sont donc les
$\lambda_k = 1 - \frac{2h_t}{h_x^2}(1-\cos(\frac{k \pi}{M}))$ ($1 \leq k \leq M-1$).
Sous la condition de CFL $2h_t \leq h_x^2$, on a $| \lambda_k | \leq 1$ et donc
$\rho(A) \leq 1$.
En appliquant la Proposition~\ref{prop:stabL2} et le Corrolaire~\ref{corro:stability}, on
\'etablit le r\'esultat suivant
\begin{proposition}
  Le sch\'ema explicite centr\'e~\eqref{eq:chaleur_DF_exp_centre}
  est stable pour la norme $\| \cdot \|_{L^2}$ sous la condition de CFL $2 h_t \leq h_x^2$.
\end{proposition}

Comme nous l'avons indiqu\'e pr\'ec\'edemment, ce sch\'ema est consistant pour la norme
$\| \cdot \|_{L^2}$. Il est donc convergent sous la condition de CFL $2 h_t \leq h_x^2$
(ordre 1 en temps et 2 en espace).

!! FAUT-IL FAIRE UNE REMARQUE SUR LE PRINCIPE DU MAXIMUM DISCRET ??
-- A QUEL ENDROIT ?? ON POURRAIT AUSSI LA FAIRE POUR LES AUTRES EQUATIONS !!

%%%%%%%%%%%%%%%%%%
\subsubsection{Sch\'ema implicite centr\'e}
\label{subsubsec:chaleur_DF_implicite}


Comme \'evoqu\'e dans la section pr\'ec\'edente, l'utilisation de sch\'emas
explicites est tr\`es couteuse dans le cadre de l'\'equation de la chaleur.
On s'int\'eresse donc \`a la possibilit\'e d'utiliser des sch\'emas
qui seraient inconditionnellement stable.
Un premier exemple d'un tel sch\'ema est donn\'e par le sch\'ema 
implicite centr\'e.


On approche les d\'eriv\'ees partielles de la mani\`ere suivante:
\begin{align*}
  \dfrac{\partial u}{\partial t}(t_n,x_j) \simeq \dfrac{u(t_{n},x_j) - u(t_{n-1},x_j)}{h_t} ,
  \qquad 
  \dfrac{\partial^2 u}{\partial x^2}(t_n,x_j) 
  \simeq \dfrac{u(t_{n},x_{j+1}) - 2 u(t_n,x_j) + u(t_n,x_{j-1})}{h_x^2} .
\end{align*}




Le sch\'ema implicite centr\'e est donc d\'efini comme
\begin{align}
  \label{eq:chaleur_DF_imp_centre}
  \left\{
  \begin{array}{l l}
    u_j^0 = u_0(x_j) ,
    &1 \leq j \leq M-1,
    \\
    u_0^n = u_M^n = 0 ,
    &    0 \leq n \leq N, 
    \\
    u_j^{n} = u_j^{n-1} - \dfrac{h_t}{h_x^2} (u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n} ) 
    + h_t f(t_n,x_j) ,
    & 1 \leq n \leq N, 1 \leq j \leq M-1 .
  \end{array}
  \right.
\end{align}

Le sch\'ema peut donc \^etre \'ecrit sous la forme
\begin{align*}
  \widetilde{A} U^n = U^{n-1} + h_t \widetilde{F}^n ,
\end{align*}
avec $U^n$ le vecteur des $u_j^n$ pour $1 \leq j \leq N-1$ et $(\widetilde{F}^n)_j = f(t_n,x_j)$. 
De plus, $\widetilde{A} = I - h_t A_{\Delta}$ o\`u $A_{\Delta}$ est la matrice
du probl\`eme de Laplace-Dirichlet (cf~\eqref{eq:mat_DF_Laplacien}).
Pour rappel, cette matrice est exigible.


Pour montrer qu'il existe une unique solution \`a ce probl\`eme discret,
il faut montrer que la matrice $\widetilde{A}$ est inversible.
Cela a \'et\'e fait par un calcul direct dans l'exercice \ref{exo:transport_implicite}
dans le cadre de l'\'equation de transport.
Cependant ce calcul est bien plus difficile dans le cas pr\'esent.
La m\'ethode utilis\'ee consiste alors \`a calculer les valeurs propres de cette matrice.

En utilisant la Proposition~\ref{prop:VP}, les valeurs propres de la matrice $\widetilde{A}$
sont de la forme
\begin{align*}
  \lambda_k = 1 + \dfrac{2 h_t}{h_x^2} \left(1 - \cos \left(\frac{k \pi}{M} \right) \right)
  \qquad (1 \leq k \leq M-1) .
\end{align*}
Toutes ces valeurs propres sont strictement positives pour tous $h_t , h_x > 0$. 
La matrice $\widetilde{A}$ est donc inversible et le sch\'ema est bien d\'efini.
De plus, nous avons
\begin{equation*}
  U^{n+1} = (\widetilde{A})^{-1} U^n + h_t (\widetilde{A})^{-1} \widetilde{F}^n .
\end{equation*}
Nous sommes donc bien dans le cadre de la Section~\ref{subsubsec:analyse_def}.
Nous pouvons ainsi appliquer tous les r\'esultats de cette section
(notamment le Th\'eore\`eme de Lax).

Nous allons \'etudier la stabilit\'e de ce sch\'ema en norme $\| \cdot \|_{L^2}$.
Pour cela, nous devons donc \'etudier les valeurs propres de la matrice associ\'ee au sch\'ema,
i.e. la matrice $(\widetilde{A})^{-1}$.

Nous avons not\'e $(\lambda_k)$ les valeurs propres de $\widetilde{A}$, notons $(V_k)$
les vecteurs propres associ\'es. Nous avons
$V_k = (\widetilde{A})^{-1} \widetilde{A} V_k = \lambda_k (\widetilde{A})^{-1} V_k$
et donc les valeurs propres de $(\widetilde{A})^{-1}$ sont les
$(\lambda_k^{-1})$. De plus, on a $\lambda_k \geq 1$ pour tout $k$.
Donc $\rho((\widetilde{A})^{-1}) \leq 1$ et en appliquant
la Proposition~\ref{prop:stabL2} et le Corrolaire~\ref{corro:stability}, on
\'etablit la stabilit\'e du sch\'ema pour la norme $\| \cdot \|_{L^2}$.
Notons que cette stabilit\'e est inconditionnelle (il n'y a pas de CFL \`a respecter),
ce qui est attendu pour un sch\'ema implicite.


On peut \'egalement montrer que ce sch\'ema est consistant d'ordre 1 en temps
et 2 en espace en norme $\| \cdot \|_{\infty}$ (et donc aussi en norme $\| \cdot \|_{L^2}$).
D'apr\`es le th\'eor\`eme de Lax, ce sch\'ema converge inconditionnellement avec un ordre
1 en temps et 2 en espace.


\begin{proposition}[Convergence]
  Le sch\'ema implicite centr\'e est inconditionnellement stable pour la norme $\| \cdot \|_{L^2}$.
  De plus, il est consistant \`a l'ordre 1 en temps et 2 en espace.
  Il est donc inconditionnellement convergent \`a l'ordre 1 en temps et 2 en espace
  pour la norme $\| \cdot \|_{L^2}$.
\end{proposition}


!! Ecrire la preuve de la consistance !!

\begin{remark}
  Le temps de r\'esolution d'un pas de temps pour un sch\'ema implicite est un peu plus long
  que pour un sch\'ema explicite car il faut r\'esoudre un syst\`eme lin\'eaire.
  Ceci est compens\'e par le fait qu'il n'y a pas de restriction sur le pas de temps et on
  peut donc prendre des pas plus grand, impliquant moins de pas de temps.
\end{remark}


\begin{remark}
  On pourrait prouver la stabilit\'e de ce sch\'ema en norme $\| \cdot \|_{\infty}$
  mais ce serait plus difficile, c'est pour cela que l'on pr\'ef\`ere la norme
  $\| \cdot \|_{L^2}$. Dans certains cas o\`u la stabilit\'e pour la norme $\| \cdot \|_{L^2}$
  est aussi difficile \`a \'etablir, on se contente de la stabilit\'e au sens de Von Neumann
  (bien que ce soit moins rigoureux d'un point de vue math\'ematique).
\end{remark}

!! mettre r\'esultats num\'eriques !!

!! comparer avec sch\'ema explicite, notamment loin d'une condition non nulle !!

%%%%%%%%%%%%%%%%%%
\subsubsection{$\theta$-sch\'emas}

!! parler des $\theta$-sch\'emas -- voir poly L. !! 
-- Est-ce possible de le faire avec les defs de la section sur l'equation de transport ??

!! Preuve de stabilit\'e par la m\'ethode de l'\'energie : cf B. Lucquin !!


!! exo final sur les $\theta$-sch\'emas !!


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\'Etude du probl\`eme de Neumann}

Le but de cette section est d'\'etudier le probl\`eme de la chaleur
avec des conditions aux limites de Neumann.
Toutes les preuves sont laiss\'ees en exercice.




\begin{remark}[Condition de Neumann]
  Conservation de la valeur moyenne ??
  (...)
\end{remark}


\begin{exercise}
  Montrer que la solution du pb de Neumann sans terme source
  tend exponentiellement vers la valeur moyenne de la donn\'ee initiale.
\end{exercise}

!! V\'erifier cet exercice !!




!! autre gros exo sur conditions de Neumann ??


\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\'Equation des ondes}

On se place dans le domaine $\Omega = (0,1)$.
On s'int\'eresse au probl\`eme de l'\'equation des ondes avec des conditions de Dirichlet homog\`enes
\begin{equation}
  \label{eq:ondes_Dir}
  \text{Trouver $u : (0,T) \times (0,1)$ v\'erifiant }
  \left\{
    \begin{array}{l l}
      \dfrac{\partial^2 u}{\partial t^2} - c^2 \dfrac{\partial^2 u}{\partial x^2} = f 
      &\dans (0,T) \times (0,1) ,
      \\
      u(0,.) = u_0 
      & \dans (0,1) ,
      \\
      \dfrac{\partial u}{\partial t}(0,.) = u_1 
      & \dans (0,1) ,
      \\
      u(t,0) = 0 , \quad u(t,1) = 0 & \;\: \forall t \in (0,T) ,
    \end{array}
  \right.
\end{equation}
avec $c>0$ la c\'el\'erit\'e des ondes, $f$ un terme source et $u_0$, $u_1$ des conditions initiales.
Notons que si l'on compare avec l'\'equation de la chaleur,
l'\'equation des ondes poss\`ede une d\'eriv\'ee seconde en temps.
Cette d\'eriv\'ee seconde (au lieu de premi\`ere) demande donc une
condition aux limites (en temps) suppl\'ementaire.
On a donc besoin, en plus de conna\^itre la valeur de la solution \`a l'instant initial ($u_0$),
de conna\^itre la valeur de la d\'eriv\'ee en temps de la solution \`a l'instant initial ($u_1$).
On peut comparer avec des probl\`emes classiques 1d d\'erivant des lois de Newton
(par exemple la chute d'un objet soumis uniquement \`a son propre poids):
on a une d\'eriv\'ee seconde en temps et il faut une donn\'ee initiale sur la solution
et sa d\'eriv\'ee.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Recherche de solutions r\'eguli\`eres}

Comme pour l'\'equation de la chaleur, on cherche ici \`a construire des solutions
r\'eguli\`eres \`a l'\'equation des ondes.
On consid\`ere d'abord le cas du domaine born\'e $\Omega = (0,1)$
puis le cas de la droite r\'eelle $\Omega = \R$.

%%%%%%%%%%%%%%%%%%%%
\subsubsection{Cas du domaine born\'e $\Omega = (0,1)$}
\label{subsubsec:ondes_01}

Le but de cette section est de construire une solution explicite au
probl\`eme~\eqref{eq:ondes_Dir}.
On adapte ce qui a \'et\'e fait dans la Section~\ref{subsubsec:chal_born}
(le lecteur pourra comparer).
Pour simplifier, on se restreint au cas particulier o\`u $f = 0$.
Notons que cette m\'ethode peut \^etre adapt\'ee au cas o\`u $f$ n'est pas nul.

On utilise la m\'ethode de s\'eparation des variables.
On cherche donc une solution de la forme $u(t,x) = \Phi(t) \Psi(x)$.
En reportant cette expression dans l'\'equation, on s'aper\c{c}oit 
que ces fonctions doivent satisfaire la relation
$\Phi''(t) \Psi(x) = c^2 \Phi(t) \Psi''(x)$.
On cherche donc des fonctions qui v\'erifient
$\dfrac{\Phi''(t)}{\Phi(t)} = c^2 \dfrac{\Psi''(x)}{\Psi(x)} = C$
avec $C$ une constante (puisque ces deux expressions sont \'egales 
et d\'ependent du temps pour l'une et de l'espace pour l'autre).
De plus, nous ne sommes pas int\'eress\'es par le cas o\`u cette
constante serait nulle car la solution associ\'ee serait alors triviale.
Les fonctions $\Phi$ et $\Psi$ v\'erifient donc les conditions
\begin{align*}
  \Phi''(t) - C \Phi(t) = 0 , 
  \qquad
  c^2 \Psi''(x) - C \Psi(x) = 0 ,
  \qquad
  \Psi(0) = \Psi(1) = 0 .
\end{align*}

Si $C > 0$, on peut montrer en utilisant les conditions de Dirichlet homog\`enes
que la seule solution possible est la solution nulle.
On s'int\'eresse donc uniquement au cas o\`u $C < 0$.
Dans ce cas, on a $\Phi(t) = A \sin(\sqrt{|C|} t) + B \cos(\sqrt{|C|} t)$
et $\Psi(x) = A' \sin(\dfrac{\sqrt{|C|}}{c} x) + B' \cos(\dfrac{\sqrt{|C|}}{c} x)$.
Avec les conditions de Dirichlet homog\`enes, on montre
que $B' = 0$ et $C = - k^2 c^2 \pi^2$ avec $k \in \Z$.
Ainsi, si les conditions initiales le permettent, on peut consid\'erer
des solutions de la forme
$(t,x) \mapsto (A \sin(k\pi c t) + B \cos(k\pi c t)) \sin(k \pi x)$.


Pour \^etre plus g\'en\'eral et ainsi v\'erifier les conditions initiales impos\'ees,
on va consid\'erer des solutions 
sous la forme de s\'eries de Fourier utilisant ces termes.
Supposons que $u_0$ et $u_1$ sont dans $C^{2}([0,1])$
avec $u_0(0) = u_0(1) = 0$
et $u_1(0) = u_1(1) = 0$.
On peut alors \'ecrire
\begin{align*}
  u_0(x) = \sum\limits_{k=1}^{+\infty} b_k \sin (k \pi x)
  \qquad \text{et} \qquad
  u_1(x) = \sum\limits_{k=1}^{+\infty} c_k \sin (k \pi x) .
\end{align*}
avec $b_k = 2 \int_0^1 u_0(x) \sin(k \pi x) \deriv x$
et $c_k = 2 \int_0^1 u_1(x) \sin(k \pi x) \deriv x$.
On peut montrer que ces coefficients sont en $O(1/k^2)$ de sorte que les s\'eries
pr\'ec\'edentes sont normalement convergentes (voir Section~\ref{subsubsec:chal_born}).

La fonction d\'efinie par
\begin{align*}
  u(t,x) = \sum\limits_{k=1}^{+\infty} ( b_k \cos(k \pi c t) + \dfrac{c_k}{k \pi} \sin(k \pi c t) ) 
  \sin(k \pi x) ,
\end{align*}
est alors continue et solution de l'\'equation des ondes au sens des distributions
(les d\'eriv\'ees sont \`a consid\'erer au sens des distributions).


\begin{remark}
  La solution $u$ est p\'eriodique en temps, on a $u(\frac{2}{c}, x) = u_0(x)$
  et $\partial_t u(\frac{2}{c}, x) = u_1(x)$.
\end{remark}


!! A-T-ON BESOIN DE $C^2$ POUR LES CONDITIONS INITIALES ??
OU EST-CE UTILIS\'E ?? (idem pour la chaleur)
!! CLARIFIER CE QU'ON ENTEND PAR ``l'\'equation est v\'erifi\'ee au sens des distributions'' !!

%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Cas de la droite r\'eelle}

On consid\`ere le probl\`eme sur $\R$ entier ($\Omega = \R$) et on consid\`ere aussi $T = + \infty$
\begin{equation}
  \label{eq:ondes_R}
  \text{Trouver $u : \R_+ \times \R$ v\'erifiant  }
  \left\{
    \begin{array}{l l}
      \dfrac{\partial^2 u}{\partial t^2} - c^2 \dfrac{\partial^2 u}{\partial x^2} = f 
      &\dans \R_+ \times \R ,
      \\
      u(0,.) = u_0 
      & \dans \R ,
      \\
      \dfrac{\partial u}{\partial t}(0,.) = u_1 
      & \dans \R ,
    \end{array}
  \right.
\end{equation}
o\`u, \`a nouveau, $c > 0$ est la c\'el\'erit\'e des ondes, $f$ est le terme source
et $u_0$ et $u_1$ sont les donn\'ees initiales.


\begin{theorem}[Formule de d'Alembert]
  \label{thm:d_Alembert}
  Si $u_0 \in C^2(\R)$, $u_1 \in C^1(\R)$ et $f \in C^1(\R_+ \times \R)$,
  alors le probl\`eme \eqref{eq:ondes_R} admet une unique solution 
  $u \in C^2(\R_+ \times \R)$ donn\'ee par 
  \begin{align*}
    u(t,x) = \dfrac{u_0(x+ct) + u_0(x-ct)}{2} 
    + \dfrac{1}{2c} \int_{x-ct}^{x+ct} u_1(s) \deriv s
    + \dfrac{1}{2c} \int_0^t \int_{x - c(t-s)}^{x+c(t-s)} f(s,y) \deriv y \deriv s .
  \end{align*}
\end{theorem}



\begin{proof}
  On prouve ce th\'eor\`eme par analyse et synth\`ese.
  On suppose que $u$ est une solution de \eqref{eq:ondes_R}.
  L'id\'ee de la preuve consiste \`a s'int\'eresser aux droites $(t,x) \mapsto x-ct$
  et $(t,x) \mapsto x+ct$ selon lesquelles les ondes se d\'eplacent.
  On introduit donc le changement de variables $y = x+ct$ et $z = x-ct$,
  on note $v(y,z) := u\left(\dfrac{y-z}{2c} , \dfrac{y+z}{2}\right)$ la repr\'esentation
  de $u$ selon ces nouvelles variables.

  On prouve ensuite que $v$ v\'erifie l'\'equation
  \begin{align*}
    \dfrac{\partial^2 v}{\partial y \partial z}
    = - \dfrac{1}{4 c^2} f\left(\dfrac{y-z}{2c} , \dfrac{y+z}{2} \right) .
  \end{align*}
  Cela se fait ais\'ement en calculant cette d\'eriv\'ee crois\'ee et en rappelant que $u$ 
  est solution de \eqref{eq:ondes_R}.

  On peut ensuite calculer la fonction $v$ en int\'egrant la relation pr\'ec\'edente
  une fois selon $y$ et une fois selon $z$.
  On obtient
  \begin{align*}
    v(y,z) = G(z) + F(y)
    - \dfrac{1}{4c^2} \int_0^z \int_0^y f \left(\dfrac{s-r}{2c} , \dfrac{s+r}{2} \right)
    \deriv s \deriv r ,
  \end{align*}
  o\`u $F$ et $G$ sont des fonctions \`a d\'eterminer.
  On peut donc \'ecrire une premi\`ere expression pour $u$
  \begin{align*}
    u(t,x) 
    =& v(x+ct,x-ct)
    \\
    =& G(x-ct) + F(x+ct)
       - \dfrac{1}{4c^2} \int_{0}^{x-ct} \int_0^{x+ct} f\left(\dfrac{s-r}{2c} , \dfrac{s+r}{2}\right) 
       \deriv s \deriv r .
  \end{align*}

  Il faut maintenant d\'eterminer l'expression de $F$ et $G$.
  Pour cela, on \'evalue l'expression pr\'ec\'edente en $t=0$ et on utilise
  les conditions initiales, on obtient
  \begin{align}
    \label{eq:proof_DAlembert_u0}
    u_0(x) = G(x) + F(x)
    - \dfrac{1}{4c^2} \int_{0}^{x} \int_0^{x} f\left(\dfrac{s-r}{2c} , \dfrac{s+r}{2}\right)
    \deriv s \deriv r .
  \end{align}
  Pour obtenir une deuxi\`eme relation, on suppose que $F$ et $G$ sont
  d\'erivables, on d\'erive l'expression de $u$ et on \'evalue en $t=0$,
  on obtient
  \begin{align}
    \label{eq:proof_DAlembert_u1}
    u_1(x) = - c G'(x) + c F'(x) - \dfrac{1}{4c} \Big( 
    \int_{0}^x f\left(\dfrac{x-r}{2c},\dfrac{x+r}{2}\right) \deriv r
    - \int_0^x f\left(\dfrac{s-x}{2c},\dfrac{s+x}{2}\right) \deriv s
    \Big) .
  \end{align}

  Les fonctions $F$ et $G$ correspondent \`a des constantes d'int\'egration
  (chacune par rapport \`a une variable diff\'erente).
  On peut donc imposer la valeur de leur constante avec la relation $F(0) = G(0)$.
  En combinant les relations \eqref{eq:proof_DAlembert_u0}
  et \eqref{eq:proof_DAlembert_u1}, on peut montrer que
  \begin{align*}
    F(x) &= \dfrac{u_0(x)}{2} + \int_{0}^{x} \dfrac{u_1(s)}{2c} \deriv s
    + \dfrac{1}{8c^2} \Big(
    \int_0^x \!\!\!\int_0^x f\left(\dfrac{s-r}{2c} , \dfrac{s+r}{2} \right) \deriv s \deriv r
    + \int_0^x \!\!\!\int_0^s f\left(\dfrac{s-r}{2c} , \dfrac{s+r}{2} \right) \deriv r \deriv s
    \\
    & \qquad \qquad \qquad \qquad \qquad \qquad \qquad 
      - \int_0^x \!\!\!\int_0^r f\left(\dfrac{s-r}{2c} , \dfrac{s+r}{2} \right) \deriv s \deriv r
    \Big) ,
    \\
    G(x) &= \dfrac{u_0(x)}{2} - \int_{0}^{x} \dfrac{u_1(s)}{2c} \deriv s
    + \dfrac{1}{8c^2} \Big(
    \int_0^x \!\!\!\int_0^x f\left(\dfrac{s-r}{2c} , \dfrac{s+r}{2} \right) \deriv s \deriv r
    - \int_0^x \!\!\!\int_0^s f\left(\dfrac{s-r}{2c} , \dfrac{s+r}{2} \right) \deriv r \deriv s
    \\
    & \qquad \qquad \qquad \qquad \qquad \qquad \qquad 
      + \int_0^x \!\!\!\int_0^r f\left(\dfrac{s-r}{2c} , \dfrac{s+r}{2} \right) \deriv s \deriv r
    \Big) .
  \end{align*}
  On peut maintenant simplifier les int\'egrales pour obtenir
  \begin{align*}
    F(x) &= \dfrac{u_0(x)}{2} + \int_{0}^{x} \dfrac{u_1(s)}{2c} \deriv s
           + \dfrac{1}{4c^2} 
           \int_0^x \!\!\!\int_0^s f\left(\dfrac{s-r}{2c} , \dfrac{s+r}{2} \right)
           \deriv r \deriv s ,
    \\
    G(x) &= \dfrac{u_0(x)}{2} - \int_{0}^{x} \dfrac{u_1(s)}{2c} \deriv s
           + \dfrac{1}{4c^2}
           \int_0^x \!\!\!\int_0^r f\left(\dfrac{s-r}{2c} , \dfrac{s+r}{2} \right) \deriv s \deriv r .
  \end{align*}
  On peut maintenant injecter $F(x)$ et $G(x)$ dans l'expression de $u(t,x)$.
  Apr\`es simplification des int\'egrales, on obtient
  \begin{align*}
    u(t,x) = \dfrac{u_0(x+ct) + u_0(x-ct)}{2} + \dfrac{1}{2c} \int_{x-ct}^{x+ct} u_1(s) \deriv s
    + \dfrac{1}{4c^2} \int_{x-ct}^{x+ct} \int_{x-ct}^{s} f\left(\dfrac{s-r}{2c} , \dfrac{s+r}{2}\right)
    \deriv r \deriv s .
  \end{align*}

  On termine cette preuve en remaniant le dernier terme par les changements de variables
  $\tilde{t} = \dfrac{s-r}{2c}$ et $\tilde{x} = s - c \tilde{t}$.

  !! PEUT-ON SUPPOSER QUE $F$ et $G$ sont d\'erivables ??
  -- RAPPELER QU'ON EST DANS UNE PREUVE PAR ANALYSE--SYNTHESE !!

  !! FAIRE A UN MOMENT UNE REMARQUE SUR LA REGULARITE DE $f$
  QUI PERMET D'UTILISER FUBINI !!
\end{proof}


\begin{remark}[Forme de la solution]
  Pour $f=0$, on a $u(t,x) = F(x+ct) + G(x-ct)$.
  Sans terme source, la solution correspond donc \`a une onde se d\'epla\c{c}ant vers la gauche
  (terme $F(x+ct)$) et une onde se d\'epla\c{c}ant vers la droite (terme $G(x-ct)$), les deux
  \`a vitesse constante $c$.
  En fait, m\^eme dans le cas d'un domaine born\'e, comme $\Omega = (0,1)$,
  la solution peut se mettre sous cette forme tant que l'onde ne touche pas les bords du domaine
  (car alors des interactions plus compliqu\'ees apparaissent).
  On peut voir ici que l'\'equation des ondes se comporte (un peu)
  comme deux \'equation de transport.
  On peut pousser cette similitude en montrant l'\'ecriture
  $\partial_t^2 - c^2 \partial_x^2 = (\partial_t - c \partial_x)(\partial_t + c \partial_x)$.
  Notons \'egalement que la preuve pr\'ec\'edente peut \^etre vue
  comme une m\'ethode des caract\'eristiques o\`u on s'est int\'eress\'e aux droites
  $x-ct = a$ et $x+ct = b$ (pour $a$ et $b$ fix\'es) en introduisant les changements de variables
  $y = x+ct$ et $z = x-ct$.
\end{remark}

\begin{remark}[Propagation de l'information \`a vitesse finie]
  Une cons\'equence de la remarque pr\'ec\'edente est que l'information se d\'eplace dans les
  deux directions $+x$ et $-x$ \`a vitesse constante $c$.
  On a donc un comportement diff\'erent de celui de l'\'equation de la chaleur pour laquelle
  l'information se d\'eplace \`a vitesse infinie.
\end{remark}

!! Commenter la m\'ethode des caract\'eristiques avec un sch\'ema !! + domaine d'influence
+ domaine de d\'ependance !!

!! Illustrer le cas $f= 0$ et $u_1 = 0$ avec un sch\'ema !! + cas domaine born\'e
+ p\'eriodicit\'e de la sol !!
(on peut aussi remplacer le sch\'ema par des r\'esultats de simulation, c'est plus int\'eressant)

\begin{exercise}
  On suppose que $f = 0$.
  Retrouver le r\'esultat du Th\'eor\`eme~\ref{thm:d_Alembert}
  en utilisant la m\'ethode de la transform\'ee de Fourier comme dans
  la Section~\ref{subsubsec:chaleur_R}.
\end{exercise}

!! V\'erifier que cet exo est faisable !!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Principales propri\'et\'es des solutions}

On se place dans $\Omega = (0,1)$.
On d\'efinit l'\'energie du syst\`eme
\begin{align*}
  E(t) := \frac12 \int_0^1 \left( \frac{\partial u}{\partial t} \right)^2 \deriv x
  + \frac{c^2}{2} \int_0^1 \left( \frac{\partial u}{\partial x} \right)^2 \deriv x
  = \frac12 \| \partial_t u (t,.)\|_{L^2(0,1)}^2 + \frac{c^2}2 \| \partial_x u (t,.)\|_{L^2(0,1)}^2.
\end{align*}
Nous rappelons que l'\'equation des ondes peut repr\'esenter un mouvement de corde.
Le premier terme correspond alors \`a l'\'energie cin\'etique de la corde
et le second \`a  l'\'energie potentielle associ\'ee \`a la force de tension de la corde.
Nous montrons que la d\'eriv\'ee de l'\'energie m\'ecanique totale $E(t)$ est \'egale
\`a la puissance des efforts ext\'erieurs $f$.
En particulier, sans effort ext\'erieur cette \'energie se conserve.
On peut aussi borner cette \'energie.

\begin{proposition}[Conservation et borne de l'\'energie]
  \label{prop:ondes_donnees}
  Si $u \in H^1(0,T;L^2(0,1)) \cap L^2(0,T;H^1_0(0,1))$ est une solution de~\eqref{eq:ondes_Dir},
  alors pour presque tout $t \in (0,T)$
  on a 
  \begin{align*}
    E'(t) = \int_0^1 f \partial_t u \deriv x .
  \end{align*}
  On peut de plus montrer que pour presque tout $t \in (0,T)$
  \begin{align}
    \label{eq:energy}
    E(t) \leq E(0) e^T
    + \frac{1}{2} \int_0^T \left[ \int_0^1 (f(s,x))^2 \deriv x \right] e^{T-s} \deriv s.
  \end{align}
\end{proposition}


\begin{proof}
  En multipliant l'\'equation de la chaleur par $\dfrac{\partial u}{\partial t}$
  et en int\'egrant sur $(0,1)$, on obtient
  \begin{align*}
    \int_0^1 f \partial_t u \deriv x
    &=
    \int_0^1 \dfrac{\partial^2 u}{\partial t^2} \dfrac{\partial u}{\partial t} \deriv x
    - c^2 
    \int_0^1 \dfrac{\partial u}{\partial t} \dfrac{\partial^2 u}{\partial x^2} \deriv x
    \\
    &=
    \int_0^1 \dfrac{\partial^2 u}{\partial t^2} \dfrac{\partial u}{\partial t} \deriv x
    + c^2 
    \int_0^1 \dfrac{\partial^2 u}{\partial x \partial t} \dfrac{\partial u}{\partial x} \deriv x
    = E'(t) .
  \end{align*}
  Notons qu'on a utilis\'e $\partial_t u(t,0) = \partial_t u(t,1)$ pour int\'egrer par parties.

  En utilisant les in\'egalit\'es de Cauchy--Schwarz et de Young, on obtient
  \begin{align*}
    | E'(t) |
    &\leq \| f(t,.) \|_{L^2(0,1)} \| \partial_t u(t,.) \|_{L^2(0,1)}
    \\
    &\leq \| f(t,.) \|_{L^2(0,1)}^2 +  \| \partial_t u(t,.) \|_{L^2(0,1)}^2
    \\
    &\leq \| f(t,.) \|_{L^2(0,1)}^2 +  E(t) .
  \end{align*}

  Pour rappel, le Lemme de Gr\"onwall nous dit que si une fonction $\eta$ v\'erifie
  $\eta'(t) \leq \phi(t) \eta(t) + \psi(t)$ alors on a
  $\eta(t) \leq \exp(\int_0^t \phi(s) \deriv s) \eta(0)
  + \int_0^t \exp(\int_s^t \phi(u) \deriv u) \psi(s) \deriv s$.

  !! Verifier le lemme de Gronwall + donner ses hypotheses precises !!

  On obtient le r\'esultat en appliquant le Lemme de Gr\"onwall
  ($\phi = 1$ et $\psi = \| f \|^2_{L^2(0,1)}$).
\end{proof}

On peut maintenant utiliser ce r\'esultat sur l'\'energie pour montrer
que le probl\`eme des ondes avec conditions de Dirichlet est bien pos\'e.

\begin{proposition}[Caract\`ere bien pos\'e du probl\`eme]
  \label{prop:ondes_bien_pose}
  Pour $u_0 \in H_0^1(\Omega)$, $u_1 \in L^2(\Omega)$ et $f \in L^2(0,T;L^2(\Omega))$,
  la probl\`eme~\eqref{eq:ondes_Dir} admet une unique solution $u$
  dans $H^1(0,T;L^2(\Omega)) \cap L^2(0,T;H^1_0(\Omega))$.
  De plus, il existe une constante $C > 0$ (ind\'ependante de $u$, $u_0$, $u_1$ et $f$)
  telle que
  \begin{align}
    \label{eq:ondes_donnees}
    \| u \|_{H^1(0,T;L^2(\Omega))} + \| u \|_{L^2(0,T;H^1_0(\Omega))}
    \leq C (\| u_0 \|_{H^1_0(\Omega)} + \| u_1 \|_{L^2(\Omega)} + \| f \|_{L^2(0,T;L^2(\Omega))}) .
  \end{align}

  !! Est-ce qu'il s'agit des normes ou bien plutôt des semi-normes \`a gauche ??
\end{proposition}

\begin{proof}
  L'existence utilise une analyse similaire \`a celle de la Section~\ref{subsubsec:ondes_01},
  mais dans un cadre plus g\'en\'eral au sens des distributions.
  On ne la d\'eveloppera pas ici.

  L'unicit\'e est une cons\'equence de la lin\'earit\'e du probl\`eme et
  de la d\'ependance aux donn\'ees (consid\'erer la diff\'erence entre deux solutions).

  Il reste \`a prouver l'in\'egalit\'e~\eqref{eq:ondes_donnees}.
  On part de l'in\'egalit\'e~\eqref{eq:energy}.
  On a ainsi
  \begin{align*}
    \| u \|_{H^1(0,T; L^2(\Omega))}^2 + \| u \|_{L^2(0,T; H^1_0(\Omega))}^2
    &\leq 2\max(1,c^{-2}) \int_0^T E(t) \deriv t
    \\
    &\leq 2\max(1,c^{-2}) e^T T (E(0) + \| f \|_{L^2(0,T; L^2(\Omega))}^2) .
  \end{align*}
  De plus, $E(0) \leq \frac12 \max(1,c) (\| u_0 \|_{H^1_0(\Omega)}^2 + \| u_1 \|_{L^2(\Omega)}^2)$.
  On conclut avec l'in\'egalit\'e de Young.

  !! V\'erifier que l'on peut prouver l'existence ainsi ...
\end{proof}


On s'int\'eresse maintenant \`a la r\'eversibilit\'e de l'\'equation des ondes.
Pour $u$ une solution de~\eqref{eq:ondes_Dir}, on pose $\tu(t,x) := u(T-t, x)$.
La fonction $\tu$ v\'erifie le probl\`eme r\'etrograde
\begin{align}
  \nonumber
  \dfrac{\partial^2 \tu}{\partial t^2} - c^2 \dfrac{\partial^2 \tu}{\partial x^2} = \tf 
  &\dans (0,T) \times (0,1) ,
  \\
  \label{eq:ondes_retro}
  \tu(0,\cdot) = u(T,\cdot) 
  & \dans (0,1) ,
  \\
  \nonumber
  \dfrac{\partial \tu}{\partial t}(0,\cdot) = - \dfrac{\partial u}{\partial t}(T,\cdot) 
  & \dans (0,1) ,
  \\
  \nonumber
  \tu(t,0) = 0 , \quad \tu(t,1) = 0 
  \quad& \;\; \forall t \in (0,T) ,
\end{align}
avec $\tf(t,x) := f(T-t, x)$.
Il s'agit du probl\`eme~\eqref{eq:ondes_Dir} avec des donn\'ees diff\'erentes.
Ce probl\`eme est donc bien pos\'e d'apr\`es la Proposition~\ref{prop:ondes_bien_pose}.
L'\'equation des ondes est donc r\'eversible.

\begin{proposition}[R\'eversibilit\'e de l'\'equation des ondes]
  L'\'equation des ondes est r\'eversible : le probl\`eme r\'etrograde~\eqref{eq:ondes_retro}
  est bien pos\'e.
\end{proposition}
Ceci signifie que retrouver la solution initiale \`a partir des donn\'ees
finales n'est pas particuli\`erement difficile pour cette \'equation.


\begin{remark}[Conditions de Dirichlet non homog\`enes]
  On peut g\'erer des conditions de Dirichlet non homog\`enes par un rel\`evement
  (voir la m\^eme remarque pour l'\'equation de Poisson et l'\'equation de la chaleur).
\end{remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Approximation par diff\'erences finies}

!! Est-ce qu'on ne se concentre pas sur le sch\'ema explicite centr\'e ??

Nous \'etudions dans cette section diff\'erents sch\'emas pour approcher la solution
de l'\'equation.
La discr\'etisation la plus naturelle que l'on puisse imaginer
consiste \`a approcher les d\'eriv\'ees d'ordre deux par des approximations centr\'ees.
On utilise donc les approximations :
\begin{align*}
  \dfrac{\partial^2 u}{\partial t^2}(t_n,x_j) \simeq 
  \dfrac{u(t_{n+1},x_j) - 2 u(t_n,x_j) + u(t_{n-1},x_j)}{h_t^2} ,
  \\
  \dfrac{\partial^2 u}{\partial x^2}(t_n,x_j) \simeq 
  \dfrac{u(t_n,x_{j+1}) - 2 u(t_n,x_{j}) + u(t_n,x_{j-1})}{h_x^2} .
\end{align*}
On obtient ainsi le sch\'ema explicite suivant:
\begin{align*}
  \forall 1 \leq n \leq N, \;\;\; \forall 0 \leq j \leq M, \;\;\;
  u_j^{n+1} = 2 u_j^{n} - u_j^{n-1} + \dfrac{c^2 h_t^2}{h_x^2} (u_{j+1}^{n} - 2 u_{j}^{n}+u_{j-1}^{n})
  + h_t^2 f(t_n, x_j) .
\end{align*}
Ce sch\'ema est \`a deux pas de temps.
C'est-\`a-dire que si on introduit un vecteur $U^n$ repr\'esentant les $u_j^n$, 
pour calculer $U^{n+1}$, il faut $U^n$ et $U^{n-1}$.
Pour pouvoir calculer les $U^n$ pour tout $n \geq 0$, il faut donc
initialiser les deux premiers termes de la suite.
Comme d'habitude, on initialise le premier pas de temps avec les conditions initiales.
En plus de cela, il faut aussi initialiser le second pas de temps qu'on prendra comme
$U^{1} = U^0 + h_t V_0$ avec $V_0$ le vecteur des vitesses initiales.
Cela signifie que l'on consid\`ere qu'au cours du premier pas de temps,
la solution a \'et\'e modifi\'ee par la seule action de la vitesse initiale.
Il s'agit d'une mani\`ere de proc\'eder qui est classique.
On obtient donc le sch\'ema suivant
\begin{align}
  \label{eq:ondes_DF_exp}
  \left\{
  \begin{array}{l}
    \forall 1 \leq n \leq N, \;\;\; \forall 0 \leq j \leq M, \;\;\;
    u_j^{n+1} = 2 u_j^{n} - u_j^{n-1} + \dfrac{c^2 h_t^2}{h_x^2} (u_{j+1}^{n} - 2 u_{j}^{n}+u_{j-1}^{n})
    + h_t^2 f(t_n, x_j) ,
    \\
    \forall 0 \leq n \leq N , \quad
    u_0^n = u_M^n = 0 ,
    \\
    \forall 1 \leq j \leq M-1 ,  \quad
    u_j^0 = u_0(x_j) \quad \text{et} \quad u_j^1 = u_0(x_j) + h_t u_1(x_j) ,
  \end{array}
  \right.
\end{align}
o\`u $u_0$ et $u_1$ sont les donn\'ees initiales du probl\`eme
en position et en vitesse.


\begin{exercise}
  La figure (...) a \'et\'e obtenue avec le sch\'ema \eqref{eq:ondes_DF_exp}
  pour les donn\'ees (...).
  Coder ce sch\'ema et retrouver la figure.

  !! RETROUVER LES PARAMETRES DE CETTE FIGURE !!
\end{exercise}


!! Completer cette remarque !!
\begin{remark}
  Notons que la d\'eriv\'ee seconde pr\'esente dans l'\'equation des ondes 
  rend tr\`es naturel le recours \`a un sch\'ema \`a deux pas de temps.
  Ce type de sch\'ema peut aussi \^etre utilis\'e pour les \'equations vues
  pr\'ec\'edemment (voir sch\'ema saute-mouton).
  On peut aussi envisager d'utiliser un sch\'ema \`a un pas de temps
  pour r\'esoudre l'\'equation des ondes (voir ...).
\end{remark}

Sous forme matricielle, on peut \'ecrire ce sch\'ema comme
\begin{align*}
  U^{n+1}
  &= (2 I - c^2 h_t^2 A_{\Delta}) U^n - U^{n-1} + h_t^2 F^n ,
  &\qquad 1 \leq n \leq N-1 ,
  \\
  (U^0)_j
  &= u_0(x_j) ,
  & \qquad 1 \leq j \leq M-1 ,
  \\
  (U^1)_j
  &= u_0(x_j) + h_t u_1(x_j) ,
  & \qquad 1 \leq j \leq M-1 ,
\end{align*}
avec $I$ la matrice identit\'e, $A_{\Delta}$ la matrice de Laplacien--Dirichlet d\'efinie
en~\eqref{eq:mat_DF_Laplacien}, $U^n$ le vecteur d'\'etat d\'efini
par $U_j^n := u_j^n$ et $F^n$ le second membre d\'efini par $F_j^n := f(t_n,x_j)$.

!! La matrice de Laplacien est d\'efinie avec des $h$ au lieu de $h_x$, voir comment adapter cela !!

Cette \'ecriture du sch\'ema ne permet pas d'exploiter
le cadre de la Section~\ref{subsubsec:analyse_def} (comparer avec~\eqref{eq:schema_1pas}).
On va essayer d'\'ecrire ce m\^eme sch\'ema sous une autre forme qui va permettre
de se replacer dans le cadre des sch\'emas \`a un pas.
Pour cela, introduisons la variable
\begin{align*}
  \Theta^n :=
  \begin{pmatrix}
    V^n \\ U^n
  \end{pmatrix}
  :=
  \begin{pmatrix}
    U^{n-1} \\ U^n
  \end{pmatrix} .
\end{align*}
Cette variable v\'erifie le probl\`eme suivant
\begin{align*}
  \Theta^{n+1} = \hat{A} \Theta^n + h_t^2 \hat{F}^n , \qquad 1 \leq n \leq N ,
\end{align*}
avec
\begin{align*}
  \hat{A} :=
  \begin{pmatrix}
    0
    & I
    \\
    - I
    & 2 I - c^2 h_t^2 A_{\Delta}
  \end{pmatrix} ,
  \qquad \qquad
  \hat{F}^n :=
  \begin{pmatrix}
    0 \\ F^n
  \end{pmatrix} .
\end{align*}
On s'est donc ramen\'es au cadre des sch\'emas \`a un pas.
La seule diff\'erence avec~\eqref{eq:schema_1pas}
est qu'il y a un $h_t^2$ au lieu d'un $h_t$ devant $\hat{F}$.
Notons que le second membre n'influence pas la stabilit\'e
(on peut donc prouver la stabilit\'e du sch\'ema en se pla\c{c}ant
dans le cadre de la Section~\ref{subsubsec:analyse_def}).
Pour la consistance, par contre, il faudra adapter.


\begin{remark}
  Notons que cette 'astuce' d'introduire une nouvelle variable est classique dans le cadre des EDO.
  Par exemple, on ne peut pas utiliser directement le th\'eor\`eme de Cauchy--Lipschitz
  sur l'\'equation $\partial_{t}^2 u - A u = 0$ (avec des donn\'ees de Cauchy adapt\'ees)
  du fait de la d\'eriv\'ee seconde en temps. Par contre, on y arrivera sur l'\'equation
  satisfaite par la variable
  interm\'ediaire $v := \begin{pmatrix} u \\ \partial_t u \end{pmatrix}$.
  On pourra ensuite en d\'eduire des propri\'et\'es de $u$.
\end{remark}

Nous prouvons maintenant la stabilit\'e du sch\'ema explicite centr\'e
pour la norme $\| \cdot \|_{L^2}$.
Nous allons donc calculer les valeurs propres de $\hat{A}$ et s'assurer qu'elles sont toutes
de module inf\'erieur ou \'egal \`a un.
On consid\`ere $\lambda \in \C \setminus \{ 0 \}$ et on calcule
\begin{align*}
  \left|
  \hat{A} - \lambda I
  \right|
  &=
  \left|
  \begin{array}{c c}
    - \lambda I
    & I
    \\
    - I
    & (2-\lambda) I - c^2 h_t^2 A_{\Delta}
  \end{array}
  \right|
  \\
  &=
  \left|
  \begin{array}{c c}
    - \lambda I
    & 0
    \\
    - I
    & (2-\lambda - \frac{1}{\lambda}) I - c^2 h_t^2 A_{\Delta}
  \end{array}
  \right|
  \\
  &= (-\lambda)^{M-1}
  \left|
    (2-\lambda - \frac{1}{\lambda}) I - c^2 h_t^2 A_{\Delta}
  \right| .
\end{align*}
On note $\mu_j$ les valeurs propres de la matrice $2I - c^2h_t^2 A_{\Delta}$, c'est-\`a-dire
$| (2-\mu) I - c^2 h_t^2 A_{\Delta} | = \prod_{j=1}^{M-1} (\mu_j - \mu)$.
On a donc
$|\hat{A} - \lambda I| = (-\lambda)^{M-1} \prod_{j=1}^{M-1} (\mu_j - \lambda - \frac{1}{\lambda})
= \prod_{j=1}^{M-1} (\lambda^2 - \mu_j \lambda + 1)$.
Le polyn\^ome caract\'eristique \'etant continu, cette expression
est valable \'egalement pour $\lambda = 0$.
Les valeurs propres de la matrice $\hat{A}$ sont donc les racines des polyn\^omes
$\lambda^2 - \mu_j \lambda + 1$ (il faut consid\'erer tous les $j$ dans $<1,M-1>$).
Le discriminant de ce polyn\^ome vaut $\Delta_j = \mu_j^2 - 4$.
On rappelle que le sch\'ema est stable pour la norme $\| \cdot \|_{L^2}$
si et seulement si toutes les valeurs propres sont de module inf\'erieur ou \'egal \`a un.


$\bullet$ S'il y a un $j$ tel que $\mu_j^2 > 4$, alors on a deux valeurs propres r\'eelles
qui v\'erifient $\lambda_1 \lambda_2 = 1$ et $\lambda_1 \neq \lambda_2$.
Donc soit $\lambda_1 > 1$ ou soit $\lambda_2 > 1$ et dans les deux cas le sch\'ema n'est pas stable.

$\bullet$ Pour $j$ tel que $\mu_j^2 = 4$, on a une valeur propre double qui vaut $1$
et ce $j$ n'emp\^eche pas le sch\'ema d'\^etre stable.

$\bullet$ Pour $j$ tel que $\mu_j^2 < 4$, on a deux valeurs propres conjugu\'ees qui v\'erifient
$|\lambda_1| = |\lambda_2| = 1$
et ce $j$ n'emp\^eche pas le sch\'ema d'\^etre stable.


Une condition n\'ecessaire et suffisante pour que le sch\'ema soit stable
pour la norme $\| \cdot \|_{L^2}$ est donc d'avoir
$-2 \leq \mu_j \leq 2$ pour tout $j \in <1,M-1>$.

On remarque que la matrice $2I - c^2 h_t^2 A_{\Delta}$ est de la forme des matrices \'etudi\'ees
dans la Proposition~\ref{prop:VP} avec $a = 2 - \frac{2 c^2 h_t^2}{h_x^2}$
et $b=\frac{c^2 h_t^2}{h_x^2}$.
On peut donc calculer
\begin{align*}
  \mu_j = a + 2b \cos\left(\frac{j \pi}{M}\right)
  = 2 - 2 \alpha^2 \left(1 - \cos\left(\frac{j\pi}{M}\right)\right) ,
\end{align*}
avec $\alpha = \dfrac{c h_t}{h_x}$.

On remarque que la condition $\mu_j \leq 2$ est acquise.
La condition $-2 \leq \mu_j$ (pour tout $j \in <1,M-1>$)
est valable si et seulement si $\alpha \leq 1$.

Le sch\'ema est donc stable pour la norme $\| \cdot \|_{L^2}$ si et seulement si
la condition de CFL suivante est v\'erifi\'ee
\begin{align*}
  \alpha = \dfrac{c h_t}{h_x} \leq 1 .
\end{align*}


!! Ajouter une remarque sur la CFL : comparaison avec l'\'equation de transport,
donner un sens physique \`a cette condition de CFL, \'etendre ce sens au cas parabolique !!

!! Faire la consistance de mani\`ere propre (r\'egler le probl\`eme du $h_t^2$) !!

!! Eclaircir la subtilit\'e de la condition initiale (voir notes papier ou cours ENSTA) !!

!! Creuser la diff\'erence Von Neumann vs transform\'ee de Fourier discr\`ete !!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\'Etude du probl\`eme de Neumann}


!! faire d'autres conditions limites (Neumann) ??

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Pour aller plus loin}

!! Ecrire tous les exercices au fur et \`a mesure et les reporter
dans une section \`a la fin du poly !!


!! les elements de cette section sont hors-programme mais ne sont pas 
d\'econnect\'es de celui-ci au sens o\`u ils peuvent \^etre utilis\'es 
dans un texte (ils seront alors pr\'esent\'es) !!
!! Ne travailler cette section qu'une fois que les autres sont parfaitement maitris\'ees !!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\'Equation de transport dans un domaine multi-dimensionnel}
\label{subsec:transport_multiD}



!! Ajouter une annexe sur les EDO + y faire reference 
dans la premiere section d'analyse numerique !!


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\'Equation de Burgers}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Recherche de solutions faibles \`a l'\'equation de la chaleur}
\label{subsec:chal_sol_faibles}

!! AJOUTER UN CHAPEAU A CETTE SECTION !!


Cette section constitue une preuve \`a la proposition
\ref{prop:chal_sol_faibles}.
On cherche une solution faible \`a l'\'equation de la chaleur.
Cela signifie que pour presque tout $t \in (0,T)$,
on consid\`ere les termes de l'\'egalit\'e
$\dfrac{\partial u}{\partial t}(t,\cdot) 
- \dfrac{\partial^2 u}{\partial x^2}(t,\cdot) = f(t,\cdot)$
comme des \'el\'ements de $H^{-1}(\Omega)$.
On cherche donc une solution $u$ qui v\'erifie
\begin{align}
  \label{eq:chal_vari}
  \forall v \in H^1_0(\Omega) ,  \quad
  \dfrac{\deriv}{\deriv t} \int_{\Omega} u(t,x) v(x) \deriv x
  + \int_{\Omega} \dfrac{\partial u}{\partial x}(t,x) \dfrac{\partial v}{\partial x}(x) \deriv x
  = \int_{\Omega} f(t,x) v(x) \deriv x .
\end{align}

!! Est-ce qu'on peut prouver l'unicit\'e de la solution dans un espace particulier ??
(pas juste dans l'espace des solutions de cette forme)
---- On a l'unicit\'e avec la Proposition de stabilit\'e !!
---- Il suffit juste de sp\'eficier la r\'egularit\'e de cette solution particuli\`ere !!



Cette d\'emonstration est issue du livre de B. Lucquin.
On note $\Omega = (0,1)$.

$\bullet$ Recherche d'une solution :
on note $\calA$ l'op\'erateur $-\Delta$ sur $H^1_0(\Omega)$,
on peut le d\'efinir comme
\begin{align*}
  \forall v,w \in H_0^1(\Omega) , \quad  \int_{\Omega} \calA(v) w \deriv x
  := \int_{\Omega} v'(x) w'(x) \deriv x .
\end{align*}
On utilise une base orthogonale de fonctions propres de l'op\'erateur $\calA$.
On note $w_k(x) = \sqrt{2} \sin(k \pi x)$ et $\lambda_k = (k\pi)^2$.
On peut montrer que l'on a
\begin{align*}
  \forall v \in H_0^1(\Omega) , \quad
  \int_{\Omega} \calA(w_k) v \deriv x 
  = \int_{\Omega} w_k'(x) v'(x) \deriv x = \lambda_k \int_{\Omega} w_k(x) v(x) \deriv x .
\end{align*}
En ce sens, pour $k \geq 1$, la fonction $w_k$ est un vecteur propre de $\calA$
associ\'e \`a la valeur propre $\lambda_k$.
Nous allons maintenant chercher une solution $u$ au probl\`eme \eqref{eq:chaleur_Dir}
sous la forme
\begin{align}
  \label{eq:chal_faible}
  u(t,x) = \sum_{\ell = 1}^{+\infty} u_{\ell} (t) w_{\ell} (x) ,
\end{align}
avec pour $\ell \geq 1$, $u_{\ell}$ une fonction \`a d\'eterminer.

Les fonctions $w_k$ v\'erifient $\int_{\Omega} w_k (x) w_{\ell}(x) \deriv x = \delta_{k \ell}$
o\`u $\delta_{k\ell}$ repr\'esente le symbole de Kronecker (fa\^ites ce calcul).

En cherchant $u$ sous la forme \eqref{eq:chal_faible} et en prenant $v = w_k$
dans \eqref{eq:chal_vari}, on obtient
pour tout $k \geq 1$, $u_k'(t) + \lambda_k u_k(t) = \int_{\Omega} f(t,x) w_k(x) \deriv x$.
La condition initiale donne $u_k(0) = \int_{\Omega} u_0(x) w_k(x) \deriv x$.
Les fonctions $u_k$ v\'erifient donc 
\begin{align}
  \label{eq:chal_faible_sol}
  \forall t \in [0,T] , \quad u_k(t) = \int_{\Omega} u_0(x) w_k(x) \deriv x e^{- \lambda_k t}
  + \int_{0}^t \int_{\Omega} f(s,x) w_k(x) \deriv x e^{- \lambda_k (t-s)} \deriv s .
\end{align}

Il faut maintenant montrer que la s\'erie de fonctions \eqref{eq:chal_faible}
d\'efinie \`a partir de \eqref{eq:chal_faible_sol} converge
dans les espaces $C^0([0,T];L^2(0,1))$ et $L^2(0,T;H^1_0(0,1))$.
Pour cela, nous allons consid\'erer la suite 
$(u^{(n)})_n$ avec $u^{(n)}(t,x) = \sum_{\ell=1}^n u_{\ell}(t) w_{\ell}(x)$. 
Ces deux espaces \'etant dans des espaces de Hilbert,
nous allons montrer que cette suite est de Cauchy dans chacun de ces espaces.

$\bullet$ Convergence dans l'espace $C^0([0,T];L^2(0,1))$ :
en utilisant l'orthogonalit\'e des $w_k$, nous avons pour $0 \leq m \leq n$,
\begin{align*}
  \| u^{(n)}(t,\cdot) - u^{(m)}(t,\cdot) \|_{L^2(0,1)}^2
  &= \| \sum_{\ell = m+1}^n u_{\ell}(t) w_{\ell} \|_{L^2(0,1)}^2
  = \sum_{k,\ell = m+1}^n u_{\ell}(t) u_{k}(t) (w_{\ell} , w_{k})_{L^2(0,1)}
  \\
  &= \sum_{k,\ell = m+1}^n u_{\ell}(t) u_{k}(t) \delta_{k \ell}
  = \sum_{\ell = m+1}^n (u_{\ell}(t))^2 .
\end{align*}
On note 
\begin{align*}
  a_k (t) = (u_0 , w_k)_{L^2(0,1)} e^{- \lambda_k t} , \qquad
  b_k(t) = \int_{0}^{t} (f(s,.),w_k)_{L^2(0,1)} e^{-\lambda_k(t-s)} \deriv s .
\end{align*}
En utilisant \eqref{eq:chal_faible_sol} et l'in\'egalit\'e de Young,
on a $(u_{k}(t))^2 = (a_k(t) + b_k(t))^2 \leq 2 (a_k(t)^2 + b_k(t)^2)$.
Ainsi,
\begin{align*}
  \| u^{(n)}(t,\cdot) - u^{(m)}(t,\cdot) \|_{L^2(0,1)}^2
  \leq 2(A_{n,m}(t) + B_{n,m}(t)) ,
\end{align*}
avec 
\begin{align*}
  A_{n,m}(t) = \sum_{\ell=m+1}^n (a_{\ell}(t))^2 , \qquad
  B_{n,m}(t) = \sum_{\ell=m+1}^n (b_{\ell}(t))^2 .
\end{align*}

Pour $t \geq 0$, on a $A_{n,m}(t) \leq \sum_{\ell = m+1}^n (u_0 , w_{\ell})_{L^2(0,1)}^2$.
\'Etant donn\'e que les $w_k$ forment une base hilbertienne de $L^2(0,1)$ et que
$u_0 \in L^2(0,1)$, on a $u_0 = \sum_{\ell = 1}^{+\infty} ( u_0, w_{\ell})_{L^2(0,1)} w_{\ell}$
et avec l'\'egalit\'e de Parseval, 
on a $\| u_0 \|_{L^2(0,1)}^2 = \sum_{\ell = 1}^{+\infty} ( u_0, w_{\ell})_{L^2(0,1)}^2$.
La s\'erie de terme g\'en\'eral $( u_0, w_{\ell})_{L^2(0,1)}^2$ converge donc
et on a $\sup_{t \in [0,T]} |A_{n,m}(t)| \to 0$ quand $n$ et $m \to +\infty$.


!! VERIFIER QU'ON A BIEN UNE BASE HILBERTIENNE DANS $L^2$ \underline{ET} $H^1_0$ !! 
--- FAIRE UN POINT SUR TOUTES LES PROPRIETES DE CETTE BASE !!

Montrons maintenant le m\^eme r\'esultat sur $B_{n,m}(t)$.
On a 
\begin{align*}
  \Big( \int_0^t (f(s,\cdot) , w_k)_{L^2(0,1)} e^{- \lambda_k (t-s)} \deriv s \Big)^2
  & \leq \Big( \int_0^t (f(s,\cdot) , w_k)_{L^2(0,1)}^2\deriv s \Big)
  \Big( \int_0^t e^{- 2 \lambda_k (t-s)} \deriv s \Big)
  \\
  & \leq \dfrac{1}{2 \lambda_k} \Big( \int_0^t (f(s,\cdot) , w_k)_{L^2(0,1)}^2\deriv s \Big)
  \\
  & \leq \dfrac{1}{2 \pi^2} \Big( \int_0^T (f(s,\cdot) , w_k)_{L^2(0,1)}^2\deriv s \Big) ,
\end{align*}
o\`u on a utilis\'e l'in\'egalit\'e de Cauchy--Schwarz et $\lambda_k = k^2 \pi^2 \geq \pi^2$.
De plus, comme $f \in L^2(0,T;L^2(0,1))$, pour presque tout $s \in [0,T]$,
$f(s,\cdot)$ appartient \`a $L^2(0,1)$. D'apr\`es l'\'egalit\'e de Parseval,
pour presque tout $s \in [0,T]$, 
$\| f(s,\cdot) \|_{L^2(0,1)}^2 = \sum_{\ell=1}^{+\infty} (f(s,\cdot) , w_{\ell})_{L^2(0,1)}^2$.
Ainsi, $\| f \|_{L^2(0,T;L^2(0,1))}^2 
= \int_0^T \sum_{\ell=1}^{+\infty} (f(s,\cdot) , w_{\ell})_{L^2(0,1)}^2 \deriv s$.

On peut donc montrer que la s\'erie de terme g\'en\'eral 
$\int_0^T (f(s,\cdot) , w_k)_{L^2(0,1)}^2\deriv s$ converge
(en \'etant born\'ee par $\| f \|_{L^2(0,T;L^2(0,1))}^2$).
Donc $\sup_{t \in [0,T]} |B_{n,m}(t)| \to 0$ quand $n$ et $m \to + \infty$. 


La suite $(u^{(n)})$ est donc de Cauchy dans $C^0([0,T];L^2(0,1))$
et converge donc.

$\bullet$ Convergence dans l'espace $L^2([0,T];H_0^1(0,1))$ :
La norme 
$|u|_{1,\Omega}^2 = \int_0^1 (u'(x))^2 \deriv x = \calA(u,u)$
est une norme sur $H^1_0(0,1)$ \'equivalente \`a la norme usuelle
(par l'in\'egalit\'e de Poincar\'e, voir (...)).
On a 
\begin{align*}
  | (u^{(n)} - u^{(m)})(s,\cdot)|_{1,\Omega}^2
  &= \calA((u^{(n)} - u^{(m)})(s,\cdot), (u^{(n)} - u^{(m)})(s,\cdot))
  \\
  &= \sum_{k,\ell = m+1}^n u_k(s) u_{\ell}(s) \calA(w_k , w_{\ell})
  \\
  &= \sum_{k,\ell = m+1}^n u_k(s) u_{\ell}(s) \lambda_k \delta_{k \ell}
  = \sum_{k = m+1}^n \lambda_k (u_k(s))^2 .
\end{align*}
On montre donc que 
$| (u^{(n)} - u^{(m)})(s,\cdot)|_{1,\Omega}^2 \leq 2 (C_{n,m}(t) + D_{n,m}(t))$
avec
\begin{align*}
  C_{n,m}(t) := \sum_{\ell=m+1}^n \lambda_{\ell} (a_{\ell}(t))^2 , \qquad
  D_{n,m}(t) := \sum_{\ell=m+1}^n \lambda_{\ell} (b_{\ell}(t))^2 .
\end{align*}

En raisonnant comme pr\'ec\'edemment, on a
\begin{align*}
  \int_0^T \lambda_k e^{-2 \lambda_k s} (u_0 , w_k)_{L^2(\Omega)}^2 \deriv s
  \leq \dfrac{1}{2} (u_0 , w_k)_{L^2(\Omega)}^2 ,
\end{align*}
et la s\'erie de terme g\'en\'eral $(u_0 , w_k)_{L^2(\Omega)}^2$
converge par l'\'egalit\'e de Parseval.
Donc $\int_0^T C_{n,m} (s) \deriv s \to 0$ quand $n$ et $m \to +\infty$.

De la m\^eme fa\c{c}on,
\begin{align*}
  \int_0^T \lambda_k \Big( \int_0^t (f(s,\cdot) , w_k)_{L^2(0,1)} e^{- \lambda_k (t-s)} \deriv s \Big)^2 
  \deriv t
  & \leq 
    \int_0^T \lambda_k \Big( \int_0^t (f(s,\cdot) , w_k)_{L^2(0,1)}^2\deriv s \Big)
  \Big( \int_0^t e^{- 2 \lambda_k (t-s)} \deriv s \Big) \deriv t
  \\
  & \leq \dfrac{1}{2} \int_0^T \Big( \int_0^t (f(s,\cdot) , w_k)_{L^2(0,1)}^2\deriv s \Big) \deriv t
  \\
  & \leq \dfrac{T}{2} \Big( \int_0^T (f(s,\cdot) , w_k)_{L^2(0,1)}^2\deriv s \Big) .
\end{align*}
Comme nous l'avons vu pr\'ec\'edemment, la s\'erie de terme g\'en\'eral 
$\int_0^T (f(s,\cdot) , w_k)_{L^2(0,1)}^2\deriv s$ converge.

Nous avons donc montr\'e que la suite $(u^{(n)})$ est de Cauchy et donc
converge dans $L^2(0,T;H^1_0(0,1))$.


$\bullet$ Solution de l'\'equation :
montrons maintenant que $u$ d\'efinie par \eqref{eq:chal_faible}
avec \eqref{eq:chal_faible_sol} v\'erifie l'\'equation \eqref{eq:chaleur_Dir}
au sens faible (c'est-\`a-dire \eqref{eq:chal_vari}).

Soit $v \in H_0^1(\Omega)$. On note comme pr\'ec\'edemment
$u^{(N)} (t,x) := \sum_{\ell=1}^N u_{\ell}(t) w_{\ell}(x)$.
On a 
\begin{align*}
  \dfrac{\deriv}{\deriv t} ( u^{(N)}(t,\cdot) , v )_{L^2(\Omega)}
  &= \sum_{k=1}^N u_k'(t) (w_k , v )_{L^2(\Omega)}
  \\
  &= \sum_{k=1}^N - \lambda_k (u_0 , w_k)_{L^2(\Omega)} (w_k , v )_{L^2(\Omega)} e^{-\lambda_k t}
    + ( f(t,\cdot) , w_k )_{L^2(\Omega)} ( w_k , v )_{L^2(\Omega)}
  \\
  & \qquad \quad 
    - \lambda_k \int_{0}^t (f(s,\cdot) , w_k)_{L^2(\Omega)} ( w_k , v )_{L^2(\Omega)} 
    e^{-\lambda_k (t-s)} \deriv s
  \\
  &= \sum_{k=1}^N - \Big( (u_0 , w_k)_{L^2(\Omega)} e^{-\lambda_k t} 
    + \int_{0}^t (f(s,\cdot) , w_k)_{L^2(\Omega)} e^{-\lambda_k (t-s)} \deriv s  \Big)
    \calA(w_k , v)
  \\
  & \qquad \quad 
    + ( f(t,\cdot) , w_k )_{L^2(\Omega)} ( w_k , v )_{L^2(\Omega)}
  \\
  &= - \calA(u^{(N)}(t,\cdot) , v) 
    + \sum_{k=1}^N ( f(t,\cdot) , w_k )_{L^2(\Omega)} ( w_k , v )_{L^2(\Omega)} .
\end{align*}
Quand $N \to +\infty$, $u^{(N)}$ converge vers $u$ dans $L^2(0,T;H^1_0(\Omega))$.
Ainsi, le terme $\dfrac{\deriv}{\deriv t}( u^{(N)}(t,\cdot) , v)_{L^2(\Omega)}$
est correctement d\'efini quand $N \to +\infty$ et sa limite vaut 
$\dfrac{\deriv}{\deriv t}(u(t,\cdot) , v)_{L^2(\Omega)}$.
De plus, $v \in L^2(\Omega)$ et $(w_k)$ est une base Hilbertienne,
$\sum_{k=1}^N ( f(t,\cdot) , w_k )_{L^2(\Omega)} ( w_k , v )_{L^2(\Omega)}$
tend donc vers $(f(t,\cdot),v)_{L^2(\Omega)}$ quand $N \to +\infty$.
La fonction $u$ v\'erifie donc l'\'equation \eqref{eq:chal_vari},
ce qui conclut cette d\'emonstration.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\appendix
\section{Principales propri\'et\'es de la transform\'ee de Fourier}

\begin{align}
  \calF(\dfrac{\partial u}{\partial x}) = i \omega \calF(u) ,
  \\
  \label{eq:calF_uv}
  \calF(u \times v) = \calF(u) * \calF(v) ,
  \\
  \calF^{-1}(\calF(u)) = u ,
\end{align}
avec $u*v$ le produit de convolution.
Les propri\'et\'es \eqref{eq:calF_uv} sont aussi v\'erifi\'ees par $\calF^{-1}$,
les preuves sont similaires et ne sont pas donn\'ees dans ce document.
%===================================================================================

\end{document}